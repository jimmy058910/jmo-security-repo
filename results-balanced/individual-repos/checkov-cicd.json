{"check_type": "github_actions", "results": {"passed_checks": [{"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}}, "code_block": [[26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [26, 263], "resource": "jobs(prepare-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}}, "code_block": [[263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [263, 286], "resource": "jobs(finalize-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}}, "code_block": [[26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [26, 263], "resource": "jobs(prepare-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}}, "code_block": [[263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [263, 286], "resource": "jobs(finalize-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}}, "code_block": [[26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [26, 263], "resource": "jobs(prepare-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}}, "code_block": [[263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [263, 286], "resource": "jobs(finalize-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"prepare-release": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}, "finalize-release": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}, "__startline__": 25, "__endline__": 285}}, "code_block": [[25, "  prepare-release:\n"], [26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [25, 286], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}}, "code_block": [[26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [26, 263], "resource": "jobs(prepare-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}}, "code_block": [[263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [263, 286], "resource": "jobs(finalize-release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"prepare-release": {"name": "Prepare release", "runs-on": "ubuntu-latest", "timeout-minutes": 20, "outputs": {"new_version": "${{ steps.bump.outputs.new_version }}", "release_branch": "${{ steps.create_branch.outputs.branch }}", "__startline__": 30, "__endline__": 32}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}, {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}, {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}, {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}, {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}, {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}, {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}, {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}, {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}], "__startline__": 26, "__endline__": 262}, "finalize-release": {"name": "Finalize release (after PR merge)", "runs-on": "ubuntu-latest", "needs": "prepare-release", "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}, {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}], "__startline__": 263, "__endline__": 285}, "__startline__": 25, "__endline__": 285}}, "code_block": [[25, "  prepare-release:\n"], [26, "    name: Prepare release\n"], [27, "    runs-on: ubuntu-latest\n"], [28, "    timeout-minutes: 20\n"], [29, "    outputs:\n"], [30, "      new_version: ${{ steps.bump.outputs.new_version }}\n"], [31, "      release_branch: ${{ steps.create_branch.outputs.branch }}\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"], [264, "    runs-on: ubuntu-latest\n"], [265, "    needs: prepare-release\n"], [266, "    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n"], [267, "    steps:\n"], [268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [25, 286], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [33, 39], "resource": "jobs(prepare-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}}, "code_block": [[38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [38, 44], "resource": "jobs(prepare-release).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [43, 49], "resource": "jobs(prepare-release).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}}, "code_block": [[48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [48, 66], "resource": "jobs(prepare-release).steps[4](Update ALL tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}}, "code_block": [[65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [65, 99], "resource": "jobs(prepare-release).steps[5](Bump version in pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}}, "code_block": [[98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [98, 129], "resource": "jobs(prepare-release).steps[6](Update CHANGELOG.md)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}}, "code_block": [[128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [128, 141], "resource": "jobs(prepare-release).steps[7](Create release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}}, "code_block": [[140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [140, 175], "resource": "jobs(prepare-release).steps[8](Commit release changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}}, "code_block": [[174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [174, 180], "resource": "jobs(prepare-release).steps[9](Push release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}}, "code_block": [[179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [179, 242], "resource": "jobs(prepare-release).steps[10](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}}, "code_block": [[241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [241, 263], "resource": "jobs(prepare-release).steps[11](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}}, "code_block": [[268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [268, 274], "resource": "jobs(finalize-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}}, "code_block": [[273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [273, 286], "resource": "jobs(finalize-release).steps[2](Create and push git tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [33, 39], "resource": "jobs(prepare-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}}, "code_block": [[38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [38, 44], "resource": "jobs(prepare-release).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [43, 49], "resource": "jobs(prepare-release).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}}, "code_block": [[48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [48, 66], "resource": "jobs(prepare-release).steps[4](Update ALL tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}}, "code_block": [[65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [65, 99], "resource": "jobs(prepare-release).steps[5](Bump version in pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}}, "code_block": [[98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [98, 129], "resource": "jobs(prepare-release).steps[6](Update CHANGELOG.md)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}}, "code_block": [[128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [128, 141], "resource": "jobs(prepare-release).steps[7](Create release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}}, "code_block": [[140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [140, 175], "resource": "jobs(prepare-release).steps[8](Commit release changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}}, "code_block": [[174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [174, 180], "resource": "jobs(prepare-release).steps[9](Push release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}}, "code_block": [[179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [179, 242], "resource": "jobs(prepare-release).steps[10](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}}, "code_block": [[241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [241, 263], "resource": "jobs(prepare-release).steps[11](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}}, "code_block": [[268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [268, 274], "resource": "jobs(finalize-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}}, "code_block": [[273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [273, 286], "resource": "jobs(finalize-release).steps[2](Create and push git tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [33, 39], "resource": "jobs(prepare-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}}, "code_block": [[38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [38, 44], "resource": "jobs(prepare-release).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [43, 49], "resource": "jobs(prepare-release).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}}, "code_block": [[48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [48, 66], "resource": "jobs(prepare-release).steps[4](Update ALL tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}}, "code_block": [[65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [65, 99], "resource": "jobs(prepare-release).steps[5](Bump version in pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}}, "code_block": [[98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [98, 129], "resource": "jobs(prepare-release).steps[6](Update CHANGELOG.md)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}}, "code_block": [[128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [128, 141], "resource": "jobs(prepare-release).steps[7](Create release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}}, "code_block": [[140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [140, 175], "resource": "jobs(prepare-release).steps[8](Commit release changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}}, "code_block": [[174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [174, 180], "resource": "jobs(prepare-release).steps[9](Push release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}}, "code_block": [[179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [179, 242], "resource": "jobs(prepare-release).steps[10](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}}, "code_block": [[241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [241, 263], "resource": "jobs(prepare-release).steps[11](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}}, "code_block": [[268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [268, 274], "resource": "jobs(finalize-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}}, "code_block": [[273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [273, 286], "resource": "jobs(finalize-release).steps[2](Create and push git tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 36, "__endline__": 38}, "__startline__": 33, "__endline__": 38}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "        with:\n"], [36, "          fetch-depth: 0\n"], [37, "\n"], [38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [33, 39], "resource": "jobs(prepare-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 41, "__endline__": 43}, "__startline__": 38, "__endline__": 43}}, "code_block": [[38, "      - name: Set up Python 3.11\n"], [39, "        uses: actions/setup-python@v6\n"], [40, "        with:\n"], [41, "          python-version: '3.11'\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [38, 44], "resource": "jobs(prepare-release).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging toml\n", "__startline__": 43, "__endline__": 48}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          pip install --upgrade pip\n"], [46, "          pip install pyyaml requests packaging toml\n"], [47, "\n"], [48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [43, 49], "resource": "jobs(prepare-release).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update ALL tools to latest versions", "id": "tool_updates", "run": "echo \"Checking for tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"Updating all tools to latest versions...\"\n  python3 scripts/dev/update_versions.py --update-all\n  python3 scripts/dev/update_versions.py --sync\n  echo \"tools_updated=true\" >> $GITHUB_OUTPUT\nelse\n  echo \"All tools already up-to-date\"\n  echo \"tools_updated=false\" >> $GITHUB_OUTPUT\nfi\n", "__startline__": 48, "__endline__": 65}}, "code_block": [[48, "      - name: Update ALL tools to latest versions\n"], [49, "        id: tool_updates\n"], [50, "        run: |\n"], [51, "          echo \"Checking for tool updates...\"\n"], [52, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [53, "          cat check_output.txt\n"], [54, "\n"], [55, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [56, "            echo \"Updating all tools to latest versions...\"\n"], [57, "            python3 scripts/dev/update_versions.py --update-all\n"], [58, "            python3 scripts/dev/update_versions.py --sync\n"], [59, "            echo \"tools_updated=true\" >> $GITHUB_OUTPUT\n"], [60, "          else\n"], [61, "            echo \"All tools already up-to-date\"\n"], [62, "            echo \"tools_updated=false\" >> $GITHUB_OUTPUT\n"], [63, "          fi\n"], [64, "\n"], [65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [48, 66], "resource": "jobs(prepare-release).steps[4](Update ALL tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump version in pyproject.toml", "id": "bump", "run": "CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\necho \"Current version: $CURRENT_VERSION\"\n\n# Parse version components\nIFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n\n# Bump version based on input\ncase \"${{ inputs.version_bump }}\" in\n  major)\n    MAJOR=$((MAJOR + 1))\n    MINOR=0\n    PATCH=0\n    ;;\n  minor)\n    MINOR=$((MINOR + 1))\n    PATCH=0\n    ;;\n  patch)\n    PATCH=$((PATCH + 1))\n    ;;\nesac\n\nNEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\necho \"New version: $NEW_VERSION\"\n\n# Update pyproject.toml\nsed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n\necho \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n", "__startline__": 65, "__endline__": 98}}, "code_block": [[65, "      - name: Bump version in pyproject.toml\n"], [66, "        id: bump\n"], [67, "        run: |\n"], [68, "          CURRENT_VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n"], [69, "          echo \"Current version: $CURRENT_VERSION\"\n"], [70, "\n"], [71, "          # Parse version components\n"], [72, "          IFS='.' read -r MAJOR MINOR PATCH <<< \"$CURRENT_VERSION\"\n"], [73, "\n"], [74, "          # Bump version based on input\n"], [75, "          case \"${{ inputs.version_bump }}\" in\n"], [76, "            major)\n"], [77, "              MAJOR=$((MAJOR + 1))\n"], [78, "              MINOR=0\n"], [79, "              PATCH=0\n"], [80, "              ;;\n"], [81, "            minor)\n"], [82, "              MINOR=$((MINOR + 1))\n"], [83, "              PATCH=0\n"], [84, "              ;;\n"], [85, "            patch)\n"], [86, "              PATCH=$((PATCH + 1))\n"], [87, "              ;;\n"], [88, "          esac\n"], [89, "\n"], [90, "          NEW_VERSION=\"${MAJOR}.${MINOR}.${PATCH}\"\n"], [91, "          echo \"New version: $NEW_VERSION\"\n"], [92, "\n"], [93, "          # Update pyproject.toml\n"], [94, "          sed -i \"s/^version = \\\".*\\\"/version = \\\"$NEW_VERSION\\\"/\" pyproject.toml\n"], [95, "\n"], [96, "          echo \"new_version=$NEW_VERSION\" >> $GITHUB_OUTPUT\n"], [97, "\n"], [98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [65, 99], "resource": "jobs(prepare-release).steps[5](Bump version in pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update CHANGELOG.md", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nTODAY=$(date +%Y-%m-%d)\n\n# Create new changelog entry\n{\n  echo \"## [$NEW_VERSION] - $TODAY\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes\"\n  echo \"\"\n\n  # Add tool updates if any\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    echo \"**Security Tool Updates:**\"\n    echo \"\"\n    git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n    echo \"\"\n  fi\n} > new_entry.md\n\n# Insert new entry after \"# Changelog\" header\nsed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n", "__startline__": 98, "__endline__": 128}}, "code_block": [[98, "      - name: Update CHANGELOG.md\n"], [99, "        run: |\n"], [100, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [101, "          TODAY=$(date +%Y-%m-%d)\n"], [102, "\n"], [103, "          # Create new changelog entry\n"], [104, "          {\n"], [105, "            echo \"## [$NEW_VERSION] - $TODAY\"\n"], [106, "            echo \"\"\n"], [107, "            echo \"### Summary\"\n"], [108, "            echo \"\"\n"], [109, "            echo \"${{ inputs.changelog_entry }}\"\n"], [110, "            echo \"\"\n"], [111, "            echo \"### Changes\"\n"], [112, "            echo \"\"\n"], [113, "\n"], [114, "            # Add tool updates if any\n"], [115, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [116, "              echo \"**Security Tool Updates:**\"\n"], [117, "              echo \"\"\n"], [118, "              git diff versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [119, "                echo \"- $line\"\n"], [120, "              done\n"], [121, "              echo \"\"\n"], [122, "            fi\n"], [123, "          } > new_entry.md\n"], [124, "\n"], [125, "          # Insert new entry after \"# Changelog\" header\n"], [126, "          sed -i \"/^# Changelog/r new_entry.md\" CHANGELOG.md\n"], [127, "\n"], [128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [98, 129], "resource": "jobs(prepare-release).steps[6](Update CHANGELOG.md)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create release branch", "id": "create_branch", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\nNEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"release-v${NEW_VERSION}\"\n\ngit checkout -b \"$BRANCH\"\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 128, "__endline__": 140}}, "code_block": [[128, "      - name: Create release branch\n"], [129, "        id: create_branch\n"], [130, "        run: |\n"], [131, "          git config --local user.name \"github-actions[bot]\"\n"], [132, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [133, "\n"], [134, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [135, "          BRANCH=\"release-v${NEW_VERSION}\"\n"], [136, "\n"], [137, "          git checkout -b \"$BRANCH\"\n"], [138, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [139, "\n"], [140, "      - name: Commit release changes\n"], [141, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [128, 141], "resource": "jobs(prepare-release).steps[7](Create release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit release changes", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n\ngit add pyproject.toml CHANGELOG.md\n\n# Add tool updates if any\nif [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n  git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\nfi\n\n# Create commit\ncat > commit_message.txt << 'COMMIT_MSG'\nrelease: v$NEW_VERSION\n\n$CHANGELOG_ENTRY\n\nThis release includes:\n- Version bump: $VERSION_BUMP\n- All security tools updated to latest versions\n- CHANGELOG.md updated\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Substitute variables\nsed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\nsed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\nsed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n\ngit commit -F commit_message.txt\n", "__startline__": 140, "__endline__": 174}}, "code_block": [[140, "      - name: Commit release changes\n"], [141, "        run: |\n"], [142, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [143, "\n"], [144, "          git add pyproject.toml CHANGELOG.md\n"], [145, "\n"], [146, "          # Add tool updates if any\n"], [147, "          if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [148, "            git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [149, "          fi\n"], [150, "\n"], [151, "          # Create commit\n"], [152, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [153, "          release: v$NEW_VERSION\n"], [154, "\n"], [155, "          $CHANGELOG_ENTRY\n"], [156, "\n"], [157, "          This release includes:\n"], [158, "          - Version bump: $VERSION_BUMP\n"], [159, "          - All security tools updated to latest versions\n"], [160, "          - CHANGELOG.md updated\n"], [161, "\n"], [162, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [163, "\n"], [164, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [165, "          COMMIT_MSG\n"], [166, "\n"], [167, "          # Substitute variables\n"], [168, "          sed -i \"s/\\$NEW_VERSION/${NEW_VERSION}/g\" commit_message.txt\n"], [169, "          sed -i \"s/\\$CHANGELOG_ENTRY/${{ inputs.changelog_entry }}/g\" commit_message.txt\n"], [170, "          sed -i \"s/\\$VERSION_BUMP/${{ inputs.version_bump }}/g\" commit_message.txt\n"], [171, "\n"], [172, "          git commit -F commit_message.txt\n"], [173, "\n"], [174, "      - name: Push release branch\n"], [175, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [140, 175], "resource": "jobs(prepare-release).steps[8](Commit release changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Push release branch", "run": "BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\ngit push origin \"$BRANCH\"\n", "__startline__": 174, "__endline__": 179}}, "code_block": [[174, "      - name: Push release branch\n"], [175, "        run: |\n"], [176, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [177, "          git push origin \"$BRANCH\"\n"], [178, "\n"], [179, "      - name: Create Pull Request\n"], [180, "        env:\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [174, 180], "resource": "jobs(prepare-release).steps[9](Push release branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 181, "__endline__": 182}, "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n# Create PR body\n{\n  echo \"## Release v${NEW_VERSION}\"\n  echo \"\"\n  echo \"### Summary\"\n  echo \"\"\n  echo \"${{ inputs.changelog_entry }}\"\n  echo \"\"\n  echo \"### Changes in this release\"\n  echo \"\"\n  echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n  echo \"\"\n  echo \"**Tool Updates:**\"\n\n  # Add tool update details\n  if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n    git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n      echo \"- $line\"\n    done\n  else\n    echo \"- All tools already up-to-date\"\n  fi\n\n  echo \"\"\n  echo \"### Pre-Release Checklist\"\n  echo \"\"\n  echo \"- \u2705 All security tools updated to latest versions\"\n  echo \"- \u2705 Version bumped in pyproject.toml\"\n  echo \"- \u2705 CHANGELOG.md updated\"\n  echo \"- \u23f3 CI tests pending\"\n  echo \"\"\n  echo \"### Release Process\"\n  echo \"\"\n  echo \"1. **Merge this PR** to main\"\n  echo \"2. **Workflow will automatically:**\"\n  echo \"   - Create git tag v${NEW_VERSION}\"\n  echo \"   - Publish to PyPI via Trusted Publishers\"\n  echo \"   - Build and push Docker images\"\n  echo \"   - Create GitHub release\"\n  echo \"\"\n  echo \"---\"\n  echo \"\"\n  echo \"\ud83e\udd16 **Automated Release PR**\"\n  echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n  echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n} > pr_body.txt\n\n# Create PR\ngh pr create \\\n  --title \"release: v${NEW_VERSION}\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"release\"\n", "__startline__": 179, "__endline__": 241}}, "code_block": [[179, "      - name: Create Pull Request\n"], [180, "        env:\n"], [181, "          GH_TOKEN: ${{ github.token }}\n"], [182, "        run: |\n"], [183, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [184, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [185, "\n"], [186, "          # Create PR body\n"], [187, "          {\n"], [188, "            echo \"## Release v${NEW_VERSION}\"\n"], [189, "            echo \"\"\n"], [190, "            echo \"### Summary\"\n"], [191, "            echo \"\"\n"], [192, "            echo \"${{ inputs.changelog_entry }}\"\n"], [193, "            echo \"\"\n"], [194, "            echo \"### Changes in this release\"\n"], [195, "            echo \"\"\n"], [196, "            echo \"**Version Bump:** ${{ inputs.version_bump }}\"\n"], [197, "            echo \"\"\n"], [198, "            echo \"**Tool Updates:**\"\n"], [199, "\n"], [200, "            # Add tool update details\n"], [201, "            if [[ \"${{ steps.tool_updates.outputs.tools_updated }}\" == \"true\" ]]; then\n"], [202, "              git diff origin/main..HEAD versions.yaml | grep \"^[+-]  version:\" | while read -r line; do\n"], [203, "                echo \"- $line\"\n"], [204, "              done\n"], [205, "            else\n"], [206, "              echo \"- All tools already up-to-date\"\n"], [207, "            fi\n"], [208, "\n"], [209, "            echo \"\"\n"], [210, "            echo \"### Pre-Release Checklist\"\n"], [211, "            echo \"\"\n"], [212, "            echo \"- \u2705 All security tools updated to latest versions\"\n"], [213, "            echo \"- \u2705 Version bumped in pyproject.toml\"\n"], [214, "            echo \"- \u2705 CHANGELOG.md updated\"\n"], [215, "            echo \"- \u23f3 CI tests pending\"\n"], [216, "            echo \"\"\n"], [217, "            echo \"### Release Process\"\n"], [218, "            echo \"\"\n"], [219, "            echo \"1. **Merge this PR** to main\"\n"], [220, "            echo \"2. **Workflow will automatically:**\"\n"], [221, "            echo \"   - Create git tag v${NEW_VERSION}\"\n"], [222, "            echo \"   - Publish to PyPI via Trusted Publishers\"\n"], [223, "            echo \"   - Build and push Docker images\"\n"], [224, "            echo \"   - Create GitHub release\"\n"], [225, "            echo \"\"\n"], [226, "            echo \"---\"\n"], [227, "            echo \"\"\n"], [228, "            echo \"\ud83e\udd16 **Automated Release PR**\"\n"], [229, "            echo \"\ud83d\udcc5 **Created**: $(date +%Y-%m-%d)\"\n"], [230, "            echo \"\ud83d\udd17 **Workflow**: \\`.github/workflows/automated-release.yml\\`\"\n"], [231, "          } > pr_body.txt\n"], [232, "\n"], [233, "          # Create PR\n"], [234, "          gh pr create \\\n"], [235, "            --title \"release: v${NEW_VERSION}\" \\\n"], [236, "            --body-file pr_body.txt \\\n"], [237, "            --base main \\\n"], [238, "            --head \"$BRANCH\" \\\n"], [239, "            --label \"release\"\n"], [240, "\n"], [241, "      - name: Summary\n"], [242, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [179, 242], "resource": "jobs(prepare-release).steps[10](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "run": "NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\nBRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n\n{\n  echo \"## Automated Release Summary\"\n  echo \"\"\n  echo \"\u2705 **Release PR created successfully**\"\n  echo \"\"\n  echo \"- **Version**: v${NEW_VERSION}\"\n  echo \"- **Type**: ${{ inputs.version_bump }}\"\n  echo \"- **Branch**: \\`${BRANCH}\\`\"\n  echo \"\"\n  echo \"### Next Steps\"\n  echo \"\"\n  echo \"1. Review the pull request\"\n  echo \"2. Verify CI tests pass\"\n  echo \"3. Merge the PR to trigger release workflow\"\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 241, "__endline__": 262}}, "code_block": [[241, "      - name: Summary\n"], [242, "        run: |\n"], [243, "          NEW_VERSION=\"${{ steps.bump.outputs.new_version }}\"\n"], [244, "          BRANCH=\"${{ steps.create_branch.outputs.branch }}\"\n"], [245, "\n"], [246, "          {\n"], [247, "            echo \"## Automated Release Summary\"\n"], [248, "            echo \"\"\n"], [249, "            echo \"\u2705 **Release PR created successfully**\"\n"], [250, "            echo \"\"\n"], [251, "            echo \"- **Version**: v${NEW_VERSION}\"\n"], [252, "            echo \"- **Type**: ${{ inputs.version_bump }}\"\n"], [253, "            echo \"- **Branch**: \\`${BRANCH}\\`\"\n"], [254, "            echo \"\"\n"], [255, "            echo \"### Next Steps\"\n"], [256, "            echo \"\"\n"], [257, "            echo \"1. Review the pull request\"\n"], [258, "            echo \"2. Verify CI tests pass\"\n"], [259, "            echo \"3. Merge the PR to trigger release workflow\"\n"], [260, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"], [261, "\n"], [262, "  finalize-release:\n"], [263, "    name: Finalize release (after PR merge)\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [241, 263], "resource": "jobs(prepare-release).steps[11](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["prepare-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 271, "__endline__": 273}, "__startline__": 268, "__endline__": 273}}, "code_block": [[268, "      - name: Checkout repository\n"], [269, "        uses: actions/checkout@v5\n"], [270, "        with:\n"], [271, "          fetch-depth: 0\n"], [272, "\n"], [273, "      - name: Create and push git tag\n"], [274, "        run: |\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [268, 274], "resource": "jobs(finalize-release).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create and push git tag", "run": "NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n\ngit config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\ngit tag \"v${NEW_VERSION}\"\ngit push origin \"v${NEW_VERSION}\"\n\necho \"\u2705 Tag v${NEW_VERSION} created and pushed\"\necho \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n", "__startline__": 273, "__endline__": 285}}, "code_block": [[273, "      - name: Create and push git tag\n"], [274, "        run: |\n"], [275, "          NEW_VERSION=\"${{ needs.prepare-release.outputs.new_version }}\"\n"], [276, "\n"], [277, "          git config --local user.name \"github-actions[bot]\"\n"], [278, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [279, "\n"], [280, "          git tag \"v${NEW_VERSION}\"\n"], [281, "          git push origin \"v${NEW_VERSION}\"\n"], [282, "\n"], [283, "          echo \"\u2705 Tag v${NEW_VERSION} created and pushed\"\n"], [284, "          echo \"Release workflow will now automatically publish to PyPI and Docker Hub\"\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [273, 286], "resource": "jobs(finalize-release).steps[2](Create and push git tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": ["finalize-release"], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}}, "code_block": [[20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [20, 146], "resource": "jobs(quick-checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}}, "code_block": [[146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [146, 227], "resource": "jobs(test-matrix)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}}, "code_block": [[227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [227, 283], "resource": "jobs(lint-quick)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}}, "code_block": [[283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [283, 325], "resource": "jobs(lint-full)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}}, "code_block": [[20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [20, 146], "resource": "jobs(quick-checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}}, "code_block": [[146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [146, 227], "resource": "jobs(test-matrix)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}}, "code_block": [[227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [227, 283], "resource": "jobs(lint-quick)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}}, "code_block": [[283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [283, 325], "resource": "jobs(lint-full)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}}, "code_block": [[20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [20, 146], "resource": "jobs(quick-checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}}, "code_block": [[146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [146, 227], "resource": "jobs(test-matrix)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}}, "code_block": [[227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [227, 283], "resource": "jobs(lint-quick)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}}, "code_block": [[283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [283, 325], "resource": "jobs(lint-full)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"quick-checks": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}, "test-matrix": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}, "lint-quick": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}, "lint-full": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}, "__startline__": 19, "__endline__": 324}}, "code_block": [[19, "  quick-checks:\n"], [20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [19, 325], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}}, "code_block": [[20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [20, 146], "resource": "jobs(quick-checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}}, "code_block": [[146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [146, 227], "resource": "jobs(test-matrix)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}}, "code_block": [[227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [227, 283], "resource": "jobs(lint-quick)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}}, "code_block": [[283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [283, 325], "resource": "jobs(lint-full)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"quick-checks": {"name": "quick-checks", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}, {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}, {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}, {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}, {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}, {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}, {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}, {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}, {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}], "__startline__": 20, "__endline__": 145}, "test-matrix": {"name": "Test ${{ matrix.os }} / Python ${{ matrix.python-version }}", "runs-on": "${{ matrix.os }}", "timeout-minutes": 30, "permissions": {"contents": "read", "id-token": "write", "__startline__": 150, "__endline__": 152}, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 155, "__endline__": 157}, "__startline__": 153, "__endline__": 157}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}, {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}, {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}, {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}, {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}], "__startline__": 146, "__endline__": 226}, "lint-quick": {"name": "Lint (quick checks)", "runs-on": "ubuntu-latest", "if": "github.event_name != 'schedule'", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}, {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}, {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}, {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}, {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}], "__startline__": 227, "__endline__": 282}, "lint-full": {"name": "Lint (full pre-commit suite)", "runs-on": "ubuntu-latest", "if": "github.event_name == 'schedule'", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}, {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}, {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}, {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}, {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}], "__startline__": 283, "__endline__": 324}, "__startline__": 19, "__endline__": 324}}, "code_block": [[19, "  quick-checks:\n"], [20, "    name: quick-checks\n"], [21, "    runs-on: ubuntu-latest\n"], [22, "    timeout-minutes: 10\n"], [23, "    steps:\n"], [24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"], [147, "    runs-on: ${{ matrix.os }}\n"], [148, "    timeout-minutes: 30\n"], [149, "    permissions:\n"], [150, "      contents: read\n"], [151, "      id-token: write  # Needed for Codecov OIDC\n"], [152, "    strategy:\n"], [153, "      fail-fast: false\n"], [154, "      matrix:\n"], [155, "        os: [ubuntu-latest, macos-latest]\n"], [156, "        python-version: [\"3.10\", \"3.11\", \"3.12\"]\n"], [157, "    steps:\n"], [158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"], [228, "    runs-on: ubuntu-latest\n"], [229, "    if: github.event_name != 'schedule'\n"], [230, "    timeout-minutes: 10\n"], [231, "    steps:\n"], [232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"], [284, "    runs-on: ubuntu-latest\n"], [285, "    if: github.event_name == 'schedule'\n"], [286, "    timeout-minutes: 15\n"], [287, "    steps:\n"], [288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [19, 325], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"push": null, "pull_request": null, "workflow_dispatch": null, "schedule": [{"cron": "0 6 * * *", "__startline__": 11, "__endline__": 13}], "__startline__": 6, "__endline__": 13}}, "code_block": [[6, "  push:\n"], [7, "  pull_request:\n"], [8, "  workflow_dispatch:\n"], [9, "  schedule:\n"], [10, "    # Nightly at 6 AM UTC for full lint check\n"], [11, "    - cron: '0 6 * * *'\n"], [12, "\n"], [13, "concurrency:\n"], [14, "  group: ci-${{ github.workflow }}-${{ github.ref || github.run_id }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [6, 14], "resource": "on(CI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": [""], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}}, "code_block": [[24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [24, 28], "resource": "jobs(quick-checks).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}}, "code_block": [[27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [27, 33], "resource": "jobs(quick-checks).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}}, "code_block": [[32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [32, 40], "resource": "jobs(quick-checks).steps[3](Validate GitHub workflows (actionlint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [39, 45], "resource": "jobs(quick-checks).steps[4](Validate YAML files (yamllint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}}, "code_block": [[44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [44, 50], "resource": "jobs(quick-checks).steps[5](Validate requirements-dev.txt Python version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}}, "code_block": [[49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [49, 59], "resource": "jobs(quick-checks).steps[6](Check deps-compile freshness)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}}, "code_block": [[58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [58, 62], "resource": "jobs(quick-checks).steps[7](Guardrails: forbid tracked venv/artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}}, "code_block": [[61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [61, 68], "resource": "jobs(quick-checks).steps[8](Verify PyPI badge version matches pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}}, "code_block": [[67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [67, 89], "resource": "jobs(quick-checks).steps[9](Lint Preview (subset of lint-full))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}}, "code_block": [[88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [88, 146], "resource": "jobs(quick-checks).steps[10](Validate SARIF schema)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}}, "code_block": [[158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [158, 162], "resource": "jobs(test-matrix).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}}, "code_block": [[161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [161, 169], "resource": "jobs(test-matrix).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}}, "code_block": [[168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [168, 191], "resource": "jobs(test-matrix).steps[3](Install dependencies (with retry))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}}, "code_block": [[190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [190, 200], "resource": "jobs(test-matrix).steps[4](Run tests (no coverage))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}}, "code_block": [[199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [199, 217], "resource": "jobs(test-matrix).steps[5](Run tests with coverage (gate))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}}, "code_block": [[216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [216, 227], "resource": "jobs(test-matrix).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}}, "code_block": [[232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [232, 236], "resource": "jobs(lint-quick).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}}, "code_block": [[235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [235, 241], "resource": "jobs(lint-quick).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}}, "code_block": [[240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [240, 246], "resource": "jobs(lint-quick).steps[3](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}}, "code_block": [[245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [245, 254], "resource": "jobs(lint-quick).steps[4](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}}, "code_block": [[253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [253, 270], "resource": "jobs(lint-quick).steps[5](Run pre-commit (quick checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}}, "code_block": [[269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [269, 274], "resource": "jobs(lint-quick).steps[6](Check Python formatting (black --check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}}, "code_block": [[273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [273, 278], "resource": "jobs(lint-quick).steps[7](Check Python linting (ruff check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}}, "code_block": [[277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [277, 283], "resource": "jobs(lint-quick).steps[8](Check shell formatting (shfmt -d))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}}, "code_block": [[288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [288, 292], "resource": "jobs(lint-full).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}}, "code_block": [[291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [291, 297], "resource": "jobs(lint-full).steps[2](Set up Node.js 20)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}}, "code_block": [[296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [296, 302], "resource": "jobs(lint-full).steps[3](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}}, "code_block": [[301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [301, 307], "resource": "jobs(lint-full).steps[4](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}}, "code_block": [[306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [306, 315], "resource": "jobs(lint-full).steps[5](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}}, "code_block": [[314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [314, 325], "resource": "jobs(lint-full).steps[6](Run pre-commit (full suite, all hooks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}}, "code_block": [[24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [24, 28], "resource": "jobs(quick-checks).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}}, "code_block": [[27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [27, 33], "resource": "jobs(quick-checks).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}}, "code_block": [[32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [32, 40], "resource": "jobs(quick-checks).steps[3](Validate GitHub workflows (actionlint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [39, 45], "resource": "jobs(quick-checks).steps[4](Validate YAML files (yamllint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}}, "code_block": [[44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [44, 50], "resource": "jobs(quick-checks).steps[5](Validate requirements-dev.txt Python version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}}, "code_block": [[49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [49, 59], "resource": "jobs(quick-checks).steps[6](Check deps-compile freshness)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}}, "code_block": [[58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [58, 62], "resource": "jobs(quick-checks).steps[7](Guardrails: forbid tracked venv/artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}}, "code_block": [[61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [61, 68], "resource": "jobs(quick-checks).steps[8](Verify PyPI badge version matches pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}}, "code_block": [[67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [67, 89], "resource": "jobs(quick-checks).steps[9](Lint Preview (subset of lint-full))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}}, "code_block": [[88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [88, 146], "resource": "jobs(quick-checks).steps[10](Validate SARIF schema)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}}, "code_block": [[158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [158, 162], "resource": "jobs(test-matrix).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}}, "code_block": [[161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [161, 169], "resource": "jobs(test-matrix).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}}, "code_block": [[168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [168, 191], "resource": "jobs(test-matrix).steps[3](Install dependencies (with retry))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}}, "code_block": [[190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [190, 200], "resource": "jobs(test-matrix).steps[4](Run tests (no coverage))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}}, "code_block": [[199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [199, 217], "resource": "jobs(test-matrix).steps[5](Run tests with coverage (gate))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}}, "code_block": [[216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [216, 227], "resource": "jobs(test-matrix).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}}, "code_block": [[232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [232, 236], "resource": "jobs(lint-quick).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}}, "code_block": [[235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [235, 241], "resource": "jobs(lint-quick).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}}, "code_block": [[240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [240, 246], "resource": "jobs(lint-quick).steps[3](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}}, "code_block": [[245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [245, 254], "resource": "jobs(lint-quick).steps[4](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}}, "code_block": [[253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [253, 270], "resource": "jobs(lint-quick).steps[5](Run pre-commit (quick checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}}, "code_block": [[269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [269, 274], "resource": "jobs(lint-quick).steps[6](Check Python formatting (black --check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}}, "code_block": [[273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [273, 278], "resource": "jobs(lint-quick).steps[7](Check Python linting (ruff check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}}, "code_block": [[277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [277, 283], "resource": "jobs(lint-quick).steps[8](Check shell formatting (shfmt -d))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}}, "code_block": [[288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [288, 292], "resource": "jobs(lint-full).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}}, "code_block": [[291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [291, 297], "resource": "jobs(lint-full).steps[2](Set up Node.js 20)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}}, "code_block": [[296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [296, 302], "resource": "jobs(lint-full).steps[3](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}}, "code_block": [[301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [301, 307], "resource": "jobs(lint-full).steps[4](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}}, "code_block": [[306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [306, 315], "resource": "jobs(lint-full).steps[5](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}}, "code_block": [[314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [314, 325], "resource": "jobs(lint-full).steps[6](Run pre-commit (full suite, all hooks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}}, "code_block": [[24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [24, 28], "resource": "jobs(quick-checks).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}}, "code_block": [[27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [27, 33], "resource": "jobs(quick-checks).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}}, "code_block": [[32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [32, 40], "resource": "jobs(quick-checks).steps[3](Validate GitHub workflows (actionlint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [39, 45], "resource": "jobs(quick-checks).steps[4](Validate YAML files (yamllint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}}, "code_block": [[44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [44, 50], "resource": "jobs(quick-checks).steps[5](Validate requirements-dev.txt Python version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}}, "code_block": [[49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [49, 59], "resource": "jobs(quick-checks).steps[6](Check deps-compile freshness)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}}, "code_block": [[58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [58, 62], "resource": "jobs(quick-checks).steps[7](Guardrails: forbid tracked venv/artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}}, "code_block": [[61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [61, 68], "resource": "jobs(quick-checks).steps[8](Verify PyPI badge version matches pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}}, "code_block": [[67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [67, 89], "resource": "jobs(quick-checks).steps[9](Lint Preview (subset of lint-full))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}}, "code_block": [[88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [88, 146], "resource": "jobs(quick-checks).steps[10](Validate SARIF schema)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}}, "code_block": [[158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [158, 162], "resource": "jobs(test-matrix).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}}, "code_block": [[161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [161, 169], "resource": "jobs(test-matrix).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}}, "code_block": [[168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [168, 191], "resource": "jobs(test-matrix).steps[3](Install dependencies (with retry))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}}, "code_block": [[190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [190, 200], "resource": "jobs(test-matrix).steps[4](Run tests (no coverage))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}}, "code_block": [[199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [199, 217], "resource": "jobs(test-matrix).steps[5](Run tests with coverage (gate))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}}, "code_block": [[216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [216, 227], "resource": "jobs(test-matrix).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}}, "code_block": [[232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [232, 236], "resource": "jobs(lint-quick).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}}, "code_block": [[235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [235, 241], "resource": "jobs(lint-quick).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}}, "code_block": [[240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [240, 246], "resource": "jobs(lint-quick).steps[3](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}}, "code_block": [[245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [245, 254], "resource": "jobs(lint-quick).steps[4](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}}, "code_block": [[253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [253, 270], "resource": "jobs(lint-quick).steps[5](Run pre-commit (quick checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}}, "code_block": [[269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [269, 274], "resource": "jobs(lint-quick).steps[6](Check Python formatting (black --check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}}, "code_block": [[273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [273, 278], "resource": "jobs(lint-quick).steps[7](Check Python linting (ruff check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}}, "code_block": [[277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [277, 283], "resource": "jobs(lint-quick).steps[8](Check shell formatting (shfmt -d))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}}, "code_block": [[288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [288, 292], "resource": "jobs(lint-full).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}}, "code_block": [[291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [291, 297], "resource": "jobs(lint-full).steps[2](Set up Node.js 20)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}}, "code_block": [[296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [296, 302], "resource": "jobs(lint-full).steps[3](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}}, "code_block": [[301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [301, 307], "resource": "jobs(lint-full).steps[4](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}}, "code_block": [[306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [306, 315], "resource": "jobs(lint-full).steps[5](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}}, "code_block": [[314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [314, 325], "resource": "jobs(lint-full).steps[6](Run pre-commit (full suite, all hooks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 24, "__endline__": 27}}, "code_block": [[24, "      - name: Checkout repository\n"], [25, "        uses: actions/checkout@v5\n"], [26, "\n"], [27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [24, 28], "resource": "jobs(quick-checks).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 30, "__endline__": 32}, "__startline__": 27, "__endline__": 32}}, "code_block": [[27, "      - name: Set up Python 3.11\n"], [28, "        uses: actions/setup-python@v6\n"], [29, "        with:\n"], [30, "          python-version: '3.11'\n"], [31, "\n"], [32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [27, 33], "resource": "jobs(quick-checks).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate GitHub workflows (actionlint)", "uses": "reviewdog/action-actionlint@v1.68.0", "with": {"actionlint_flags": "-color", "level": "error", "fail_level": "error", "__startline__": 35, "__endline__": 39}, "__startline__": 32, "__endline__": 39}}, "code_block": [[32, "      - name: Validate GitHub workflows (actionlint)\n"], [33, "        uses: reviewdog/action-actionlint@v1.68.0\n"], [34, "        with:\n"], [35, "          actionlint_flags: -color\n"], [36, "          level: error\n"], [37, "          fail_level: error\n"], [38, "\n"], [39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [32, 40], "resource": "jobs(quick-checks).steps[3](Validate GitHub workflows (actionlint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate YAML files (yamllint)", "run": "pip install yamllint\nyamllint -c .yamllint.yaml .\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Validate YAML files (yamllint)\n"], [40, "        run: |\n"], [41, "          pip install yamllint\n"], [42, "          yamllint -c .yamllint.yaml .\n"], [43, "\n"], [44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [39, 45], "resource": "jobs(quick-checks).steps[4](Validate YAML files (yamllint))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate requirements-dev.txt Python version", "run": "python -m pip install pip-tools\npython scripts/dev/update_dependencies.py --validate\n", "__startline__": 44, "__endline__": 49}}, "code_block": [[44, "      - name: Validate requirements-dev.txt Python version\n"], [45, "        run: |\n"], [46, "          python -m pip install pip-tools\n"], [47, "          python scripts/dev/update_dependencies.py --validate\n"], [48, "\n"], [49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [44, 50], "resource": "jobs(quick-checks).steps[5](Validate requirements-dev.txt Python version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check deps-compile freshness", "run": "# Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n# Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n# Tracking: https://github.com/jazzband/pip-tools/issues\npython -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\npython -m piptools compile -o requirements-dev.txt requirements-dev.in\ngit diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n", "__startline__": 49, "__endline__": 58}}, "code_block": [[49, "      - name: Check deps-compile freshness\n"], [50, "        run: |\n"], [51, "          # Pin pip <25.3 until pip-tools supports pip 25.3's API changes\n"], [52, "          # Issue: pip 25.3 removed InstallRequirement.use_pep517, breaking pip-tools 7.5.1\n"], [53, "          # Tracking: https://github.com/jazzband/pip-tools/issues\n"], [54, "          python -m pip install -U \"pip<25.3\" setuptools wheel pip-tools\n"], [55, "          python -m piptools compile -o requirements-dev.txt requirements-dev.in\n"], [56, "          git diff --exit-code -- requirements-dev.txt || (echo \"requirements-dev.txt is out of date. Run: make deps-compile\" && exit 1)\n"], [57, "\n"], [58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [49, 59], "resource": "jobs(quick-checks).steps[6](Check deps-compile freshness)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Guardrails: forbid tracked venv/artifacts", "run": "bash scripts/dev/guardrails_check.sh", "__startline__": 58, "__endline__": 61}}, "code_block": [[58, "      - name: \"Guardrails: forbid tracked venv/artifacts\"\n"], [59, "        run: bash scripts/dev/guardrails_check.sh\n"], [60, "\n"], [61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [58, 62], "resource": "jobs(quick-checks).steps[7](Guardrails: forbid tracked venv/artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI badge version matches pyproject.toml", "run": "# Ensure badges auto-update correctly after releases\n# Detects version mismatches between local and PyPI\nbash scripts/dev/verify_badges.sh\n", "__startline__": 61, "__endline__": 67}}, "code_block": [[61, "      - name: \"Verify PyPI badge version matches pyproject.toml\"\n"], [62, "        run: |\n"], [63, "          # Ensure badges auto-update correctly after releases\n"], [64, "          # Detects version mismatches between local and PyPI\n"], [65, "          bash scripts/dev/verify_badges.sh\n"], [66, "\n"], [67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [61, 68], "resource": "jobs(quick-checks).steps[8](Verify PyPI badge version matches pyproject.toml)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Lint Preview (subset of lint-full)", "run": "# Install lint dependencies\npython -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n\n# Run critical lint checks (catches 80% of nightly failures early)\necho \"::group::Markdownlint\"\nnpx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Mypy (scripts only)\"\nmypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"::group::Ruff\"\nruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\necho \"::endgroup::\"\n\necho \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n", "__startline__": 67, "__endline__": 88}}, "code_block": [[67, "      - name: \"Lint Preview (subset of lint-full)\"\n"], [68, "        run: |\n"], [69, "          # Install lint dependencies\n"], [70, "          python -m pip install --upgrade 'pip<25.3'\n"], [71, "          pip install -r requirements-dev.txt\n"], [72, "\n"], [73, "          # Run critical lint checks (catches 80% of nightly failures early)\n"], [74, "          echo \"::group::Markdownlint\"\n"], [75, "          npx markdownlint-cli2 \"**/*.md\" \"#node_modules\" || echo \"\u26a0\ufe0f  Markdownlint issues found (non-blocking preview)\"\n"], [76, "          echo \"::endgroup::\"\n"], [77, "\n"], [78, "          echo \"::group::Mypy (scripts only)\"\n"], [79, "          mypy scripts/ || echo \"\u26a0\ufe0f  Mypy issues found (non-blocking preview)\"\n"], [80, "          echo \"::endgroup::\"\n"], [81, "\n"], [82, "          echo \"::group::Ruff\"\n"], [83, "          ruff check scripts/ tests/ || echo \"\u26a0\ufe0f  Ruff issues found (non-blocking preview)\"\n"], [84, "          echo \"::endgroup::\"\n"], [85, "\n"], [86, "          echo \"\u2705 Lint preview complete. Full lint-full runs nightly at 6 AM UTC.\"\n"], [87, "\n"], [88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [67, 89], "resource": "jobs(quick-checks).steps[9](Lint Preview (subset of lint-full))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate SARIF schema", "run": "echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n\n# Install required packages for SARIF validation\npip install jsonschema requests\n\n# Create and validate a minimal test SARIF file using Python\npython3 -c \"\nimport json, jsonschema, requests, sys, os\n\n# Create minimal valid SARIF 2.1.0 test file\nsarif_data = {\n    '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n    'version': '2.1.0',\n    'runs': [\n        {\n            'tool': {\n                'driver': {\n                    'name': 'jmo-security-test',\n                    'version': '0.8.0',\n                    'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n                }\n            },\n            'results': []\n        }\n    ]\n}\n\ntry:\n    # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n    microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n    print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n\n    response = requests.get(microsoft_sarif_url)\n    response.raise_for_status()\n\n    schema = response.json()\n    print('\u2705 SARIF schema downloaded and parsed successfully')\n\n    # Validate the test SARIF file\n    jsonschema.validate(sarif_data, schema)\n    print('\u2705 SARIF schema validation passed')\n    print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n\nexcept requests.RequestException as e:\n    print(f'\u274c Failed to download SARIF schema: {e}')\n    sys.exit(1)\nexcept json.JSONDecodeError as e:\n    print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n    sys.exit(1)\nexcept Exception as e:\n    print(f'\u274c SARIF validation failed: {e}')\n    sys.exit(1)\n\"\n", "__startline__": 88, "__endline__": 145}}, "code_block": [[88, "      - name: Validate SARIF schema\n"], [89, "        run: |\n"], [90, "          echo \"\ud83d\udd0d Validating SARIF schema compliance...\"\n"], [91, "\n"], [92, "          # Install required packages for SARIF validation\n"], [93, "          pip install jsonschema requests\n"], [94, "\n"], [95, "          # Create and validate a minimal test SARIF file using Python\n"], [96, "          python3 -c \"\n"], [97, "          import json, jsonschema, requests, sys, os\n"], [98, "\n"], [99, "          # Create minimal valid SARIF 2.1.0 test file\n"], [100, "          sarif_data = {\n"], [101, "              '\\$schema': 'https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/Schemata/sarif-schema-2.1.0.json',\n"], [102, "              'version': '2.1.0',\n"], [103, "              'runs': [\n"], [104, "                  {\n"], [105, "                      'tool': {\n"], [106, "                          'driver': {\n"], [107, "                              'name': 'jmo-security-test',\n"], [108, "                              'version': '0.8.0',\n"], [109, "                              'informationUri': 'https://github.com/jimmy058910/jmo-security-repo'\n"], [110, "                          }\n"], [111, "                      },\n"], [112, "                      'results': []\n"], [113, "                  }\n"], [114, "              ]\n"], [115, "          }\n"], [116, "\n"], [117, "          try:\n"], [118, "              # Download SARIF 2.1.0 schema from Microsoft SARIF SDK repository\n"], [119, "              microsoft_sarif_url = 'https://raw.githubusercontent.com/microsoft/sarif-sdk/main/src/Sarif/Schemata/sarif-2.1.0-rtm.6.json'\n"], [120, "              print(f'Downloading SARIF 2.1.0 schema from Microsoft SDK: {microsoft_sarif_url}')\n"], [121, "\n"], [122, "              response = requests.get(microsoft_sarif_url)\n"], [123, "              response.raise_for_status()\n"], [124, "\n"], [125, "              schema = response.json()\n"], [126, "              print('\u2705 SARIF schema downloaded and parsed successfully')\n"], [127, "\n"], [128, "              # Validate the test SARIF file\n"], [129, "              jsonschema.validate(sarif_data, schema)\n"], [130, "              print('\u2705 SARIF schema validation passed')\n"], [131, "              print('\u2705 SARIF reporter can generate valid SARIF 2.1.0 files')\n"], [132, "\n"], [133, "          except requests.RequestException as e:\n"], [134, "              print(f'\u274c Failed to download SARIF schema: {e}')\n"], [135, "              sys.exit(1)\n"], [136, "          except json.JSONDecodeError as e:\n"], [137, "              print(f'\u274c Failed to parse SARIF schema JSON: {e}')\n"], [138, "              sys.exit(1)\n"], [139, "          except Exception as e:\n"], [140, "              print(f'\u274c SARIF validation failed: {e}')\n"], [141, "              sys.exit(1)\n"], [142, "          \"\n"], [143, "\n"], [144, "  # Test matrix runs in parallel, independent of quick-checks\n"], [145, "  test-matrix:\n"], [146, "    name: Test ${{ matrix.os }} / Python ${{ matrix.python-version }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [88, 146], "resource": "jobs(quick-checks).steps[10](Validate SARIF schema)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["quick-checks"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 158, "__endline__": 161}}, "code_block": [[158, "      - name: Checkout repository\n"], [159, "        uses: actions/checkout@v5\n"], [160, "\n"], [161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [158, 162], "resource": "jobs(test-matrix).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 164, "__endline__": 168}, "__startline__": 161, "__endline__": 168}}, "code_block": [[161, "      - name: Set up Python ${{ matrix.python-version }}\n"], [162, "        uses: actions/setup-python@v6\n"], [163, "        with:\n"], [164, "          python-version: ${{ matrix.python-version }}\n"], [165, "          cache: pip\n"], [166, "          cache-dependency-path: requirements-dev.txt\n"], [167, "\n"], [168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [161, 169], "resource": "jobs(test-matrix).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies (with retry)", "env": {"PIP_DISABLE_PIP_VERSION_CHECK": "1", "PIP_DEFAULT_TIMEOUT": "60", "__startline__": 170, "__endline__": 172}, "run": "python -m pip install --upgrade 'pip<25.3'\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n  if pip install -r requirements-dev.txt; then\n    break\n  fi\n  sleep 5\ndone\n# Install project in editable mode\nfor attempt in 1 2 3; do\n  echo \"[deps] attempt ${attempt} to install project in editable mode\"\n  if pip install -e .; then\n    break\n  fi\n  sleep 5\ndone\n", "__startline__": 168, "__endline__": 190}}, "code_block": [[168, "      - name: Install dependencies (with retry)\n"], [169, "        env:\n"], [170, "          PIP_DISABLE_PIP_VERSION_CHECK: \"1\"\n"], [171, "          PIP_DEFAULT_TIMEOUT: \"60\"\n"], [172, "        run: |\n"], [173, "          python -m pip install --upgrade 'pip<25.3'\n"], [174, "          for attempt in 1 2 3; do\n"], [175, "            echo \"[deps] attempt ${attempt} to install requirements-dev.txt\"\n"], [176, "            if pip install -r requirements-dev.txt; then\n"], [177, "              break\n"], [178, "            fi\n"], [179, "            sleep 5\n"], [180, "          done\n"], [181, "          # Install project in editable mode\n"], [182, "          for attempt in 1 2 3; do\n"], [183, "            echo \"[deps] attempt ${attempt} to install project in editable mode\"\n"], [184, "            if pip install -e .; then\n"], [185, "              break\n"], [186, "            fi\n"], [187, "            sleep 5\n"], [188, "          done\n"], [189, "\n"], [190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [168, 191], "resource": "jobs(test-matrix).steps[3](Install dependencies (with retry))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests (no coverage)", "if": "${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 193, "__endline__": 196}, "run": "python -m pytest -q --maxfail=1 --disable-warnings\n", "__startline__": 190, "__endline__": 199}}, "code_block": [[190, "      - name: Run tests (no coverage)\n"], [191, "        if: ${{ !(matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11') }}\n"], [192, "        env:\n"], [193, "          CI: \"true\"\n"], [194, "          PYTHONUTF8: \"1\"\n"], [195, "          JMO_THREADS: \"2\"\n"], [196, "        run: |\n"], [197, "          python -m pytest -q --maxfail=1 --disable-warnings\n"], [198, "\n"], [199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [190, 200], "resource": "jobs(test-matrix).steps[4](Run tests (no coverage))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run tests with coverage (gate)", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "env": {"CI": "true", "PYTHONUTF8": "1", "JMO_THREADS": "2", "__startline__": 202, "__endline__": 205}, "run": "python -m pytest -q \\\n  --maxfail=1 \\\n  --disable-warnings \\\n  --reruns 2 \\\n  --reruns-delay 2 \\\n  --cov=. \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  --cov-fail-under=85\n", "__startline__": 199, "__endline__": 216}}, "code_block": [[199, "      - name: Run tests with coverage (gate)\n"], [200, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [201, "        env:\n"], [202, "          CI: \"true\"\n"], [203, "          PYTHONUTF8: \"1\"\n"], [204, "          JMO_THREADS: \"2\"\n"], [205, "        run: |\n"], [206, "          python -m pytest -q \\\n"], [207, "            --maxfail=1 \\\n"], [208, "            --disable-warnings \\\n"], [209, "            --reruns 2 \\\n"], [210, "            --reruns-delay 2 \\\n"], [211, "            --cov=. \\\n"], [212, "            --cov-report=term-missing \\\n"], [213, "            --cov-report=xml \\\n"], [214, "            --cov-fail-under=85\n"], [215, "\n"], [216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [199, 217], "resource": "jobs(test-matrix).steps[5](Run tests with coverage (gate))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "if": "${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}", "uses": "codecov/codecov-action@v5.5.1", "with": {"files": "./coverage.xml", "fail_ci_if_error": false, "verbose": true, "__startline__": 220, "__endline__": 226}, "__startline__": 216, "__endline__": 226}}, "code_block": [[216, "      - name: Upload coverage to Codecov\n"], [217, "        if: ${{ matrix.os == 'ubuntu-latest' && matrix.python-version == '3.11' }}\n"], [218, "        uses: codecov/codecov-action@v5.5.1\n"], [219, "        with:\n"], [220, "          files: ./coverage.xml\n"], [221, "          fail_ci_if_error: false\n"], [222, "          verbose: true\n"], [223, "\n"], [224, "\n"], [225, "  # Quick lint checks for PRs - formatters in check-only mode\n"], [226, "  lint-quick:\n"], [227, "    name: Lint (quick checks)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [216, 227], "resource": "jobs(test-matrix).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["test-matrix"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 232, "__endline__": 235}}, "code_block": [[232, "      - name: Checkout repository\n"], [233, "        uses: actions/checkout@v5\n"], [234, "\n"], [235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [232, 236], "resource": "jobs(lint-quick).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 238, "__endline__": 240}, "__startline__": 235, "__endline__": 240}}, "code_block": [[235, "      - name: Set up Python 3.11\n"], [236, "        uses: actions/setup-python@v6\n"], [237, "        with:\n"], [238, "          python-version: '3.11'\n"], [239, "\n"], [240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [235, 241], "resource": "jobs(lint-quick).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 240, "__endline__": 245}}, "code_block": [[240, "      - name: Install dev dependencies\n"], [241, "        run: |\n"], [242, "          python -m pip install --upgrade 'pip<25.3'\n"], [243, "          pip install -r requirements-dev.txt\n"], [244, "\n"], [245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [240, 246], "resource": "jobs(lint-quick).steps[3](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 248, "__endline__": 253}, "__startline__": 245, "__endline__": 253}}, "code_block": [[245, "      - name: Cache pre-commit environments\n"], [246, "        uses: actions/cache@v4\n"], [247, "        with:\n"], [248, "          path: ~/.cache/pre-commit\n"], [249, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [250, "          restore-keys: |\n"], [251, "            ${{ runner.os }}-precommit-\n"], [252, "\n"], [253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [245, 254], "resource": "jobs(lint-quick).steps[4](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (quick checks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "black,ruff,shfmt,bandit,mypy", "__startline__": 255, "__endline__": 258}, "run": "# Run core linting hooks\npre-commit run --all-files trailing-whitespace\npre-commit run --all-files end-of-file-fixer\npre-commit run --all-files check-yaml\npre-commit run --all-files check-json\npre-commit run --all-files check-toml\npre-commit run --all-files mixed-line-ending\npre-commit run --all-files detect-private-key\npre-commit run --all-files check-added-large-files\n", "__startline__": 253, "__endline__": 269}}, "code_block": [[253, "      - name: Run pre-commit (quick checks)\n"], [254, "        env:\n"], [255, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [256, "          # Skip formatters (black, ruff --fix, shfmt) - check-only via separate hooks\n"], [257, "          SKIP: black,ruff,shfmt,bandit,mypy\n"], [258, "        run: |\n"], [259, "          # Run core linting hooks\n"], [260, "          pre-commit run --all-files trailing-whitespace\n"], [261, "          pre-commit run --all-files end-of-file-fixer\n"], [262, "          pre-commit run --all-files check-yaml\n"], [263, "          pre-commit run --all-files check-json\n"], [264, "          pre-commit run --all-files check-toml\n"], [265, "          pre-commit run --all-files mixed-line-ending\n"], [266, "          pre-commit run --all-files detect-private-key\n"], [267, "          pre-commit run --all-files check-added-large-files\n"], [268, "\n"], [269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [253, 270], "resource": "jobs(lint-quick).steps[5](Run pre-commit (quick checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python formatting (black --check)", "run": "black --check scripts/ tests/\n", "__startline__": 269, "__endline__": 273}}, "code_block": [[269, "      - name: Check Python formatting (black --check)\n"], [270, "        run: |\n"], [271, "          black --check scripts/ tests/\n"], [272, "\n"], [273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [269, 274], "resource": "jobs(lint-quick).steps[6](Check Python formatting (black --check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python linting (ruff check)", "run": "ruff check scripts/ tests/\n", "__startline__": 273, "__endline__": 277}}, "code_block": [[273, "      - name: Check Python linting (ruff check)\n"], [274, "        run: |\n"], [275, "          ruff check scripts/ tests/\n"], [276, "\n"], [277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [273, 278], "resource": "jobs(lint-quick).steps[7](Check Python linting (ruff check))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check shell formatting (shfmt -d)", "run": "shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n", "__startline__": 277, "__endline__": 282}}, "code_block": [[277, "      - name: Check shell formatting (shfmt -d)\n"], [278, "        run: |\n"], [279, "          shfmt -d -i 2 -ci -bn scripts/dev/*.sh scripts/core/*.sh 2>/dev/null || true\n"], [280, "\n"], [281, "  # Full pre-commit lint suite - nightly only\n"], [282, "  lint-full:\n"], [283, "    name: Lint (full pre-commit suite)\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [277, 283], "resource": "jobs(lint-quick).steps[8](Check shell formatting (shfmt -d))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-quick"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 288, "__endline__": 291}}, "code_block": [[288, "      - name: Checkout repository\n"], [289, "        uses: actions/checkout@v5\n"], [290, "\n"], [291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [288, 292], "resource": "jobs(lint-full).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Node.js 20", "uses": "actions/setup-node@v6", "with": {"node-version": "20", "__startline__": 294, "__endline__": 296}, "__startline__": 291, "__endline__": 296}}, "code_block": [[291, "      - name: Set up Node.js 20\n"], [292, "        uses: actions/setup-node@v6\n"], [293, "        with:\n"], [294, "          node-version: '20'\n"], [295, "\n"], [296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [291, 297], "resource": "jobs(lint-full).steps[2](Set up Node.js 20)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 299, "__endline__": 301}, "__startline__": 296, "__endline__": 301}}, "code_block": [[296, "      - name: Set up Python 3.11\n"], [297, "        uses: actions/setup-python@v6\n"], [298, "        with:\n"], [299, "          python-version: '3.11'\n"], [300, "\n"], [301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [296, 302], "resource": "jobs(lint-full).steps[3](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dev dependencies", "run": "python -m pip install --upgrade 'pip<25.3'\npip install -r requirements-dev.txt\n", "__startline__": 301, "__endline__": 306}}, "code_block": [[301, "      - name: Install dev dependencies\n"], [302, "        run: |\n"], [303, "          python -m pip install --upgrade 'pip<25.3'\n"], [304, "          pip install -r requirements-dev.txt\n"], [305, "\n"], [306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [301, 307], "resource": "jobs(lint-full).steps[4](Install dev dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cache pre-commit environments", "uses": "actions/cache@v4", "with": {"path": "~/.cache/pre-commit", "key": "${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}", "restore-keys": "${{ runner.os }}-precommit-\n", "__startline__": 309, "__endline__": 314}, "__startline__": 306, "__endline__": 314}}, "code_block": [[306, "      - name: Cache pre-commit environments\n"], [307, "        uses: actions/cache@v4\n"], [308, "        with:\n"], [309, "          path: ~/.cache/pre-commit\n"], [310, "          key: ${{ runner.os }}-precommit-${{ hashFiles('.pre-commit-config.yaml') }}\n"], [311, "          restore-keys: |\n"], [312, "            ${{ runner.os }}-precommit-\n"], [313, "\n"], [314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [306, 315], "resource": "jobs(lint-full).steps[5](Cache pre-commit environments)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run pre-commit (full suite, all hooks)", "env": {"PRE_COMMIT_HOME": "~/.cache/pre-commit", "SKIP": "bandit,yamllint", "__startline__": 316, "__endline__": 320}, "run": "pre-commit run --all-files --show-diff-on-failure\n# Run yamllint separately on our repo files only\nyamllint -c .yamllint.yaml .\n", "__startline__": 314, "__endline__": 324}}, "code_block": [[314, "      - name: Run pre-commit (full suite, all hooks)\n"], [315, "        env:\n"], [316, "          PRE_COMMIT_HOME: ~/.cache/pre-commit\n"], [317, "          # Skip bandit (already covered by make lint)\n"], [318, "          # Skip yamllint to avoid validating external pre-commit cache files\n"], [319, "          SKIP: bandit,yamllint\n"], [320, "        run: |\n"], [321, "          pre-commit run --all-files --show-diff-on-failure\n"], [322, "          # Run yamllint separately on our repo files only\n"], [323, "          yamllint -c .yamllint.yaml .\n"]], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [314, 325], "resource": "jobs(lint-full).steps[6](Run pre-commit (full suite, all hooks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": ["lint-full"], "workflow_name": "CI"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}}, "code_block": [[29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [29, 176], "resource": "jobs(ubuntu-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}}, "code_block": [[176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [176, 260], "resource": "jobs(macos-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}}, "code_block": [[260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [260, 308], "resource": "jobs(summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}}, "code_block": [[29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [29, 176], "resource": "jobs(ubuntu-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}}, "code_block": [[176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [176, 260], "resource": "jobs(macos-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}}, "code_block": [[260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [260, 308], "resource": "jobs(summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}}, "code_block": [[29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [29, 176], "resource": "jobs(ubuntu-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}}, "code_block": [[176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [176, 260], "resource": "jobs(macos-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}}, "code_block": [[260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [260, 308], "resource": "jobs(summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"ubuntu-e2e": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}, "macos-e2e": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}, "summary": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}, "__startline__": 28, "__endline__": 307}}, "code_block": [[28, "  ubuntu-e2e:\n"], [29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [28, 308], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}}, "code_block": [[29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [29, 176], "resource": "jobs(ubuntu-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}}, "code_block": [[176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [176, 260], "resource": "jobs(macos-e2e)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}}, "code_block": [[260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [260, 308], "resource": "jobs(summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"ubuntu-e2e": {"name": "Ubuntu E2E Tests", "runs-on": "ubuntu-22.04", "timeout-minutes": 180, "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 36, "__endline__": 38}, "__startline__": 34, "__endline__": 38}, "permissions": {"contents": "read", "issues": "write", "pull-requests": "write", "__startline__": 39, "__endline__": 43}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}, {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}, {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}, {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}, {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}, {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}, {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}, {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}, {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}], "__startline__": 29, "__endline__": 175}, "macos-e2e": {"name": "macOS E2E Tests", "runs-on": "macos-14", "timeout-minutes": 120, "if": "github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'", "strategy": {"fail-fast": false, "matrix": {"python-version": ["3.11"], "__startline__": 184, "__endline__": 186}, "__startline__": 182, "__endline__": 186}, "permissions": {"contents": "read", "__startline__": 187, "__endline__": 189}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}, {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}, {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}, {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}, {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}, {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}, {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}, {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}, {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}], "__startline__": 176, "__endline__": 259}, "summary": {"name": "Test Summary", "runs-on": "ubuntu-latest", "needs": ["ubuntu-e2e"], "if": "always()", "steps": [{"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}, {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}, {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}], "__startline__": 260, "__endline__": 307}, "__startline__": 28, "__endline__": 307}}, "code_block": [[28, "  ubuntu-e2e:\n"], [29, "    name: Ubuntu E2E Tests\n"], [30, "    runs-on: ubuntu-22.04\n"], [31, "    timeout-minutes: 180  # 3 hours for full suite\n"], [32, "\n"], [33, "    strategy:\n"], [34, "      fail-fast: false\n"], [35, "      matrix:\n"], [36, "        python-version: ['3.11']\n"], [37, "\n"], [38, "    permissions:\n"], [39, "      contents: read\n"], [40, "      issues: write\n"], [41, "      pull-requests: write\n"], [42, "\n"], [43, "    steps:\n"], [44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"], [177, "    runs-on: macos-14\n"], [178, "    timeout-minutes: 120  # 2 hours for macOS suite\n"], [179, "    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'\n"], [180, "\n"], [181, "    strategy:\n"], [182, "      fail-fast: false\n"], [183, "      matrix:\n"], [184, "        python-version: ['3.11']\n"], [185, "\n"], [186, "    permissions:\n"], [187, "      contents: read\n"], [188, "\n"], [189, "    steps:\n"], [190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"], [261, "    runs-on: ubuntu-latest\n"], [262, "    needs: [ubuntu-e2e]\n"], [263, "    if: always()\n"], [264, "\n"], [265, "    steps:\n"], [266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [28, 308], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}}, "code_block": [[44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [44, 48], "resource": "jobs(ubuntu-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}}, "code_block": [[47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [47, 54], "resource": "jobs(ubuntu-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}}, "code_block": [[53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [53, 61], "resource": "jobs(ubuntu-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}}, "code_block": [[60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [60, 66], "resource": "jobs(ubuntu-e2e).steps[4](Install external security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}}, "code_block": [[65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [65, 69], "resource": "jobs(ubuntu-e2e).steps[5](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}}, "code_block": [[68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [68, 75], "resource": "jobs(ubuntu-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}}, "code_block": [[74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [74, 83], "resource": "jobs(ubuntu-e2e).steps[7](Pull JMo Docker images (if testing Docker variants))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}}, "code_block": [[82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [82, 87], "resource": "jobs(ubuntu-e2e).steps[8](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}}, "code_block": [[86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [86, 105], "resource": "jobs(ubuntu-e2e).steps[9](Run comprehensive test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}}, "code_block": [[104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [104, 114], "resource": "jobs(ubuntu-e2e).steps[10](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}}, "code_block": [[113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [113, 126], "resource": "jobs(ubuntu-e2e).steps[11](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}}, "code_block": [[125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [125, 134], "resource": "jobs(ubuntu-e2e).steps[12](Upload test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}}, "code_block": [[133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [133, 160], "resource": "jobs(ubuntu-e2e).steps[13](Comment PR with test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}}, "code_block": [[159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [159, 176], "resource": "jobs(ubuntu-e2e).steps[14](Check test success)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}}, "code_block": [[190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [190, 194], "resource": "jobs(macos-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}}, "code_block": [[193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [193, 200], "resource": "jobs(macos-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}}, "code_block": [[199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [199, 205], "resource": "jobs(macos-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}}, "code_block": [[204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [204, 210], "resource": "jobs(macos-e2e).steps[4](Install external security tools via Homebrew)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}}, "code_block": [[209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [209, 221], "resource": "jobs(macos-e2e).steps[5](Check Docker availability)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}}, "code_block": [[220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [220, 226], "resource": "jobs(macos-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}}, "code_block": [[225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [225, 230], "resource": "jobs(macos-e2e).steps[7](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}}, "code_block": [[229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [229, 240], "resource": "jobs(macos-e2e).steps[8](Run macOS test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}}, "code_block": [[239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [239, 250], "resource": "jobs(macos-e2e).steps[9](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}}, "code_block": [[249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [249, 260], "resource": "jobs(macos-e2e).steps[10](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}}, "code_block": [[266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [266, 273], "resource": "jobs(summary).steps[1](Download all test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}}, "code_block": [[272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [272, 302], "resource": "jobs(summary).steps[2](Aggregate results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}}, "code_block": [[301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [301, 308], "resource": "jobs(summary).steps[3](Upload summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}}, "code_block": [[44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [44, 48], "resource": "jobs(ubuntu-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}}, "code_block": [[47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [47, 54], "resource": "jobs(ubuntu-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}}, "code_block": [[53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [53, 61], "resource": "jobs(ubuntu-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}}, "code_block": [[60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [60, 66], "resource": "jobs(ubuntu-e2e).steps[4](Install external security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}}, "code_block": [[65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [65, 69], "resource": "jobs(ubuntu-e2e).steps[5](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}}, "code_block": [[68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [68, 75], "resource": "jobs(ubuntu-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}}, "code_block": [[74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [74, 83], "resource": "jobs(ubuntu-e2e).steps[7](Pull JMo Docker images (if testing Docker variants))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}}, "code_block": [[82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [82, 87], "resource": "jobs(ubuntu-e2e).steps[8](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}}, "code_block": [[86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [86, 105], "resource": "jobs(ubuntu-e2e).steps[9](Run comprehensive test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}}, "code_block": [[104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [104, 114], "resource": "jobs(ubuntu-e2e).steps[10](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}}, "code_block": [[113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [113, 126], "resource": "jobs(ubuntu-e2e).steps[11](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}}, "code_block": [[125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [125, 134], "resource": "jobs(ubuntu-e2e).steps[12](Upload test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}}, "code_block": [[133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [133, 160], "resource": "jobs(ubuntu-e2e).steps[13](Comment PR with test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}}, "code_block": [[159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [159, 176], "resource": "jobs(ubuntu-e2e).steps[14](Check test success)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}}, "code_block": [[190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [190, 194], "resource": "jobs(macos-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}}, "code_block": [[193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [193, 200], "resource": "jobs(macos-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}}, "code_block": [[199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [199, 205], "resource": "jobs(macos-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}}, "code_block": [[204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [204, 210], "resource": "jobs(macos-e2e).steps[4](Install external security tools via Homebrew)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}}, "code_block": [[209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [209, 221], "resource": "jobs(macos-e2e).steps[5](Check Docker availability)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}}, "code_block": [[220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [220, 226], "resource": "jobs(macos-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}}, "code_block": [[225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [225, 230], "resource": "jobs(macos-e2e).steps[7](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}}, "code_block": [[229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [229, 240], "resource": "jobs(macos-e2e).steps[8](Run macOS test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}}, "code_block": [[239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [239, 250], "resource": "jobs(macos-e2e).steps[9](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}}, "code_block": [[249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [249, 260], "resource": "jobs(macos-e2e).steps[10](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}}, "code_block": [[266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [266, 273], "resource": "jobs(summary).steps[1](Download all test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}}, "code_block": [[272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [272, 302], "resource": "jobs(summary).steps[2](Aggregate results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}}, "code_block": [[301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [301, 308], "resource": "jobs(summary).steps[3](Upload summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}}, "code_block": [[44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [44, 48], "resource": "jobs(ubuntu-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}}, "code_block": [[47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [47, 54], "resource": "jobs(ubuntu-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}}, "code_block": [[53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [53, 61], "resource": "jobs(ubuntu-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}}, "code_block": [[60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [60, 66], "resource": "jobs(ubuntu-e2e).steps[4](Install external security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}}, "code_block": [[65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [65, 69], "resource": "jobs(ubuntu-e2e).steps[5](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}}, "code_block": [[68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [68, 75], "resource": "jobs(ubuntu-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}}, "code_block": [[74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [74, 83], "resource": "jobs(ubuntu-e2e).steps[7](Pull JMo Docker images (if testing Docker variants))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}}, "code_block": [[82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [82, 87], "resource": "jobs(ubuntu-e2e).steps[8](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}}, "code_block": [[86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [86, 105], "resource": "jobs(ubuntu-e2e).steps[9](Run comprehensive test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}}, "code_block": [[104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [104, 114], "resource": "jobs(ubuntu-e2e).steps[10](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}}, "code_block": [[113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [113, 126], "resource": "jobs(ubuntu-e2e).steps[11](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}}, "code_block": [[125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [125, 134], "resource": "jobs(ubuntu-e2e).steps[12](Upload test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}}, "code_block": [[133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [133, 160], "resource": "jobs(ubuntu-e2e).steps[13](Comment PR with test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}}, "code_block": [[159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [159, 176], "resource": "jobs(ubuntu-e2e).steps[14](Check test success)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}}, "code_block": [[190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [190, 194], "resource": "jobs(macos-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}}, "code_block": [[193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [193, 200], "resource": "jobs(macos-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}}, "code_block": [[199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [199, 205], "resource": "jobs(macos-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}}, "code_block": [[204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [204, 210], "resource": "jobs(macos-e2e).steps[4](Install external security tools via Homebrew)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}}, "code_block": [[209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [209, 221], "resource": "jobs(macos-e2e).steps[5](Check Docker availability)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}}, "code_block": [[220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [220, 226], "resource": "jobs(macos-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}}, "code_block": [[225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [225, 230], "resource": "jobs(macos-e2e).steps[7](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}}, "code_block": [[229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [229, 240], "resource": "jobs(macos-e2e).steps[8](Run macOS test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}}, "code_block": [[239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [239, 250], "resource": "jobs(macos-e2e).steps[9](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}}, "code_block": [[249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [249, 260], "resource": "jobs(macos-e2e).steps[10](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}}, "code_block": [[266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [266, 273], "resource": "jobs(summary).steps[1](Download all test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}}, "code_block": [[272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [272, 302], "resource": "jobs(summary).steps[2](Aggregate results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}}, "code_block": [[301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [301, 308], "resource": "jobs(summary).steps[3](Upload summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 44, "__endline__": 47}}, "code_block": [[44, "      - name: Checkout repository\n"], [45, "        uses: actions/checkout@v5\n"], [46, "\n"], [47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [44, 48], "resource": "jobs(ubuntu-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 50, "__endline__": 53}, "__startline__": 47, "__endline__": 53}}, "code_block": [[47, "      - name: Set up Python ${{ matrix.python-version }}\n"], [48, "        uses: actions/setup-python@v6\n"], [49, "        with:\n"], [50, "          python-version: ${{ matrix.python-version }}\n"], [51, "          cache: 'pip'\n"], [52, "\n"], [53, "      - name: Install JMo Security\n"], [54, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [47, 54], "resource": "jobs(ubuntu-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\njmo --help || echo \"jmo CLI not available\"\njmotools --help || echo \"jmotools not available\"\n", "__startline__": 53, "__endline__": 60}}, "code_block": [[53, "      - name: Install JMo Security\n"], [54, "        run: |\n"], [55, "          pip install --upgrade pip setuptools wheel\n"], [56, "          pip install -e .\n"], [57, "          jmo --help || echo \"jmo CLI not available\"\n"], [58, "          jmotools --help || echo \"jmotools not available\"\n"], [59, "\n"], [60, "      - name: Install external security tools\n"], [61, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [53, 61], "resource": "jobs(ubuntu-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools", "run": "# Install core tools needed for fast profile\nmake tools || echo \"Some tools failed to install, continuing...\"\n", "__startline__": 60, "__endline__": 65}}, "code_block": [[60, "      - name: Install external security tools\n"], [61, "        run: |\n"], [62, "          # Install core tools needed for fast profile\n"], [63, "          make tools || echo \"Some tools failed to install, continuing...\"\n"], [64, "\n"], [65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [60, 66], "resource": "jobs(ubuntu-e2e).steps[4](Install external security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 65, "__endline__": 68}}, "code_block": [[65, "      - name: Set up Docker Buildx\n"], [66, "        uses: docker/setup-buildx-action@v3\n"], [67, "\n"], [68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [65, 69], "resource": "jobs(ubuntu-e2e).steps[5](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "run": "docker pull alpine:3.19\ndocker pull nginx:alpine\ndocker pull redis:alpine\n", "__startline__": 68, "__endline__": 74}}, "code_block": [[68, "      - name: Pull Docker test images\n"], [69, "        run: |\n"], [70, "          docker pull alpine:3.19\n"], [71, "          docker pull nginx:alpine\n"], [72, "          docker pull redis:alpine\n"], [73, "\n"], [74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [68, 75], "resource": "jobs(ubuntu-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull JMo Docker images (if testing Docker variants)", "if": "github.event.inputs.docker_tag != ''", "run": "docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\ndocker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n", "env": {"DOCKER_TAG": "${{ github.event.inputs.docker_tag }}", "__startline__": 80, "__endline__": 82}, "__startline__": 74, "__endline__": 82}}, "code_block": [[74, "      - name: Pull JMo Docker images (if testing Docker variants)\n"], [75, "        if: github.event.inputs.docker_tag != ''\n"], [76, "        run: |\n"], [77, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-full || echo \"Full image not found\"\n"], [78, "          docker pull ghcr.io/jimmy058910/jmo-security:${{ github.event.inputs.docker_tag }}-slim || echo \"Slim image not found\"\n"], [79, "        env:\n"], [80, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag }}\n"], [81, "\n"], [82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [74, 83], "resource": "jobs(ubuntu-e2e).steps[7](Pull JMo Docker images (if testing Docker variants))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 82, "__endline__": 86}}, "code_block": [[82, "      - name: Setup test fixtures\n"], [83, "        run: |\n"], [84, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [85, "\n"], [86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [82, 87], "resource": "jobs(ubuntu-e2e).steps[8](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive test suite", "id": "run_tests", "run": "if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n  echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n  bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\nelse\n  echo \"Running full Ubuntu + Advanced test suite\"\n  bash tests/e2e/run_comprehensive_tests.sh\nfi\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "TEST_URL": "http://testphp.vulnweb.com", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 97, "__endline__": 102}, "continue-on-error": true, "__startline__": 86, "__endline__": 104}}, "code_block": [[86, "      - name: Run comprehensive test suite\n"], [87, "        id: run_tests\n"], [88, "        run: |\n"], [89, "          if [[ -n \"${{ github.event.inputs.test_id }}\" ]]; then\n"], [90, "            echo \"Running specific test: ${{ github.event.inputs.test_id }}\"\n"], [91, "            bash tests/e2e/run_comprehensive_tests.sh --test \"${{ github.event.inputs.test_id }}\"\n"], [92, "          else\n"], [93, "            echo \"Running full Ubuntu + Advanced test suite\"\n"], [94, "            bash tests/e2e/run_comprehensive_tests.sh\n"], [95, "          fi\n"], [96, "        env:\n"], [97, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [98, "          TEST_IMAGE: alpine:3.19\n"], [99, "          TEST_URL: http://testphp.vulnweb.com\n"], [100, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [101, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [102, "        continue-on-error: true\n"], [103, "\n"], [104, "      - name: Generate test report\n"], [105, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [86, 105], "resource": "jobs(ubuntu-e2e).steps[9](Run comprehensive test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"No test results found\"\nfi\n", "__startline__": 104, "__endline__": 113}}, "code_block": [[104, "      - name: Generate test report\n"], [105, "        if: always()\n"], [106, "        run: |\n"], [107, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [108, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [109, "          else\n"], [110, "            echo \"No test results found\"\n"], [111, "          fi\n"], [112, "\n"], [113, "      - name: Upload test results\n"], [114, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [104, 114], "resource": "jobs(ubuntu-e2e).steps[10](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-ubuntu-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n", "retention-days": 30, "__startline__": 117, "__endline__": 125}, "__startline__": 113, "__endline__": 125}}, "code_block": [[113, "      - name: Upload test results\n"], [114, "        if: always()\n"], [115, "        uses: actions/upload-artifact@v5\n"], [116, "        with:\n"], [117, "          name: e2e-test-results-ubuntu-${{ github.run_id }}\n"], [118, "          path: |\n"], [119, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [120, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [121, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/findings.json\n"], [122, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/summaries/SUMMARY.md\n"], [123, "          retention-days: 30\n"], [124, "\n"], [125, "      - name: Upload test report\n"], [126, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [113, 126], "resource": "jobs(ubuntu-e2e).steps[11](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test report", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-report-${{ github.run_id }}", "path": "test-report.md", "retention-days": 30, "__startline__": 129, "__endline__": 133}, "__startline__": 125, "__endline__": 133}}, "code_block": [[125, "      - name: Upload test report\n"], [126, "        if: always()\n"], [127, "        uses: actions/upload-artifact@v5\n"], [128, "        with:\n"], [129, "          name: e2e-test-report-${{ github.run_id }}\n"], [130, "          path: test-report.md\n"], [131, "          retention-days: 30\n"], [132, "\n"], [133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [125, 134], "resource": "jobs(ubuntu-e2e).steps[12](Upload test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Comment PR with test results", "if": "github.event_name == 'pull_request' && always()", "uses": "actions/github-script@v8", "with": {"script": "const fs = require('fs');\nlet report = '## E2E Comprehensive Test Results\\n\\n';\n\nif (fs.existsSync('test-report.md')) {\n  report += fs.readFileSync('test-report.md', 'utf8');\n} else {\n  report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n}\n\n// Add link to full results\nconst repoUrl = 'https://github.com/${{ github.repository }}';\nconst runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\nreport += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: report\n});\n", "__startline__": 137, "__endline__": 159}, "__startline__": 133, "__endline__": 159}}, "code_block": [[133, "      - name: Comment PR with test results\n"], [134, "        if: github.event_name == 'pull_request' && always()\n"], [135, "        uses: actions/github-script@v8\n"], [136, "        with:\n"], [137, "          script: |\n"], [138, "            const fs = require('fs');\n"], [139, "            let report = '## E2E Comprehensive Test Results\\n\\n';\n"], [140, "\n"], [141, "            if (fs.existsSync('test-report.md')) {\n"], [142, "              report += fs.readFileSync('test-report.md', 'utf8');\n"], [143, "            } else {\n"], [144, "              report += '\u26a0\ufe0f Test report generation failed. Check workflow logs for details.\\n';\n"], [145, "            }\n"], [146, "\n"], [147, "            // Add link to full results\n"], [148, "            const repoUrl = 'https://github.com/${{ github.repository }}';\n"], [149, "            const runUrl = `${repoUrl}/actions/runs/${{ github.run_id }}`;\n"], [150, "            report += `\\n\\n\ud83d\udcca [View full test results artifact](${runUrl})\\n`;\n"], [151, "\n"], [152, "            github.rest.issues.createComment({\n"], [153, "              issue_number: context.issue.number,\n"], [154, "              owner: context.repo.owner,\n"], [155, "              repo: context.repo.repo,\n"], [156, "              body: report\n"], [157, "            });\n"], [158, "\n"], [159, "      - name: Check test success\n"], [160, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [133, 160], "resource": "jobs(ubuntu-e2e).steps[13](Comment PR with test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check test success", "if": "always()", "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n  if [[ $FAILED_TESTS -gt 0 ]]; then\n    echo \"\u274c $FAILED_TESTS tests failed\"\n    exit 1\n  else\n    echo \"\u2705 All tests passed\"\n  fi\nelse\n  echo \"\u274c No test results found\"\n  exit 1\nfi\n", "__startline__": 159, "__endline__": 175}}, "code_block": [[159, "      - name: Check test success\n"], [160, "        if: always()\n"], [161, "        run: |\n"], [162, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [163, "            FAILED_TESTS=$(grep -c \",FAIL,\" /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv || echo 0)\n"], [164, "            if [[ $FAILED_TESTS -gt 0 ]]; then\n"], [165, "              echo \"\u274c $FAILED_TESTS tests failed\"\n"], [166, "              exit 1\n"], [167, "            else\n"], [168, "              echo \"\u2705 All tests passed\"\n"], [169, "            fi\n"], [170, "          else\n"], [171, "            echo \"\u274c No test results found\"\n"], [172, "            exit 1\n"], [173, "          fi\n"], [174, "\n"], [175, "  macos-e2e:\n"], [176, "    name: macOS E2E Tests\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [159, 176], "resource": "jobs(ubuntu-e2e).steps[14](Check test success)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["ubuntu-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 190, "__endline__": 193}}, "code_block": [[190, "      - name: Checkout repository\n"], [191, "        uses: actions/checkout@v5\n"], [192, "\n"], [193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [190, 194], "resource": "jobs(macos-e2e).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "__startline__": 196, "__endline__": 199}, "__startline__": 193, "__endline__": 199}}, "code_block": [[193, "      - name: Set up Python ${{ matrix.python-version }}\n"], [194, "        uses: actions/setup-python@v6\n"], [195, "        with:\n"], [196, "          python-version: ${{ matrix.python-version }}\n"], [197, "          cache: 'pip'\n"], [198, "\n"], [199, "      - name: Install JMo Security\n"], [200, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [193, 200], "resource": "jobs(macos-e2e).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install JMo Security", "run": "pip install --upgrade pip setuptools wheel\npip install -e .\n", "__startline__": 199, "__endline__": 204}}, "code_block": [[199, "      - name: Install JMo Security\n"], [200, "        run: |\n"], [201, "          pip install --upgrade pip setuptools wheel\n"], [202, "          pip install -e .\n"], [203, "\n"], [204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [199, 205], "resource": "jobs(macos-e2e).steps[3](Install JMo Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install external security tools via Homebrew", "run": "# Install core tools for macOS testing\nbrew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n", "__startline__": 204, "__endline__": 209}}, "code_block": [[204, "      - name: Install external security tools via Homebrew\n"], [205, "        run: |\n"], [206, "          # Install core tools for macOS testing\n"], [207, "          brew install semgrep trivy syft checkov hadolint || echo \"Some tools failed\"\n"], [208, "\n"], [209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [204, 210], "resource": "jobs(macos-e2e).steps[4](Install external security tools via Homebrew)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Docker availability", "id": "check_docker", "run": "if command -v docker &> /dev/null; then\n  echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u2705 Docker is available\"\nelse\n  echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n  echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\nfi\n", "__startline__": 209, "__endline__": 220}}, "code_block": [[209, "      - name: Check Docker availability\n"], [210, "        id: check_docker\n"], [211, "        run: |\n"], [212, "          if command -v docker &> /dev/null; then\n"], [213, "            echo \"docker_available=true\" >> \"$GITHUB_OUTPUT\"\n"], [214, "            echo \"\u2705 Docker is available\"\n"], [215, "          else\n"], [216, "            echo \"docker_available=false\" >> \"$GITHUB_OUTPUT\"\n"], [217, "            echo \"\u26a0\ufe0f Docker is not available on this runner (expected for macOS)\"\n"], [218, "          fi\n"], [219, "\n"], [220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [209, 221], "resource": "jobs(macos-e2e).steps[5](Check Docker availability)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull Docker test images", "if": "steps.check_docker.outputs.docker_available == 'true'", "run": "docker pull alpine:3.19\n", "__startline__": 220, "__endline__": 225}}, "code_block": [[220, "      - name: Pull Docker test images\n"], [221, "        if: steps.check_docker.outputs.docker_available == 'true'\n"], [222, "        run: |\n"], [223, "          docker pull alpine:3.19\n"], [224, "\n"], [225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [220, 226], "resource": "jobs(macos-e2e).steps[6](Pull Docker test images)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Setup test fixtures", "run": "bash tests/e2e/fixtures/setup_fixtures.sh\n", "__startline__": 225, "__endline__": 229}}, "code_block": [[225, "      - name: Setup test fixtures\n"], [226, "        run: |\n"], [227, "          bash tests/e2e/fixtures/setup_fixtures.sh\n"], [228, "\n"], [229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [225, 230], "resource": "jobs(macos-e2e).steps[7](Setup test fixtures)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run macOS test suite", "run": "bash tests/e2e/run_comprehensive_tests.sh\n", "env": {"TEST_REPO": "https://github.com/juice-shop/juice-shop.git", "TEST_IMAGE": "alpine:3.19", "DOCKER_TAG": "${{ github.event.inputs.docker_tag || 'latest' }}", "RESULTS_BASE": "/tmp/jmo-e2e-results-${{ github.run_id }}", "__startline__": 233, "__endline__": 237}, "continue-on-error": true, "__startline__": 229, "__endline__": 239}}, "code_block": [[229, "      - name: Run macOS test suite\n"], [230, "        run: |\n"], [231, "          bash tests/e2e/run_comprehensive_tests.sh\n"], [232, "        env:\n"], [233, "          TEST_REPO: https://github.com/juice-shop/juice-shop.git\n"], [234, "          TEST_IMAGE: alpine:3.19\n"], [235, "          DOCKER_TAG: ${{ github.event.inputs.docker_tag || 'latest' }}\n"], [236, "          RESULTS_BASE: /tmp/jmo-e2e-results-${{ github.run_id }}\n"], [237, "        continue-on-error: true\n"], [238, "\n"], [239, "      - name: Generate test report\n"], [240, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [229, 240], "resource": "jobs(macos-e2e).steps[8](Run macOS test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate test report", "if": "always()", "continue-on-error": true, "run": "if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n  python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\nelse\n  echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\nfi\n", "__startline__": 239, "__endline__": 249}}, "code_block": [[239, "      - name: Generate test report\n"], [240, "        if: always()\n"], [241, "        continue-on-error: true\n"], [242, "        run: |\n"], [243, "          if [[ -f /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv ]]; then\n"], [244, "            python tests/e2e/generate_report.py /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [245, "          else\n"], [246, "            echo \"\u26a0\ufe0f No test results CSV found, skipping report generation\"\n"], [247, "          fi\n"], [248, "\n"], [249, "      - name: Upload test results\n"], [250, "        if: always()\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [239, 250], "resource": "jobs(macos-e2e).steps[9](Generate test report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "e2e-test-results-macos-${{ github.run_id }}", "path": "/tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n/tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n", "retention-days": 30, "__startline__": 253, "__endline__": 259}, "__startline__": 249, "__endline__": 259}}, "code_block": [[249, "      - name: Upload test results\n"], [250, "        if: always()\n"], [251, "        uses: actions/upload-artifact@v5\n"], [252, "        with:\n"], [253, "          name: e2e-test-results-macos-${{ github.run_id }}\n"], [254, "          path: |\n"], [255, "            /tmp/jmo-e2e-results-${{ github.run_id }}/test-results.csv\n"], [256, "            /tmp/jmo-e2e-results-${{ github.run_id }}/*/test.log\n"], [257, "          retention-days: 30\n"], [258, "\n"], [259, "  summary:\n"], [260, "    name: Test Summary\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [249, 260], "resource": "jobs(macos-e2e).steps[10](Upload test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["macos-e2e"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Download all test results", "uses": "actions/download-artifact@v6", "with": {"pattern": "e2e-test-results-*", "path": "test-results", "__startline__": 269, "__endline__": 272}, "__startline__": 266, "__endline__": 272}}, "code_block": [[266, "      - name: Download all test results\n"], [267, "        uses: actions/download-artifact@v6\n"], [268, "        with:\n"], [269, "          pattern: e2e-test-results-*\n"], [270, "          path: test-results\n"], [271, "\n"], [272, "      - name: Aggregate results\n"], [273, "        run: |\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [266, 273], "resource": "jobs(summary).steps[1](Download all test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Aggregate results", "run": "{\n  echo \"## E2E Test Summary\"\n  echo \"\"\n} > summary.md\n\nfor results_file in test-results/*/test-results.csv; do\n  if [[ -f \"$results_file\" ]]; then\n    os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n\n    total=$(($(wc -l < \"$results_file\") - 1))\n    passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n    failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n    skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n\n    {\n      echo \"### $os Results\"\n      echo \"- Total: $total\"\n      echo \"- Passed: $passed \u2705\"\n      echo \"- Failed: $failed \u274c\"\n      echo \"- Skipped: $skipped \u23ed\ufe0f\"\n      echo \"\"\n    } >> summary.md\n  fi\ndone\n\ncat summary.md\n", "__startline__": 272, "__endline__": 301}}, "code_block": [[272, "      - name: Aggregate results\n"], [273, "        run: |\n"], [274, "          {\n"], [275, "            echo \"## E2E Test Summary\"\n"], [276, "            echo \"\"\n"], [277, "          } > summary.md\n"], [278, "\n"], [279, "          for results_file in test-results/*/test-results.csv; do\n"], [280, "            if [[ -f \"$results_file\" ]]; then\n"], [281, "              os=$(dirname \"$results_file\" | xargs basename | cut -d'-' -f4)\n"], [282, "\n"], [283, "              total=$(($(wc -l < \"$results_file\") - 1))\n"], [284, "              passed=$(grep -c \",PASS,\" \"$results_file\" || echo 0)\n"], [285, "              failed=$(grep -c \",FAIL,\" \"$results_file\" || echo 0)\n"], [286, "              skipped=$(grep -c \",SKIP,\" \"$results_file\" || echo 0)\n"], [287, "\n"], [288, "              {\n"], [289, "                echo \"### $os Results\"\n"], [290, "                echo \"- Total: $total\"\n"], [291, "                echo \"- Passed: $passed \u2705\"\n"], [292, "                echo \"- Failed: $failed \u274c\"\n"], [293, "                echo \"- Skipped: $skipped \u23ed\ufe0f\"\n"], [294, "                echo \"\"\n"], [295, "              } >> summary.md\n"], [296, "            fi\n"], [297, "          done\n"], [298, "\n"], [299, "          cat summary.md\n"], [300, "\n"], [301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [272, 302], "resource": "jobs(summary).steps[2](Aggregate results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload summary", "uses": "actions/upload-artifact@v5", "with": {"name": "test-summary-${{ github.run_id }}", "path": "summary.md", "retention-days": 90, "__startline__": 304, "__endline__": 307}, "__startline__": 301, "__endline__": 307}}, "code_block": [[301, "      - name: Upload summary\n"], [302, "        uses: actions/upload-artifact@v5\n"], [303, "        with:\n"], [304, "          name: test-summary-${{ github.run_id }}\n"], [305, "          path: summary.md\n"], [306, "          retention-days: 90\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [301, 308], "resource": "jobs(summary).steps[3](Upload summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": ["summary"], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}}, "code_block": [[27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [27, 120], "resource": "jobs(bump-formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}}, "code_block": [[27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [27, 120], "resource": "jobs(bump-formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}}, "code_block": [[27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [27, 120], "resource": "jobs(bump-formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"bump-formula": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}, "__startline__": 26, "__endline__": 119}}, "code_block": [[26, "  bump-formula:\n"], [27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [26, 120], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}}, "code_block": [[27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [27, 120], "resource": "jobs(bump-formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"bump-formula": {"name": "Submit PR to homebrew-core", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'", "timeout-minutes": 10, "steps": [{"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}, {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}, {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}, {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}, {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}], "__startline__": 27, "__endline__": 119}, "__startline__": 26, "__endline__": 119}}, "code_block": [[26, "  bump-formula:\n"], [27, "    name: Submit PR to homebrew-core\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    if: startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch'\n"], [30, "    timeout-minutes: 10\n"], [31, "\n"], [32, "    steps:\n"], [33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [26, 120], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}}, "code_block": [[33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [33, 45], "resource": "jobs(bump-formula).steps[1](Extract version from tag or input)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}}, "code_block": [[44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [44, 68], "resource": "jobs(bump-formula).steps[2](Verify PyPI release exists)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}}, "code_block": [[67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [67, 92], "resource": "jobs(bump-formula).steps[3](Bump Homebrew formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}}, "code_block": [[91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [91, 105], "resource": "jobs(bump-formula).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}}, "code_block": [[104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [104, 120], "resource": "jobs(bump-formula).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}}, "code_block": [[33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [33, 45], "resource": "jobs(bump-formula).steps[1](Extract version from tag or input)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}}, "code_block": [[44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [44, 68], "resource": "jobs(bump-formula).steps[2](Verify PyPI release exists)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}}, "code_block": [[67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [67, 92], "resource": "jobs(bump-formula).steps[3](Bump Homebrew formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}}, "code_block": [[91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [91, 105], "resource": "jobs(bump-formula).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}}, "code_block": [[104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [104, 120], "resource": "jobs(bump-formula).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}}, "code_block": [[33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [33, 45], "resource": "jobs(bump-formula).steps[1](Extract version from tag or input)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}}, "code_block": [[44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [44, 68], "resource": "jobs(bump-formula).steps[2](Verify PyPI release exists)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}}, "code_block": [[67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [67, 92], "resource": "jobs(bump-formula).steps[3](Bump Homebrew formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}}, "code_block": [[91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [91, 105], "resource": "jobs(bump-formula).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}}, "code_block": [[104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [104, 120], "resource": "jobs(bump-formula).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from tag or input", "id": "version", "run": "if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n  VERSION=\"${{ github.event.inputs.version }}\"\nelse\n  VERSION=\"${GITHUB_REF#refs/tags/v}\"\nfi\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n", "__startline__": 33, "__endline__": 44}}, "code_block": [[33, "      - name: Extract version from tag or input\n"], [34, "        id: version\n"], [35, "        run: |\n"], [36, "          if [ \"${{ github.event_name }}\" = \"workflow_dispatch\" ]; then\n"], [37, "            VERSION=\"${{ github.event.inputs.version }}\"\n"], [38, "          else\n"], [39, "            VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [40, "          fi\n"], [41, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [42, "          echo \"\ud83d\udce6 Bumping Homebrew formula to version: $VERSION\"\n"], [43, "\n"], [44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [33, 45], "resource": "jobs(bump-formula).steps[1](Extract version from tag or input)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI release exists", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n\n# Wait up to 5 minutes for PyPI to be available\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n  sleep 10\ndone\n\necho \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\necho \"Homebrew formula bump requires PyPI tarball to be available\"\necho \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\nexit 1\n", "__startline__": 44, "__endline__": 67}}, "code_block": [[44, "      - name: Verify PyPI release exists\n"], [45, "        run: |\n"], [46, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [47, "          echo \"\ud83d\udd0d Verifying PyPI release exists for version $VERSION...\"\n"], [48, "\n"], [49, "          # Wait up to 5 minutes for PyPI to be available\n"], [50, "          MAX_ATTEMPTS=30\n"], [51, "          ATTEMPT=0\n"], [52, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [53, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [54, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [55, "              exit 0\n"], [56, "            fi\n"], [57, "            ATTEMPT=$((ATTEMPT + 1))\n"], [58, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: PyPI release not yet available, waiting 10s...\"\n"], [59, "            sleep 10\n"], [60, "          done\n"], [61, "\n"], [62, "          echo \"\u274c ERROR: PyPI release $VERSION not found after 5 minutes\"\n"], [63, "          echo \"Homebrew formula bump requires PyPI tarball to be available\"\n"], [64, "          echo \"Please verify the release exists: https://pypi.org/project/jmo-security/$VERSION/\"\n"], [65, "          exit 1\n"], [66, "\n"], [67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [44, 68], "resource": "jobs(bump-formula).steps[2](Verify PyPI release exists)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Bump Homebrew formula", "uses": "dawidd6/action-homebrew-bump-formula@v4", "with": {"token": "${{ secrets.HOMEBREW_BUMP_TOKEN }}", "formula": "jmo-security", "tag": "v${{ steps.version.outputs.version }}", "force": false, "__startline__": 74, "__endline__": 91}, "__startline__": 67, "__endline__": 91}}, "code_block": [[67, "      - name: Bump Homebrew formula\n"], [68, "        uses: dawidd6/action-homebrew-bump-formula@v4\n"], [69, "        with:\n"], [70, "          # Required: Personal Access Token with repo + workflow scopes\n"], [71, "          # Setup: GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [72, "          # Scopes: repo, workflow\n"], [73, "          # Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [74, "          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}\n"], [75, "\n"], [76, "          # Formula details\n"], [77, "          formula: jmo-security\n"], [78, "\n"], [79, "          # Tag name (with v prefix)\n"], [80, "          tag: v${{ steps.version.outputs.version }}\n"], [81, "\n"], [82, "          # Revision for HEAD-only formulas (not applicable for tagged releases)\n"], [83, "          # revision: ${{ github.sha }}\n"], [84, "\n"], [85, "          # Force update even if version hasn't changed (default: false)\n"], [86, "          force: false\n"], [87, "\n"], [88, "          # Tap to bump (default: homebrew/core for public formulas)\n"], [89, "          # tap: Homebrew/homebrew-core  # Automatically detected\n"], [90, "\n"], [91, "      - name: Success notification\n"], [92, "        if: success()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [67, 92], "resource": "jobs(bump-formula).steps[3](Bump Homebrew formula)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\necho \"\"\necho \"\ud83d\udccb Next steps:\"\necho \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\necho \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\necho \"  3. After merge, users can install with: brew install jmo-security\"\necho \"\"\necho \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n", "__startline__": 91, "__endline__": 104}}, "code_block": [[91, "      - name: Success notification\n"], [92, "        if: success()\n"], [93, "        run: |\n"], [94, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [95, "          echo \"\u2705 Successfully submitted PR to homebrew-core for version $VERSION\"\n"], [96, "          echo \"\"\n"], [97, "          echo \"\ud83d\udccb Next steps:\"\n"], [98, "          echo \"  1. Monitor PR at: https://github.com/Homebrew/homebrew-core/pulls?q=is%3Apr+jmo-security\"\n"], [99, "          echo \"  2. Homebrew maintainers will review (typically 1-2 weeks)\"\n"], [100, "          echo \"  3. After merge, users can install with: brew install jmo-security\"\n"], [101, "          echo \"\"\n"], [102, "          echo \"\ud83d\udd17 Homebrew formula: https://github.com/Homebrew/homebrew-core/blob/master/Formula/j/jmo-security.rb\"\n"], [103, "\n"], [104, "      - name: Failure notification\n"], [105, "        if: failure()\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [91, 105], "resource": "jobs(bump-formula).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u274c Failed to bump Homebrew formula for version $VERSION\"\necho \"\"\necho \"Common issues:\"\necho \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\necho \"  2. PyPI release not yet available\"\necho \"  3. Formula already up-to-date\"\necho \"  4. SHA256 mismatch in existing formula\"\necho \"\"\necho \"Manual fallback:\"\necho \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\nexit 1\n", "__startline__": 104, "__endline__": 119}}, "code_block": [[104, "      - name: Failure notification\n"], [105, "        if: failure()\n"], [106, "        run: |\n"], [107, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [108, "          echo \"\u274c Failed to bump Homebrew formula for version $VERSION\"\n"], [109, "          echo \"\"\n"], [110, "          echo \"Common issues:\"\n"], [111, "          echo \"  1. HOMEBREW_BUMP_TOKEN not configured (see workflow comments)\"\n"], [112, "          echo \"  2. PyPI release not yet available\"\n"], [113, "          echo \"  3. Formula already up-to-date\"\n"], [114, "          echo \"  4. SHA256 mismatch in existing formula\"\n"], [115, "          echo \"\"\n"], [116, "          echo \"Manual fallback:\"\n"], [117, "          echo \"  brew bump-formula-pr --tag=v$VERSION jmo-security\"\n"], [118, "          exit 1\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [104, 120], "resource": "jobs(bump-formula).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["bump-formula"], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}}, "code_block": [[15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [15, 97], "resource": "jobs(extended-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}}, "code_block": [[97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [97, 135], "resource": "jobs(cross-platform-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}}, "code_block": [[135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [135, 168], "resource": "jobs(security-regression-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}}, "code_block": [[168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [168, 203], "resource": "jobs(docker-smoke-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}}, "code_block": [[203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [203, 264], "resource": "jobs(notify-on-failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}}, "code_block": [[15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [15, 97], "resource": "jobs(extended-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}}, "code_block": [[97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [97, 135], "resource": "jobs(cross-platform-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}}, "code_block": [[135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [135, 168], "resource": "jobs(security-regression-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}}, "code_block": [[168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [168, 203], "resource": "jobs(docker-smoke-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}}, "code_block": [[203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [203, 264], "resource": "jobs(notify-on-failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}}, "code_block": [[15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [15, 97], "resource": "jobs(extended-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}}, "code_block": [[97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [97, 135], "resource": "jobs(cross-platform-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}}, "code_block": [[135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [135, 168], "resource": "jobs(security-regression-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}}, "code_block": [[168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [168, 203], "resource": "jobs(docker-smoke-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}}, "code_block": [[203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [203, 264], "resource": "jobs(notify-on-failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"extended-tests": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}, "cross-platform-tests": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}, "security-regression-tests": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}, "docker-smoke-tests": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}, "notify-on-failure": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}, "__startline__": 14, "__endline__": 263}}, "code_block": [[14, "  extended-tests:\n"], [15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [14, 264], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}}, "code_block": [[15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [15, 97], "resource": "jobs(extended-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}}, "code_block": [[97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [97, 135], "resource": "jobs(cross-platform-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}}, "code_block": [[135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [135, 168], "resource": "jobs(security-regression-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}}, "code_block": [[168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [168, 203], "resource": "jobs(docker-smoke-tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}}, "code_block": [[203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [203, 264], "resource": "jobs(notify-on-failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"extended-tests": {"name": "Extended Test Suite", "runs-on": "ubuntu-latest", "timeout-minutes": 60, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}, {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}, {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}, {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}, {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}, {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}, {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}, {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}], "__startline__": 15, "__endline__": 96}, "cross-platform-tests": {"name": "Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})", "runs-on": "${{ matrix.os }}", "timeout-minutes": 45, "strategy": {"fail-fast": false, "matrix": {"os": ["ubuntu-latest", "macos-latest", "windows-latest"], "python-version": ["3.10", "3.11", "3.12"], "__startline__": 103, "__endline__": 105}, "__startline__": 101, "__endline__": 105}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}, {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}, {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}], "__startline__": 97, "__endline__": 134}, "security-regression-tests": {"name": "Security Regression Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}, {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}, {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}, {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}], "__startline__": 135, "__endline__": 167}, "docker-smoke-tests": {"name": "Docker Smoke Tests", "runs-on": "ubuntu-latest", "timeout-minutes": 30, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}, {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}, {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}, {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}, {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}], "__startline__": 168, "__endline__": 202}, "notify-on-failure": {"name": "Notify on Failure", "runs-on": "ubuntu-latest", "needs": ["extended-tests", "cross-platform-tests", "security-regression-tests", "docker-smoke-tests"], "if": "failure()", "steps": [{"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}], "__startline__": 203, "__endline__": 263}, "__startline__": 14, "__endline__": 263}}, "code_block": [[14, "  extended-tests:\n"], [15, "    name: Extended Test Suite\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 60  # Extended tests can take longer\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"], [98, "    runs-on: ${{ matrix.os }}\n"], [99, "    timeout-minutes: 45\n"], [100, "    strategy:\n"], [101, "      fail-fast: false\n"], [102, "      matrix:\n"], [103, "        os: [ubuntu-latest, macos-latest, windows-latest]\n"], [104, "        python-version: ['3.10', '3.11', '3.12']\n"], [105, "    steps:\n"], [106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"], [136, "    runs-on: ubuntu-latest\n"], [137, "    timeout-minutes: 30\n"], [138, "    steps:\n"], [139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"], [169, "    runs-on: ubuntu-latest\n"], [170, "    timeout-minutes: 30\n"], [171, "    steps:\n"], [172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"], [204, "    runs-on: ubuntu-latest\n"], [205, "    needs: [extended-tests, cross-platform-tests, security-regression-tests, docker-smoke-tests]\n"], [206, "    if: failure()\n"], [207, "    steps:\n"], [208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [14, 264], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"schedule": [{"cron": "0 2 * * *", "__startline__": 6, "__endline__": 7}], "workflow_dispatch": null, "__startline__": 5, "__endline__": 9}}, "code_block": [[5, "  schedule:\n"], [6, "    - cron: '0 2 * * *'  # Daily at 2 AM UTC\n"], [7, "  workflow_dispatch:  # Allow manual trigger\n"], [8, "\n"], [9, "permissions:\n"], [10, "  contents: read\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [5, 10], "resource": "on(Nightly Extended Tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [19, 23], "resource": "jobs(extended-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}}, "code_block": [[22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [22, 30], "resource": "jobs(extended-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [29, 36], "resource": "jobs(extended-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}}, "code_block": [[35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [35, 42], "resource": "jobs(extended-tests).steps[4](Install security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}}, "code_block": [[41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [41, 53], "resource": "jobs(extended-tests).steps[5](Run full test suite (including slow tests))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}}, "code_block": [[52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [52, 60], "resource": "jobs(extended-tests).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}}, "code_block": [[59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [59, 64], "resource": "jobs(extended-tests).steps[7](Run performance benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}}, "code_block": [[63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [63, 68], "resource": "jobs(extended-tests).steps[8](Run load tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}}, "code_block": [[67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [67, 86], "resource": "jobs(extended-tests).steps[9](Run security audit)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}}, "code_block": [[85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [85, 97], "resource": "jobs(extended-tests).steps[10](Archive test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}}, "code_block": [[106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [106, 110], "resource": "jobs(cross-platform-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}}, "code_block": [[109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [109, 117], "resource": "jobs(cross-platform-tests).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}}, "code_block": [[116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [116, 123], "resource": "jobs(cross-platform-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}}, "code_block": [[122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [122, 131], "resource": "jobs(cross-platform-tests).steps[4](Run unit tests (platform-agnostic))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}}, "code_block": [[130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [130, 135], "resource": "jobs(cross-platform-tests).steps[5](Run CLI tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}}, "code_block": [[139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [139, 143], "resource": "jobs(security-regression-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}}, "code_block": [[142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [142, 150], "resource": "jobs(security-regression-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}}, "code_block": [[149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [149, 156], "resource": "jobs(security-regression-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}}, "code_block": [[155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [155, 160], "resource": "jobs(security-regression-tests).steps[4](Run security regression test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}}, "code_block": [[159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [159, 164], "resource": "jobs(security-regression-tests).steps[5](Run SQL injection tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}}, "code_block": [[163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [163, 168], "resource": "jobs(security-regression-tests).steps[6](Run path traversal tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}}, "code_block": [[172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [172, 176], "resource": "jobs(docker-smoke-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}}, "code_block": [[175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [175, 179], "resource": "jobs(docker-smoke-tests).steps[2](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}}, "code_block": [[178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [178, 183], "resource": "jobs(docker-smoke-tests).steps[3](Build Docker image (balanced variant))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}}, "code_block": [[182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [182, 187], "resource": "jobs(docker-smoke-tests).steps[4](Test Docker image --help)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}}, "code_block": [[186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [186, 191], "resource": "jobs(docker-smoke-tests).steps[5](Test Docker scan command)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}}, "code_block": [[190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [190, 203], "resource": "jobs(docker-smoke-tests).steps[6](Scan test repository with Docker)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}}, "code_block": [[208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [208, 264], "resource": "jobs(notify-on-failure).steps[1](Create issue on failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [19, 23], "resource": "jobs(extended-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}}, "code_block": [[22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [22, 30], "resource": "jobs(extended-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [29, 36], "resource": "jobs(extended-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}}, "code_block": [[35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [35, 42], "resource": "jobs(extended-tests).steps[4](Install security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}}, "code_block": [[41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [41, 53], "resource": "jobs(extended-tests).steps[5](Run full test suite (including slow tests))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}}, "code_block": [[52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [52, 60], "resource": "jobs(extended-tests).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}}, "code_block": [[59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [59, 64], "resource": "jobs(extended-tests).steps[7](Run performance benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}}, "code_block": [[63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [63, 68], "resource": "jobs(extended-tests).steps[8](Run load tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}}, "code_block": [[67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [67, 86], "resource": "jobs(extended-tests).steps[9](Run security audit)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}}, "code_block": [[85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [85, 97], "resource": "jobs(extended-tests).steps[10](Archive test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}}, "code_block": [[106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [106, 110], "resource": "jobs(cross-platform-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}}, "code_block": [[109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [109, 117], "resource": "jobs(cross-platform-tests).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}}, "code_block": [[116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [116, 123], "resource": "jobs(cross-platform-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}}, "code_block": [[122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [122, 131], "resource": "jobs(cross-platform-tests).steps[4](Run unit tests (platform-agnostic))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}}, "code_block": [[130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [130, 135], "resource": "jobs(cross-platform-tests).steps[5](Run CLI tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}}, "code_block": [[139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [139, 143], "resource": "jobs(security-regression-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}}, "code_block": [[142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [142, 150], "resource": "jobs(security-regression-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}}, "code_block": [[149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [149, 156], "resource": "jobs(security-regression-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}}, "code_block": [[155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [155, 160], "resource": "jobs(security-regression-tests).steps[4](Run security regression test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}}, "code_block": [[159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [159, 164], "resource": "jobs(security-regression-tests).steps[5](Run SQL injection tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}}, "code_block": [[163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [163, 168], "resource": "jobs(security-regression-tests).steps[6](Run path traversal tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}}, "code_block": [[172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [172, 176], "resource": "jobs(docker-smoke-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}}, "code_block": [[175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [175, 179], "resource": "jobs(docker-smoke-tests).steps[2](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}}, "code_block": [[178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [178, 183], "resource": "jobs(docker-smoke-tests).steps[3](Build Docker image (balanced variant))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}}, "code_block": [[182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [182, 187], "resource": "jobs(docker-smoke-tests).steps[4](Test Docker image --help)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}}, "code_block": [[186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [186, 191], "resource": "jobs(docker-smoke-tests).steps[5](Test Docker scan command)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}}, "code_block": [[190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [190, 203], "resource": "jobs(docker-smoke-tests).steps[6](Scan test repository with Docker)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}}, "code_block": [[208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [208, 264], "resource": "jobs(notify-on-failure).steps[1](Create issue on failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [19, 23], "resource": "jobs(extended-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}}, "code_block": [[22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [22, 30], "resource": "jobs(extended-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [29, 36], "resource": "jobs(extended-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}}, "code_block": [[35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [35, 42], "resource": "jobs(extended-tests).steps[4](Install security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}}, "code_block": [[41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [41, 53], "resource": "jobs(extended-tests).steps[5](Run full test suite (including slow tests))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}}, "code_block": [[52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [52, 60], "resource": "jobs(extended-tests).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}}, "code_block": [[59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [59, 64], "resource": "jobs(extended-tests).steps[7](Run performance benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}}, "code_block": [[63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [63, 68], "resource": "jobs(extended-tests).steps[8](Run load tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}}, "code_block": [[67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [67, 86], "resource": "jobs(extended-tests).steps[9](Run security audit)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}}, "code_block": [[85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [85, 97], "resource": "jobs(extended-tests).steps[10](Archive test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}}, "code_block": [[106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [106, 110], "resource": "jobs(cross-platform-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}}, "code_block": [[109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [109, 117], "resource": "jobs(cross-platform-tests).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}}, "code_block": [[116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [116, 123], "resource": "jobs(cross-platform-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}}, "code_block": [[122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [122, 131], "resource": "jobs(cross-platform-tests).steps[4](Run unit tests (platform-agnostic))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}}, "code_block": [[130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [130, 135], "resource": "jobs(cross-platform-tests).steps[5](Run CLI tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}}, "code_block": [[139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [139, 143], "resource": "jobs(security-regression-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}}, "code_block": [[142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [142, 150], "resource": "jobs(security-regression-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}}, "code_block": [[149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [149, 156], "resource": "jobs(security-regression-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}}, "code_block": [[155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [155, 160], "resource": "jobs(security-regression-tests).steps[4](Run security regression test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}}, "code_block": [[159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [159, 164], "resource": "jobs(security-regression-tests).steps[5](Run SQL injection tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}}, "code_block": [[163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [163, 168], "resource": "jobs(security-regression-tests).steps[6](Run path traversal tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}}, "code_block": [[172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [172, 176], "resource": "jobs(docker-smoke-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}}, "code_block": [[175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [175, 179], "resource": "jobs(docker-smoke-tests).steps[2](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}}, "code_block": [[178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [178, 183], "resource": "jobs(docker-smoke-tests).steps[3](Build Docker image (balanced variant))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}}, "code_block": [[182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [182, 187], "resource": "jobs(docker-smoke-tests).steps[4](Test Docker image --help)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}}, "code_block": [[186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [186, 191], "resource": "jobs(docker-smoke-tests).steps[5](Test Docker scan command)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}}, "code_block": [[190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [190, 203], "resource": "jobs(docker-smoke-tests).steps[6](Scan test repository with Docker)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}}, "code_block": [[208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [208, 264], "resource": "jobs(notify-on-failure).steps[1](Create issue on failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 19, "__endline__": 22}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "\n"], [22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [19, 23], "resource": "jobs(extended-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 25, "__endline__": 29}, "__startline__": 22, "__endline__": 29}}, "code_block": [[22, "      - name: Set up Python 3.11\n"], [23, "        uses: actions/setup-python@v6\n"], [24, "        with:\n"], [25, "          python-version: '3.11'\n"], [26, "          cache: pip\n"], [27, "          cache-dependency-path: requirements-dev.txt\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [22, 30], "resource": "jobs(extended-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 29, "__endline__": 35}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          python -m pip install --upgrade pip\n"], [32, "          pip install -e .\n"], [33, "          pip install -r requirements-dev.txt\n"], [34, "\n"], [35, "      - name: Install security tools\n"], [36, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [29, 36], "resource": "jobs(extended-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools", "run": "# Install critical tools for testing\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\npip install bandit\n", "__startline__": 35, "__endline__": 41}}, "code_block": [[35, "      - name: Install security tools\n"], [36, "        run: |\n"], [37, "          # Install critical tools for testing\n"], [38, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [39, "          pip install bandit\n"], [40, "\n"], [41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [35, 42], "resource": "jobs(extended-tests).steps[4](Install security tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run full test suite (including slow tests)", "run": "pytest tests/ \\\n  --cov=scripts \\\n  --cov-report=html \\\n  --cov-report=term-missing \\\n  --cov-report=xml \\\n  -v \\\n  --durations=20 \\\n  --maxfail=5\n", "__startline__": 41, "__endline__": 52}}, "code_block": [[41, "      - name: Run full test suite (including slow tests)\n"], [42, "        run: |\n"], [43, "          pytest tests/ \\\n"], [44, "            --cov=scripts \\\n"], [45, "            --cov-report=html \\\n"], [46, "            --cov-report=term-missing \\\n"], [47, "            --cov-report=xml \\\n"], [48, "            -v \\\n"], [49, "            --durations=20 \\\n"], [50, "            --maxfail=5\n"], [51, "\n"], [52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [41, 53], "resource": "jobs(extended-tests).steps[5](Run full test suite (including slow tests))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload coverage to Codecov", "uses": "codecov/codecov-action@v5", "with": {"files": "./coverage.xml", "flags": "nightly", "name": "nightly-coverage", "__startline__": 55, "__endline__": 59}, "__startline__": 52, "__endline__": 59}}, "code_block": [[52, "      - name: Upload coverage to Codecov\n"], [53, "        uses: codecov/codecov-action@v5\n"], [54, "        with:\n"], [55, "          files: ./coverage.xml\n"], [56, "          flags: nightly\n"], [57, "          name: nightly-coverage\n"], [58, "\n"], [59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [52, 60], "resource": "jobs(extended-tests).steps[6](Upload coverage to Codecov)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run performance benchmarks", "run": "pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n", "__startline__": 59, "__endline__": 63}}, "code_block": [[59, "      - name: Run performance benchmarks\n"], [60, "        run: |\n"], [61, "          pytest tests/performance/ -v --tb=short || echo \"Performance tests completed with warnings\"\n"], [62, "\n"], [63, "      - name: Run load tests\n"], [64, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [59, 64], "resource": "jobs(extended-tests).steps[7](Run performance benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run load tests", "run": "pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n", "__startline__": 63, "__endline__": 67}}, "code_block": [[63, "      - name: Run load tests\n"], [64, "        run: |\n"], [65, "          pytest tests/performance/test_load.py -v --tb=short || echo \"Load tests completed with warnings\"\n"], [66, "\n"], [67, "      - name: Run security audit\n"], [68, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [63, 68], "resource": "jobs(extended-tests).steps[8](Run load tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security audit", "run": "echo \"\ud83d\udd12 Running security audit...\"\nbandit -r scripts/ -c bandit.yaml\n\necho \"\"\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n\n# Check for verified secrets\nVERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\nif [ \"$VERIFIED\" -gt 0 ]; then\n  echo \"\u274c Found $VERIFIED verified secrets!\"\n  exit 1\nelse\n  echo \"\u2705 No verified secrets found\"\nfi\n", "__startline__": 67, "__endline__": 85}}, "code_block": [[67, "      - name: Run security audit\n"], [68, "        run: |\n"], [69, "          echo \"\ud83d\udd12 Running security audit...\"\n"], [70, "          bandit -r scripts/ -c bandit.yaml\n"], [71, "\n"], [72, "          echo \"\"\n"], [73, "          echo \"\ud83d\udd0d Scanning for secrets...\"\n"], [74, "          trufflehog filesystem . --json --exclude-paths .trufflehog-exclude.txt > trufflehog-results.json || true\n"], [75, "\n"], [76, "          # Check for verified secrets\n"], [77, "          VERIFIED=$(jq -r 'select(.Verified == true)' trufflehog-results.json 2>/dev/null | wc -l || echo \"0\")\n"], [78, "          if [ \"$VERIFIED\" -gt 0 ]; then\n"], [79, "            echo \"\u274c Found $VERIFIED verified secrets!\"\n"], [80, "            exit 1\n"], [81, "          else\n"], [82, "            echo \"\u2705 No verified secrets found\"\n"], [83, "          fi\n"], [84, "\n"], [85, "      - name: Archive test results\n"], [86, "        if: always()\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [67, 86], "resource": "jobs(extended-tests).steps[9](Run security audit)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Archive test results", "if": "always()", "uses": "actions/upload-artifact@v5", "with": {"name": "nightly-test-results", "path": "htmlcov/\ncoverage.xml\ntrufflehog-results.json\n", "retention-days": 7, "__startline__": 89, "__endline__": 96}, "__startline__": 85, "__endline__": 96}}, "code_block": [[85, "      - name: Archive test results\n"], [86, "        if: always()\n"], [87, "        uses: actions/upload-artifact@v5\n"], [88, "        with:\n"], [89, "          name: nightly-test-results\n"], [90, "          path: |\n"], [91, "            htmlcov/\n"], [92, "            coverage.xml\n"], [93, "            trufflehog-results.json\n"], [94, "          retention-days: 7\n"], [95, "\n"], [96, "  cross-platform-tests:\n"], [97, "    name: Cross-Platform Tests (${{ matrix.os }} / Python ${{ matrix.python-version }})\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [85, 97], "resource": "jobs(extended-tests).steps[10](Archive test results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["extended-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 106, "__endline__": 109}}, "code_block": [[106, "      - name: Checkout repository\n"], [107, "        uses: actions/checkout@v5\n"], [108, "\n"], [109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [106, 110], "resource": "jobs(cross-platform-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v6", "with": {"python-version": "${{ matrix.python-version }}", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 112, "__endline__": 116}, "__startline__": 109, "__endline__": 116}}, "code_block": [[109, "      - name: Set up Python ${{ matrix.python-version }}\n"], [110, "        uses: actions/setup-python@v6\n"], [111, "        with:\n"], [112, "          python-version: ${{ matrix.python-version }}\n"], [113, "          cache: pip\n"], [114, "          cache-dependency-path: requirements-dev.txt\n"], [115, "\n"], [116, "      - name: Install dependencies\n"], [117, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [109, 117], "resource": "jobs(cross-platform-tests).steps[2](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 116, "__endline__": 122}}, "code_block": [[116, "      - name: Install dependencies\n"], [117, "        run: |\n"], [118, "          python -m pip install --upgrade pip\n"], [119, "          pip install -e .\n"], [120, "          pip install -r requirements-dev.txt\n"], [121, "\n"], [122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [116, 123], "resource": "jobs(cross-platform-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run unit tests (platform-agnostic)", "run": "pytest tests/unit/ \\\n  --cov=scripts \\\n  --cov-report=term-missing \\\n  -v \\\n  --maxfail=5\n", "__startline__": 122, "__endline__": 130}}, "code_block": [[122, "      - name: Run unit tests (platform-agnostic)\n"], [123, "        run: |\n"], [124, "          pytest tests/unit/ \\\n"], [125, "            --cov=scripts \\\n"], [126, "            --cov-report=term-missing \\\n"], [127, "            -v \\\n"], [128, "            --maxfail=5\n"], [129, "\n"], [130, "      - name: Run CLI tests\n"], [131, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [122, 131], "resource": "jobs(cross-platform-tests).steps[4](Run unit tests (platform-agnostic))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run CLI tests", "run": "pytest tests/cli/ -v --maxfail=5\n", "__startline__": 130, "__endline__": 134}}, "code_block": [[130, "      - name: Run CLI tests\n"], [131, "        run: |\n"], [132, "          pytest tests/cli/ -v --maxfail=5\n"], [133, "\n"], [134, "  security-regression-tests:\n"], [135, "    name: Security Regression Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [130, 135], "resource": "jobs(cross-platform-tests).steps[5](Run CLI tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["cross-platform-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 139, "__endline__": 142}}, "code_block": [[139, "      - name: Checkout repository\n"], [140, "        uses: actions/checkout@v5\n"], [141, "\n"], [142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [139, 143], "resource": "jobs(security-regression-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 145, "__endline__": 149}, "__startline__": 142, "__endline__": 149}}, "code_block": [[142, "      - name: Set up Python 3.11\n"], [143, "        uses: actions/setup-python@v6\n"], [144, "        with:\n"], [145, "          python-version: '3.11'\n"], [146, "          cache: pip\n"], [147, "          cache-dependency-path: requirements-dev.txt\n"], [148, "\n"], [149, "      - name: Install dependencies\n"], [150, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [142, 150], "resource": "jobs(security-regression-tests).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 149, "__endline__": 155}}, "code_block": [[149, "      - name: Install dependencies\n"], [150, "        run: |\n"], [151, "          python -m pip install --upgrade pip\n"], [152, "          pip install -e .\n"], [153, "          pip install -r requirements-dev.txt\n"], [154, "\n"], [155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [149, 156], "resource": "jobs(security-regression-tests).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run security regression test suite", "run": "pytest tests/e2e/test_security_hardening.py -v --tb=short\n", "__startline__": 155, "__endline__": 159}}, "code_block": [[155, "      - name: Run security regression test suite\n"], [156, "        run: |\n"], [157, "          pytest tests/e2e/test_security_hardening.py -v --tb=short\n"], [158, "\n"], [159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [155, 160], "resource": "jobs(security-regression-tests).steps[4](Run security regression test suite)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run SQL injection tests", "run": "pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n", "__startline__": 159, "__endline__": 163}}, "code_block": [[159, "      - name: Run SQL injection tests\n"], [160, "        run: |\n"], [161, "          pytest tests/e2e/test_security_hardening.py::TestSQLInjectionPrevention -v\n"], [162, "\n"], [163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [159, 164], "resource": "jobs(security-regression-tests).steps[5](Run SQL injection tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run path traversal tests", "run": "pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n", "__startline__": 163, "__endline__": 167}}, "code_block": [[163, "      - name: Run path traversal tests\n"], [164, "        run: |\n"], [165, "          pytest tests/e2e/test_security_hardening.py::TestPathTraversalPrevention -v\n"], [166, "\n"], [167, "  docker-smoke-tests:\n"], [168, "    name: Docker Smoke Tests\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [163, 168], "resource": "jobs(security-regression-tests).steps[6](Run path traversal tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["security-regression-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 172, "__endline__": 175}}, "code_block": [[172, "      - name: Checkout repository\n"], [173, "        uses: actions/checkout@v5\n"], [174, "\n"], [175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [172, 176], "resource": "jobs(docker-smoke-tests).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 175, "__endline__": 178}}, "code_block": [[175, "      - name: Set up Docker Buildx\n"], [176, "        uses: docker/setup-buildx-action@v3\n"], [177, "\n"], [178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [175, 179], "resource": "jobs(docker-smoke-tests).steps[2](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker image (balanced variant)", "run": "docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n", "__startline__": 178, "__endline__": 182}}, "code_block": [[178, "      - name: Build Docker image (balanced variant)\n"], [179, "        run: |\n"], [180, "          docker build -t jmo-security:nightly-test -f Dockerfile.balanced .\n"], [181, "\n"], [182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [178, 183], "resource": "jobs(docker-smoke-tests).steps[3](Build Docker image (balanced variant))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker image --help", "run": "docker run --rm jmo-security:nightly-test --help\n", "__startline__": 182, "__endline__": 186}}, "code_block": [[182, "      - name: Test Docker image --help\n"], [183, "        run: |\n"], [184, "          docker run --rm jmo-security:nightly-test --help\n"], [185, "\n"], [186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [182, 187], "resource": "jobs(docker-smoke-tests).steps[4](Test Docker image --help)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test Docker scan command", "run": "docker run --rm jmo-security:nightly-test scan --help\n", "__startline__": 186, "__endline__": 190}}, "code_block": [[186, "      - name: Test Docker scan command\n"], [187, "        run: |\n"], [188, "          docker run --rm jmo-security:nightly-test scan --help\n"], [189, "\n"], [190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [186, 191], "resource": "jobs(docker-smoke-tests).steps[5](Test Docker scan command)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan test repository with Docker", "run": "mkdir -p test-repo results\necho \"print('test')\" > test-repo/test.py\ndocker run --rm \\\n  -v $PWD/test-repo:/scan \\\n  -v $PWD/results:/results \\\n  jmo-security:nightly-test scan \\\n    --repo /scan \\\n    --results-dir /results \\\n    --allow-missing-tools\n", "__startline__": 190, "__endline__": 202}}, "code_block": [[190, "      - name: Scan test repository with Docker\n"], [191, "        run: |\n"], [192, "          mkdir -p test-repo results\n"], [193, "          echo \"print('test')\" > test-repo/test.py\n"], [194, "          docker run --rm \\\n"], [195, "            -v $PWD/test-repo:/scan \\\n"], [196, "            -v $PWD/results:/results \\\n"], [197, "            jmo-security:nightly-test scan \\\n"], [198, "              --repo /scan \\\n"], [199, "              --results-dir /results \\\n"], [200, "              --allow-missing-tools\n"], [201, "\n"], [202, "  notify-on-failure:\n"], [203, "    name: Notify on Failure\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [190, 203], "resource": "jobs(docker-smoke-tests).steps[6](Scan test repository with Docker)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["docker-smoke-tests"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create issue on failure", "uses": "actions/github-script@v7", "with": {"script": "const today = new Date().toISOString().split('T')[0];\nconst title = `Nightly test suite failed on ${today}`;\n\nconst body = `## Nightly Test Failure\n\nThe nightly test suite failed. Please investigate and fix.\n\n**Failed jobs:**\n${{ toJSON(needs) }}\n\n**Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n\n**Troubleshooting:**\n1. Check workflow logs for specific failures\n2. Run tests locally: \\`pytest tests/ -v\\`\n3. Check for flaky tests or environmental issues\n4. Review recent commits for potential breaking changes\n\n/cc @jimmy058910\n`;\n\n// Check if issue already exists\nconst issues = await github.rest.issues.listForRepo({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  state: 'open',\n  labels: 'nightly-test-failure'\n});\n\nconst existingIssue = issues.data.find(issue =>\n  issue.title === title\n);\n\nif (!existingIssue) {\n  // Create new issue\n  await github.rest.issues.create({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    title: title,\n    body: body,\n    labels: ['bug', 'ci', 'nightly-test-failure']\n  });\n} else {\n  // Add comment to existing issue\n  await github.rest.issues.createComment({\n    owner: context.repo.owner,\n    repo: context.repo.repo,\n    issue_number: existingIssue.number,\n    body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n  });\n}\n", "__startline__": 211, "__endline__": 263}, "__startline__": 208, "__endline__": 263}}, "code_block": [[208, "      - name: Create issue on failure\n"], [209, "        uses: actions/github-script@v7\n"], [210, "        with:\n"], [211, "          script: |\n"], [212, "            const today = new Date().toISOString().split('T')[0];\n"], [213, "            const title = `Nightly test suite failed on ${today}`;\n"], [214, "\n"], [215, "            const body = `## Nightly Test Failure\n"], [216, "\n"], [217, "            The nightly test suite failed. Please investigate and fix.\n"], [218, "\n"], [219, "            **Failed jobs:**\n"], [220, "            ${{ toJSON(needs) }}\n"], [221, "\n"], [222, "            **Workflow run:** ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n"], [223, "\n"], [224, "            **Troubleshooting:**\n"], [225, "            1. Check workflow logs for specific failures\n"], [226, "            2. Run tests locally: \\`pytest tests/ -v\\`\n"], [227, "            3. Check for flaky tests or environmental issues\n"], [228, "            4. Review recent commits for potential breaking changes\n"], [229, "\n"], [230, "            /cc @jimmy058910\n"], [231, "            `;\n"], [232, "\n"], [233, "            // Check if issue already exists\n"], [234, "            const issues = await github.rest.issues.listForRepo({\n"], [235, "              owner: context.repo.owner,\n"], [236, "              repo: context.repo.repo,\n"], [237, "              state: 'open',\n"], [238, "              labels: 'nightly-test-failure'\n"], [239, "            });\n"], [240, "\n"], [241, "            const existingIssue = issues.data.find(issue =>\n"], [242, "              issue.title === title\n"], [243, "            );\n"], [244, "\n"], [245, "            if (!existingIssue) {\n"], [246, "              // Create new issue\n"], [247, "              await github.rest.issues.create({\n"], [248, "                owner: context.repo.owner,\n"], [249, "                repo: context.repo.repo,\n"], [250, "                title: title,\n"], [251, "                body: body,\n"], [252, "                labels: ['bug', 'ci', 'nightly-test-failure']\n"], [253, "              });\n"], [254, "            } else {\n"], [255, "              // Add comment to existing issue\n"], [256, "              await github.rest.issues.createComment({\n"], [257, "                owner: context.repo.owner,\n"], [258, "                repo: context.repo.repo,\n"], [259, "                issue_number: existingIssue.number,\n"], [260, "                body: `Nightly tests failed again on ${today}.\\n\\nWorkflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}`\n"], [261, "              });\n"], [262, "            }\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [208, 264], "resource": "jobs(notify-on-failure).steps[1](Create issue on failure)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["notify-on-failure"], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}}, "code_block": [[24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [24, 111], "resource": "jobs(benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}}, "code_block": [[24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [24, 111], "resource": "jobs(benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}}, "code_block": [[24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [24, 111], "resource": "jobs(benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"benchmark": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}, "__startline__": 23, "__endline__": 110}}, "code_block": [[23, "  benchmark:\n"], [24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [23, 111], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}}, "code_block": [[24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [24, 111], "resource": "jobs(benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"benchmark": {"name": "Run Performance Benchmarks", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}, {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}, {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}, {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}, {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}, {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}, {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}, {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}, {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}], "__startline__": 24, "__endline__": 110}, "__startline__": 23, "__endline__": 110}}, "code_block": [[23, "  benchmark:\n"], [24, "    name: Run Performance Benchmarks\n"], [25, "    runs-on: ubuntu-latest\n"], [26, "    timeout-minutes: 15\n"], [27, "\n"], [28, "    steps:\n"], [29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [23, 111], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [29, 35], "resource": "jobs(benchmark).steps[1](Checkout code)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [34, 41], "resource": "jobs(benchmark).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}}, "code_block": [[40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [40, 47], "resource": "jobs(benchmark).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}}, "code_block": [[46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [46, 58], "resource": "jobs(benchmark).steps[4](Run baseline benchmarks (main branch))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}}, "code_block": [[57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [57, 62], "resource": "jobs(benchmark).steps[5](Checkout PR branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}}, "code_block": [[61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [61, 71], "resource": "jobs(benchmark).steps[6](Run current benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}}, "code_block": [[70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [70, 81], "resource": "jobs(benchmark).steps[7](Compare results and detect regressions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}}, "code_block": [[80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [80, 96], "resource": "jobs(benchmark).steps[8](Post benchmark results as PR comment)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}}, "code_block": [[95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [95, 106], "resource": "jobs(benchmark).steps[9](Upload benchmark artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}}, "code_block": [[105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [105, 111], "resource": "jobs(benchmark).steps[10](Fail on performance regression)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [29, 35], "resource": "jobs(benchmark).steps[1](Checkout code)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [34, 41], "resource": "jobs(benchmark).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}}, "code_block": [[40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [40, 47], "resource": "jobs(benchmark).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}}, "code_block": [[46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [46, 58], "resource": "jobs(benchmark).steps[4](Run baseline benchmarks (main branch))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}}, "code_block": [[57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [57, 62], "resource": "jobs(benchmark).steps[5](Checkout PR branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}}, "code_block": [[61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [61, 71], "resource": "jobs(benchmark).steps[6](Run current benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}}, "code_block": [[70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [70, 81], "resource": "jobs(benchmark).steps[7](Compare results and detect regressions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}}, "code_block": [[80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [80, 96], "resource": "jobs(benchmark).steps[8](Post benchmark results as PR comment)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}}, "code_block": [[95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [95, 106], "resource": "jobs(benchmark).steps[9](Upload benchmark artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}}, "code_block": [[105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [105, 111], "resource": "jobs(benchmark).steps[10](Fail on performance regression)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [29, 35], "resource": "jobs(benchmark).steps[1](Checkout code)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [34, 41], "resource": "jobs(benchmark).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}}, "code_block": [[40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [40, 47], "resource": "jobs(benchmark).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}}, "code_block": [[46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [46, 58], "resource": "jobs(benchmark).steps[4](Run baseline benchmarks (main branch))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}}, "code_block": [[57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [57, 62], "resource": "jobs(benchmark).steps[5](Checkout PR branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}}, "code_block": [[61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [61, 71], "resource": "jobs(benchmark).steps[6](Run current benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}}, "code_block": [[70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [70, 81], "resource": "jobs(benchmark).steps[7](Compare results and detect regressions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}}, "code_block": [[80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [80, 96], "resource": "jobs(benchmark).steps[8](Post benchmark results as PR comment)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}}, "code_block": [[95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [95, 106], "resource": "jobs(benchmark).steps[9](Upload benchmark artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}}, "code_block": [[105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [105, 111], "resource": "jobs(benchmark).steps[10](Fail on performance regression)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout code", "uses": "actions/checkout@v4", "with": {"fetch-depth": 0, "__startline__": 32, "__endline__": 34}, "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Checkout code\n"], [30, "        uses: actions/checkout@v4\n"], [31, "        with:\n"], [32, "          fetch-depth: 0  # Fetch all history for baseline comparison\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [29, 35], "resource": "jobs(benchmark).steps[1](Checkout code)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v5", "with": {"python-version": "3.11", "cache": "pip", "__startline__": 37, "__endline__": 40}, "__startline__": 34, "__endline__": 40}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v5\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "          cache: 'pip'\n"], [39, "\n"], [40, "      - name: Install dependencies\n"], [41, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [34, 41], "resource": "jobs(benchmark).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip setuptools wheel\npip install -r requirements-dev.txt\npip install psutil  # Required for memory benchmark\n", "__startline__": 40, "__endline__": 46}}, "code_block": [[40, "      - name: Install dependencies\n"], [41, "        run: |\n"], [42, "          pip install --upgrade pip setuptools wheel\n"], [43, "          pip install -r requirements-dev.txt\n"], [44, "          pip install psutil  # Required for memory benchmark\n"], [45, "\n"], [46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [40, 47], "resource": "jobs(benchmark).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run baseline benchmarks (main branch)", "id": "baseline", "run": "git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\npython3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  --benchmark-only \\\n  --benchmark-json=baseline-results.json \\\n  || true  # Don't fail if baseline doesn't have benchmarks yet\n", "continue-on-error": true, "__startline__": 46, "__endline__": 57}}, "code_block": [[46, "      - name: Run baseline benchmarks (main branch)\n"], [47, "        id: baseline\n"], [48, "        run: |\n"], [49, "          git checkout ${{ github.event.inputs.baseline_ref || 'main' }}\n"], [50, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [51, "            -v \\\n"], [52, "            --benchmark-only \\\n"], [53, "            --benchmark-json=baseline-results.json \\\n"], [54, "            || true  # Don't fail if baseline doesn't have benchmarks yet\n"], [55, "        continue-on-error: true\n"], [56, "\n"], [57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [46, 58], "resource": "jobs(benchmark).steps[4](Run baseline benchmarks (main branch))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout PR branch", "run": "git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n", "__startline__": 57, "__endline__": 61}}, "code_block": [[57, "      - name: Checkout PR branch\n"], [58, "        run: |\n"], [59, "          git checkout ${{ github.event.pull_request.head.sha || github.sha }}\n"], [60, "\n"], [61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [57, 62], "resource": "jobs(benchmark).steps[5](Checkout PR branch)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run current benchmarks", "id": "current", "run": "python3 -m pytest tests/performance/test_benchmarks.py \\\n  -v \\\n  -m benchmark \\\n  --tb=short \\\n  --benchmark-json=current-results.json\n", "__startline__": 61, "__endline__": 70}}, "code_block": [[61, "      - name: Run current benchmarks\n"], [62, "        id: current\n"], [63, "        run: |\n"], [64, "          python3 -m pytest tests/performance/test_benchmarks.py \\\n"], [65, "            -v \\\n"], [66, "            -m benchmark \\\n"], [67, "            --tb=short \\\n"], [68, "            --benchmark-json=current-results.json\n"], [69, "\n"], [70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [61, 71], "resource": "jobs(benchmark).steps[6](Run current benchmarks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Compare results and detect regressions", "id": "compare", "run": "python3 scripts/dev/compare_benchmarks.py \\\n  --baseline baseline-results.json \\\n  --current current-results.json \\\n  --threshold 20 \\\n  --output benchmark-comparison.md\n", "continue-on-error": true, "__startline__": 70, "__endline__": 80}}, "code_block": [[70, "      - name: Compare results and detect regressions\n"], [71, "        id: compare\n"], [72, "        run: |\n"], [73, "          python3 scripts/dev/compare_benchmarks.py \\\n"], [74, "            --baseline baseline-results.json \\\n"], [75, "            --current current-results.json \\\n"], [76, "            --threshold 20 \\\n"], [77, "            --output benchmark-comparison.md\n"], [78, "        continue-on-error: true\n"], [79, "\n"], [80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [70, 81], "resource": "jobs(benchmark).steps[7](Compare results and detect regressions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Post benchmark results as PR comment", "if": "github.event_name == 'pull_request'", "uses": "actions/github-script@v7", "with": {"script": "const fs = require('fs');\nconst comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n\ngithub.rest.issues.createComment({\n  issue_number: context.issue.number,\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  body: comparison\n});\n", "__startline__": 84, "__endline__": 95}, "__startline__": 80, "__endline__": 95}}, "code_block": [[80, "      - name: Post benchmark results as PR comment\n"], [81, "        if: github.event_name == 'pull_request'\n"], [82, "        uses: actions/github-script@v7\n"], [83, "        with:\n"], [84, "          script: |\n"], [85, "            const fs = require('fs');\n"], [86, "            const comparison = fs.readFileSync('benchmark-comparison.md', 'utf8');\n"], [87, "\n"], [88, "            github.rest.issues.createComment({\n"], [89, "              issue_number: context.issue.number,\n"], [90, "              owner: context.repo.owner,\n"], [91, "              repo: context.repo.repo,\n"], [92, "              body: comparison\n"], [93, "            });\n"], [94, "\n"], [95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [80, 96], "resource": "jobs(benchmark).steps[8](Post benchmark results as PR comment)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload benchmark artifacts", "uses": "actions/upload-artifact@v4", "with": {"name": "benchmark-results", "path": "baseline-results.json\ncurrent-results.json\nbenchmark-comparison.md\n", "retention-days": 30, "__startline__": 98, "__endline__": 105}, "__startline__": 95, "__endline__": 105}}, "code_block": [[95, "      - name: Upload benchmark artifacts\n"], [96, "        uses: actions/upload-artifact@v4\n"], [97, "        with:\n"], [98, "          name: benchmark-results\n"], [99, "          path: |\n"], [100, "            baseline-results.json\n"], [101, "            current-results.json\n"], [102, "            benchmark-comparison.md\n"], [103, "          retention-days: 30\n"], [104, "\n"], [105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [95, 106], "resource": "jobs(benchmark).steps[9](Upload benchmark artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Fail on performance regression", "if": "steps.compare.outputs.regression_detected == 'true'", "run": "echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\nexit 1\n", "__startline__": 105, "__endline__": 110}}, "code_block": [[105, "      - name: Fail on performance regression\n"], [106, "        if: steps.compare.outputs.regression_detected == 'true'\n"], [107, "        run: |\n"], [108, "          echo \"\u274c Performance regression detected! See benchmark-comparison.md for details.\"\n"], [109, "          exit 1\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [105, 111], "resource": "jobs(benchmark).steps[10](Fail on performance regression)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": ["benchmark"], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}}, "code_block": [[28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [28, 93], "resource": "jobs(pre-release-check)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}}, "code_block": [[93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [93, 154], "resource": "jobs(pypi-publish)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}}, "code_block": [[154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [154, 257], "resource": "jobs(docker-build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}}, "code_block": [[257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [257, 333], "resource": "jobs(docker-size-benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}}, "code_block": [[333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [333, 375], "resource": "jobs(docker-scan)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}}, "code_block": [[375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [375, 414], "resource": "jobs(docker-hub-readme)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}}, "code_block": [[414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [414, 477], "resource": "jobs(verify-badges)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}}, "code_block": [[477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [477, 525], "resource": "jobs(homebrew-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}}, "code_block": [[525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [525, 542], "resource": "jobs(winget-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}}, "code_block": [[28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [28, 93], "resource": "jobs(pre-release-check)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}}, "code_block": [[93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [93, 154], "resource": "jobs(pypi-publish)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}}, "code_block": [[154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [154, 257], "resource": "jobs(docker-build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}}, "code_block": [[257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [257, 333], "resource": "jobs(docker-size-benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}}, "code_block": [[333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [333, 375], "resource": "jobs(docker-scan)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}}, "code_block": [[375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [375, 414], "resource": "jobs(docker-hub-readme)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}}, "code_block": [[414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [414, 477], "resource": "jobs(verify-badges)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}}, "code_block": [[477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [477, 525], "resource": "jobs(homebrew-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}}, "code_block": [[525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [525, 542], "resource": "jobs(winget-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}}, "code_block": [[28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [28, 93], "resource": "jobs(pre-release-check)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}}, "code_block": [[93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [93, 154], "resource": "jobs(pypi-publish)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}}, "code_block": [[154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [154, 257], "resource": "jobs(docker-build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}}, "code_block": [[257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [257, 333], "resource": "jobs(docker-size-benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}}, "code_block": [[333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [333, 375], "resource": "jobs(docker-scan)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}}, "code_block": [[375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [375, 414], "resource": "jobs(docker-hub-readme)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}}, "code_block": [[414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [414, 477], "resource": "jobs(verify-badges)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}}, "code_block": [[477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [477, 525], "resource": "jobs(homebrew-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}}, "code_block": [[525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [525, 542], "resource": "jobs(winget-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"pre-release-check": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}, "pypi-publish": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}, "docker-build": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}, "docker-size-benchmark": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}, "docker-scan": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}, "docker-hub-readme": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}, "verify-badges": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}, "homebrew-bump": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}, "winget-bump": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}, "__startline__": 27, "__endline__": 541}}, "code_block": [[27, "  pre-release-check:\n"], [28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [27, 542], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}}, "code_block": [[28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [28, 93], "resource": "jobs(pre-release-check)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}}, "code_block": [[93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [93, 154], "resource": "jobs(pypi-publish)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}}, "code_block": [[154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [154, 257], "resource": "jobs(docker-build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}}, "code_block": [[257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [257, 333], "resource": "jobs(docker-size-benchmark)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}}, "code_block": [[333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [333, 375], "resource": "jobs(docker-scan)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}}, "code_block": [[375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [375, 414], "resource": "jobs(docker-hub-readme)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}}, "code_block": [[414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [414, 477], "resource": "jobs(verify-badges)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}}, "code_block": [[477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [477, 525], "resource": "jobs(homebrew-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}}, "code_block": [[525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [525, 542], "resource": "jobs(winget-bump)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"pre-release-check": {"name": "Pre-Release Validation", "runs-on": "ubuntu-latest", "if": "startsWith(github.ref, 'refs/tags/v')", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}, {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}, {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}, {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}, {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}], "__startline__": 28, "__endline__": 92}, "pypi-publish": {"name": "Build and publish to PyPI", "runs-on": "ubuntu-latest", "needs": "pre-release-check", "if": "startsWith(github.ref, 'refs/tags/v')", "concurrency": {"group": "release-pypi-${{ github.ref }}", "cancel-in-progress": false, "__startline__": 98, "__endline__": 100}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}, {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}, {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}, {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}, {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}, {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}, {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}, {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}], "__startline__": 93, "__endline__": 153}, "docker-build": {"name": "Build Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "strategy": {"fail-fast": false, "matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 160, "__endline__": 161}, "__startline__": 158, "__endline__": 161}, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}, {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}, {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}, {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}, {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}, {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}, {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}, {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}, {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}, {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}, {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}], "__startline__": 154, "__endline__": 256}, "docker-size-benchmark": {"name": "Benchmark Docker Image Sizes", "runs-on": "ubuntu-latest", "needs": "docker-build", "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}, {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}, {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}, {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}], "__startline__": 257, "__endline__": 332}, "docker-scan": {"name": "Scan Docker ${{ matrix.variant }}", "runs-on": "ubuntu-latest", "needs": "docker-build", "strategy": {"matrix": {"variant": ["full", "balanced", "slim", "fast"], "__startline__": 338, "__endline__": 339}, "__startline__": 337, "__endline__": 339}, "steps": [{"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}, {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}, {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}, {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}], "__startline__": 333, "__endline__": 374}, "docker-hub-readme": {"name": "Update Docker Hub README", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "always() &&\n(needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n(startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n", "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}, {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}, {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}], "__startline__": 375, "__endline__": 413}, "verify-badges": {"name": "Verify PyPI Badges", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "continue-on-error": true, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}, {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}], "__startline__": 414, "__endline__": 476}, "homebrew-bump": {"name": "Submit Homebrew Formula PR", "runs-on": "ubuntu-latest", "needs": "pypi-publish", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}, {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}, {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}], "__startline__": 477, "__endline__": 524}, "winget-bump": {"name": "Submit WinGet Manifest PR", "runs-on": "ubuntu-latest", "needs": "docker-build", "if": "startsWith(github.ref, 'refs/tags/v')", "steps": [{"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}], "__startline__": 525, "__endline__": 541}, "__startline__": 27, "__endline__": 541}}, "code_block": [[27, "  pre-release-check:\n"], [28, "    name: Pre-Release Validation\n"], [29, "    runs-on: ubuntu-latest\n"], [30, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [31, "    timeout-minutes: 10  # Increased from 5 to accommodate full test suite\n"], [32, "    steps:\n"], [33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"], [94, "    runs-on: ubuntu-latest\n"], [95, "    needs: pre-release-check  # BLOCKS release if tools are outdated\n"], [96, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [97, "    concurrency:\n"], [98, "      group: release-pypi-${{ github.ref }}\n"], [99, "      cancel-in-progress: false\n"], [100, "    steps:\n"], [101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"], [155, "    runs-on: ubuntu-latest\n"], [156, "    needs: pypi-publish\n"], [157, "    strategy:\n"], [158, "      fail-fast: false\n"], [159, "      matrix:\n"], [160, "        variant: [full, balanced, slim, fast]\n"], [161, "    steps:\n"], [162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"], [258, "    runs-on: ubuntu-latest\n"], [259, "    needs: docker-build\n"], [260, "    steps:\n"], [261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"], [334, "    runs-on: ubuntu-latest\n"], [335, "    needs: docker-build\n"], [336, "    strategy:\n"], [337, "      matrix:\n"], [338, "        variant: [full, balanced, slim, fast]\n"], [339, "    steps:\n"], [340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"], [376, "    runs-on: ubuntu-latest\n"], [377, "    # Run on version tags (after docker-build) OR on manual workflow_dispatch\n"], [378, "    needs: docker-build\n"], [379, "    if: |\n"], [380, "      always() &&\n"], [381, "      (needs.docker-build.result == 'success' || needs.docker-build.result == 'skipped') &&\n"], [382, "      (startsWith(github.ref, 'refs/tags/v') || github.event_name == 'workflow_dispatch')\n"], [383, "    steps:\n"], [384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"], [415, "    runs-on: ubuntu-latest\n"], [416, "    needs: pypi-publish\n"], [417, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [418, "    continue-on-error: true  # Don't block release on badge caching issues\n"], [419, "    steps:\n"], [420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"], [478, "    runs-on: ubuntu-latest\n"], [479, "    needs: pypi-publish\n"], [480, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [481, "    steps:\n"], [482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"], [526, "    runs-on: ubuntu-latest\n"], [527, "    needs: docker-build  # Wait for Windows installer to be built\n"], [528, "    if: startsWith(github.ref, 'refs/tags/v')\n"], [529, "    steps:\n"], [530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [27, 542], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"push": {"tags": ["v*"], "__startline__": 6, "__endline__": 8}, "workflow_dispatch": null, "__startline__": 5, "__endline__": 10}}, "code_block": [[5, "  push:\n"], [6, "    tags:\n"], [7, "      - 'v*'\n"], [8, "  workflow_dispatch:\n"], [9, "\n"], [10, "env:\n"], [11, "  REGISTRY_GHCR: ghcr.io\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [5, 11], "resource": "on(Release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": [""], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [33, 37], "resource": "jobs(pre-release-check).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}}, "code_block": [[36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [36, 44], "resource": "jobs(pre-release-check).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [43, 50], "resource": "jobs(pre-release-check).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}}, "code_block": [[49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [49, 58], "resource": "jobs(pre-release-check).steps[4](Install security tools (for pre-release checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}}, "code_block": [[57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [57, 67], "resource": "jobs(pre-release-check).steps[5](Install GitHub CLI (for CI status checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}}, "code_block": [[66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [66, 81], "resource": "jobs(pre-release-check).steps[6](Run comprehensive pre-release checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}}, "code_block": [[80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [80, 93], "resource": "jobs(pre-release-check).steps[7](Generate release notes preview)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}}, "code_block": [[101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [101, 105], "resource": "jobs(pypi-publish).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}}, "code_block": [[104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [104, 112], "resource": "jobs(pypi-publish).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}}, "code_block": [[111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [111, 117], "resource": "jobs(pypi-publish).steps[3](Install build backend)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}}, "code_block": [[116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [116, 126], "resource": "jobs(pypi-publish).steps[4](Verify tag matches version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}}, "code_block": [[125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [125, 135], "resource": "jobs(pypi-publish).steps[5](Validate README will render correctly on PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [134, 138], "resource": "jobs(pypi-publish).steps[6](Build sdist/wheel)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}}, "code_block": [[137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [137, 141], "resource": "jobs(pypi-publish).steps[7](Check package metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}}, "code_block": [[140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [140, 147], "resource": "jobs(pypi-publish).steps[8](Upload build artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}}, "code_block": [[146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [146, 154], "resource": "jobs(pypi-publish).steps[9](Publish to PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}}, "code_block": [[162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [162, 166], "resource": "jobs(docker-build).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}}, "code_block": [[165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [165, 169], "resource": "jobs(docker-build).steps[2](Set up QEMU)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}}, "code_block": [[168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [168, 172], "resource": "jobs(docker-build).steps[3](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}}, "code_block": [[171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [171, 179], "resource": "jobs(docker-build).steps[4](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}}, "code_block": [[178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [178, 187], "resource": "jobs(docker-build).steps[5](Log in to Docker Hub)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}}, "code_block": [[186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [186, 193], "resource": "jobs(docker-build).steps[6](Configure AWS credentials for ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}}, "code_block": [[192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [192, 198], "resource": "jobs(docker-build).steps[7](Log in to Amazon ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}}, "code_block": [[197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [197, 215], "resource": "jobs(docker-build).steps[8](Extract metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}}, "code_block": [[214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [214, 224], "resource": "jobs(docker-build).steps[9](Determine Dockerfile)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}}, "code_block": [[223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [223, 239], "resource": "jobs(docker-build).steps[10](Build and push)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}}, "code_block": [[238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [238, 257], "resource": "jobs(docker-build).steps[11](Test image (amd64 only))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}}, "code_block": [[261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [261, 269], "resource": "jobs(docker-size-benchmark).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}}, "code_block": [[268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [268, 280], "resource": "jobs(docker-size-benchmark).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}}, "code_block": [[279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [279, 326], "resource": "jobs(docker-size-benchmark).steps[3](Pull and measure all variants)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}}, "code_block": [[325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [325, 333], "resource": "jobs(docker-size-benchmark).steps[4](Upload size comparison)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}}, "code_block": [[340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [340, 348], "resource": "jobs(docker-scan).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}}, "code_block": [[347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [347, 360], "resource": "jobs(docker-scan).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}}, "code_block": [[359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [359, 368], "resource": "jobs(docker-scan).steps[3](Run Trivy vulnerability scanner)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}}, "code_block": [[367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [367, 375], "resource": "jobs(docker-scan).steps[4](Upload Trivy results to GitHub Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}}, "code_block": [[384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [384, 388], "resource": "jobs(docker-hub-readme).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}}, "code_block": [[387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [387, 401], "resource": "jobs(docker-hub-readme).steps[2](Update Docker Hub description)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}}, "code_block": [[400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [400, 414], "resource": "jobs(docker-hub-readme).steps[3](Docker Hub update skipped)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}}, "code_block": [[420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [420, 424], "resource": "jobs(verify-badges).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}}, "code_block": [[423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [423, 477], "resource": "jobs(verify-badges).steps[2](Wait for PyPI to propagate with retries)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}}, "code_block": [[482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [482, 490], "resource": "jobs(homebrew-bump).steps[1](Extract version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}}, "code_block": [[489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [489, 509], "resource": "jobs(homebrew-bump).steps[2](Wait for PyPI release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}}, "code_block": [[508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [508, 525], "resource": "jobs(homebrew-bump).steps[3](Trigger homebrew-bump-formula workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}}, "code_block": [[530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [530, 542], "resource": "jobs(winget-bump).steps[1](Trigger winget-releaser workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [33, 37], "resource": "jobs(pre-release-check).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}}, "code_block": [[36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [36, 44], "resource": "jobs(pre-release-check).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [43, 50], "resource": "jobs(pre-release-check).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}}, "code_block": [[49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [49, 58], "resource": "jobs(pre-release-check).steps[4](Install security tools (for pre-release checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}}, "code_block": [[57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [57, 67], "resource": "jobs(pre-release-check).steps[5](Install GitHub CLI (for CI status checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}}, "code_block": [[66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [66, 81], "resource": "jobs(pre-release-check).steps[6](Run comprehensive pre-release checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}}, "code_block": [[80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [80, 93], "resource": "jobs(pre-release-check).steps[7](Generate release notes preview)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}}, "code_block": [[101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [101, 105], "resource": "jobs(pypi-publish).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}}, "code_block": [[104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [104, 112], "resource": "jobs(pypi-publish).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}}, "code_block": [[111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [111, 117], "resource": "jobs(pypi-publish).steps[3](Install build backend)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}}, "code_block": [[116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [116, 126], "resource": "jobs(pypi-publish).steps[4](Verify tag matches version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}}, "code_block": [[125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [125, 135], "resource": "jobs(pypi-publish).steps[5](Validate README will render correctly on PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [134, 138], "resource": "jobs(pypi-publish).steps[6](Build sdist/wheel)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}}, "code_block": [[137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [137, 141], "resource": "jobs(pypi-publish).steps[7](Check package metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}}, "code_block": [[140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [140, 147], "resource": "jobs(pypi-publish).steps[8](Upload build artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}}, "code_block": [[146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [146, 154], "resource": "jobs(pypi-publish).steps[9](Publish to PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}}, "code_block": [[162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [162, 166], "resource": "jobs(docker-build).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}}, "code_block": [[165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [165, 169], "resource": "jobs(docker-build).steps[2](Set up QEMU)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}}, "code_block": [[168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [168, 172], "resource": "jobs(docker-build).steps[3](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}}, "code_block": [[171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [171, 179], "resource": "jobs(docker-build).steps[4](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}}, "code_block": [[178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [178, 187], "resource": "jobs(docker-build).steps[5](Log in to Docker Hub)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}}, "code_block": [[186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [186, 193], "resource": "jobs(docker-build).steps[6](Configure AWS credentials for ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}}, "code_block": [[192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [192, 198], "resource": "jobs(docker-build).steps[7](Log in to Amazon ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}}, "code_block": [[197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [197, 215], "resource": "jobs(docker-build).steps[8](Extract metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}}, "code_block": [[214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [214, 224], "resource": "jobs(docker-build).steps[9](Determine Dockerfile)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}}, "code_block": [[223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [223, 239], "resource": "jobs(docker-build).steps[10](Build and push)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}}, "code_block": [[238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [238, 257], "resource": "jobs(docker-build).steps[11](Test image (amd64 only))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}}, "code_block": [[261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [261, 269], "resource": "jobs(docker-size-benchmark).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}}, "code_block": [[268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [268, 280], "resource": "jobs(docker-size-benchmark).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}}, "code_block": [[279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [279, 326], "resource": "jobs(docker-size-benchmark).steps[3](Pull and measure all variants)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}}, "code_block": [[325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [325, 333], "resource": "jobs(docker-size-benchmark).steps[4](Upload size comparison)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}}, "code_block": [[340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [340, 348], "resource": "jobs(docker-scan).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}}, "code_block": [[347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [347, 360], "resource": "jobs(docker-scan).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}}, "code_block": [[359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [359, 368], "resource": "jobs(docker-scan).steps[3](Run Trivy vulnerability scanner)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}}, "code_block": [[367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [367, 375], "resource": "jobs(docker-scan).steps[4](Upload Trivy results to GitHub Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}}, "code_block": [[384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [384, 388], "resource": "jobs(docker-hub-readme).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}}, "code_block": [[387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [387, 401], "resource": "jobs(docker-hub-readme).steps[2](Update Docker Hub description)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}}, "code_block": [[400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [400, 414], "resource": "jobs(docker-hub-readme).steps[3](Docker Hub update skipped)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}}, "code_block": [[420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [420, 424], "resource": "jobs(verify-badges).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}}, "code_block": [[423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [423, 477], "resource": "jobs(verify-badges).steps[2](Wait for PyPI to propagate with retries)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}}, "code_block": [[482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [482, 490], "resource": "jobs(homebrew-bump).steps[1](Extract version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}}, "code_block": [[489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [489, 509], "resource": "jobs(homebrew-bump).steps[2](Wait for PyPI release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}}, "code_block": [[508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [508, 525], "resource": "jobs(homebrew-bump).steps[3](Trigger homebrew-bump-formula workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}}, "code_block": [[530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [530, 542], "resource": "jobs(winget-bump).steps[1](Trigger winget-releaser workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [33, 37], "resource": "jobs(pre-release-check).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}}, "code_block": [[36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [36, 44], "resource": "jobs(pre-release-check).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [43, 50], "resource": "jobs(pre-release-check).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}}, "code_block": [[49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [49, 58], "resource": "jobs(pre-release-check).steps[4](Install security tools (for pre-release checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}}, "code_block": [[57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [57, 67], "resource": "jobs(pre-release-check).steps[5](Install GitHub CLI (for CI status checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}}, "code_block": [[66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [66, 81], "resource": "jobs(pre-release-check).steps[6](Run comprehensive pre-release checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}}, "code_block": [[80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [80, 93], "resource": "jobs(pre-release-check).steps[7](Generate release notes preview)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}}, "code_block": [[101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [101, 105], "resource": "jobs(pypi-publish).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}}, "code_block": [[104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [104, 112], "resource": "jobs(pypi-publish).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}}, "code_block": [[111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [111, 117], "resource": "jobs(pypi-publish).steps[3](Install build backend)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}}, "code_block": [[116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [116, 126], "resource": "jobs(pypi-publish).steps[4](Verify tag matches version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}}, "code_block": [[125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [125, 135], "resource": "jobs(pypi-publish).steps[5](Validate README will render correctly on PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [134, 138], "resource": "jobs(pypi-publish).steps[6](Build sdist/wheel)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}}, "code_block": [[137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [137, 141], "resource": "jobs(pypi-publish).steps[7](Check package metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}}, "code_block": [[140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [140, 147], "resource": "jobs(pypi-publish).steps[8](Upload build artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}}, "code_block": [[146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [146, 154], "resource": "jobs(pypi-publish).steps[9](Publish to PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}}, "code_block": [[162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [162, 166], "resource": "jobs(docker-build).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}}, "code_block": [[165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [165, 169], "resource": "jobs(docker-build).steps[2](Set up QEMU)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}}, "code_block": [[168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [168, 172], "resource": "jobs(docker-build).steps[3](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}}, "code_block": [[171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [171, 179], "resource": "jobs(docker-build).steps[4](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}}, "code_block": [[178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [178, 187], "resource": "jobs(docker-build).steps[5](Log in to Docker Hub)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}}, "code_block": [[186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [186, 193], "resource": "jobs(docker-build).steps[6](Configure AWS credentials for ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}}, "code_block": [[192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [192, 198], "resource": "jobs(docker-build).steps[7](Log in to Amazon ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}}, "code_block": [[197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [197, 215], "resource": "jobs(docker-build).steps[8](Extract metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}}, "code_block": [[214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [214, 224], "resource": "jobs(docker-build).steps[9](Determine Dockerfile)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}}, "code_block": [[223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [223, 239], "resource": "jobs(docker-build).steps[10](Build and push)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}}, "code_block": [[238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [238, 257], "resource": "jobs(docker-build).steps[11](Test image (amd64 only))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}}, "code_block": [[261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [261, 269], "resource": "jobs(docker-size-benchmark).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}}, "code_block": [[268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [268, 280], "resource": "jobs(docker-size-benchmark).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}}, "code_block": [[279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [279, 326], "resource": "jobs(docker-size-benchmark).steps[3](Pull and measure all variants)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}}, "code_block": [[325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [325, 333], "resource": "jobs(docker-size-benchmark).steps[4](Upload size comparison)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}}, "code_block": [[340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [340, 348], "resource": "jobs(docker-scan).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}}, "code_block": [[347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [347, 360], "resource": "jobs(docker-scan).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}}, "code_block": [[359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [359, 368], "resource": "jobs(docker-scan).steps[3](Run Trivy vulnerability scanner)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}}, "code_block": [[367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [367, 375], "resource": "jobs(docker-scan).steps[4](Upload Trivy results to GitHub Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}}, "code_block": [[384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [384, 388], "resource": "jobs(docker-hub-readme).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}}, "code_block": [[387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [387, 401], "resource": "jobs(docker-hub-readme).steps[2](Update Docker Hub description)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}}, "code_block": [[400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [400, 414], "resource": "jobs(docker-hub-readme).steps[3](Docker Hub update skipped)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}}, "code_block": [[420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [420, 424], "resource": "jobs(verify-badges).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}}, "code_block": [[423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [423, 477], "resource": "jobs(verify-badges).steps[2](Wait for PyPI to propagate with retries)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}}, "code_block": [[482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [482, 490], "resource": "jobs(homebrew-bump).steps[1](Extract version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}}, "code_block": [[489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [489, 509], "resource": "jobs(homebrew-bump).steps[2](Wait for PyPI release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}}, "code_block": [[508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [508, 525], "resource": "jobs(homebrew-bump).steps[3](Trigger homebrew-bump-formula workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}}, "code_block": [[530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [530, 542], "resource": "jobs(winget-bump).steps[1](Trigger winget-releaser workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 33, "__endline__": 36}}, "code_block": [[33, "      - name: Checkout repository\n"], [34, "        uses: actions/checkout@v5\n"], [35, "\n"], [36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [33, 37], "resource": "jobs(pre-release-check).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 39, "__endline__": 43}, "__startline__": 36, "__endline__": 43}}, "code_block": [[36, "      - name: Set up Python 3.11\n"], [37, "        uses: actions/setup-python@v6\n"], [38, "        with:\n"], [39, "          python-version: '3.11'\n"], [40, "          cache: pip\n"], [41, "          cache-dependency-path: requirements-dev.txt\n"], [42, "\n"], [43, "      - name: Install dependencies\n"], [44, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [36, 44], "resource": "jobs(pre-release-check).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install -e .\npip install -r requirements-dev.txt\n", "__startline__": 43, "__endline__": 49}}, "code_block": [[43, "      - name: Install dependencies\n"], [44, "        run: |\n"], [45, "          python -m pip install --upgrade pip\n"], [46, "          pip install -e .\n"], [47, "          pip install -r requirements-dev.txt\n"], [48, "\n"], [49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [43, 50], "resource": "jobs(pre-release-check).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install security tools (for pre-release checks)", "run": "# Install TruffleHog for secrets scanning\ncurl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n\n# Install Bandit for security audit\npip install bandit\n", "__startline__": 49, "__endline__": 57}}, "code_block": [[49, "      - name: Install security tools (for pre-release checks)\n"], [50, "        run: |\n"], [51, "          # Install TruffleHog for secrets scanning\n"], [52, "          curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh -s -- -b /usr/local/bin\n"], [53, "\n"], [54, "          # Install Bandit for security audit\n"], [55, "          pip install bandit\n"], [56, "\n"], [57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [49, 58], "resource": "jobs(pre-release-check).steps[4](Install security tools (for pre-release checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install GitHub CLI (for CI status checks)", "run": "type -p curl >/dev/null || sudo apt install curl -y\ncurl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\nsudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\nsudo apt update\nsudo apt install gh -y\n", "__startline__": 57, "__endline__": 66}}, "code_block": [[57, "      - name: Install GitHub CLI (for CI status checks)\n"], [58, "        run: |\n"], [59, "          type -p curl >/dev/null || sudo apt install curl -y\n"], [60, "          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [61, "          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg\n"], [62, "          echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main\" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null\n"], [63, "          sudo apt update\n"], [64, "          sudo apt install gh -y\n"], [65, "\n"], [66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [57, 67], "resource": "jobs(pre-release-check).steps[5](Install GitHub CLI (for CI status checks))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run comprehensive pre-release checks", "env": {"GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 68, "__endline__": 69}, "run": "echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\necho \"\"\npython3 scripts/dev/pre_release_check.py || {\n  echo \"\"\n  echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n  echo \"   Fix issues above before releasing.\"\n  echo \"\"\n  exit 1\n}\n", "__startline__": 66, "__endline__": 80}}, "code_block": [[66, "      - name: Run comprehensive pre-release checks\n"], [67, "        env:\n"], [68, "          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [69, "        run: |\n"], [70, "          echo \"\ud83d\ude80 Running comprehensive pre-release validation...\"\n"], [71, "          echo \"\"\n"], [72, "          python3 scripts/dev/pre_release_check.py || {\n"], [73, "            echo \"\"\n"], [74, "            echo \"\u274c PRE-RELEASE CHECKS FAILED!\"\n"], [75, "            echo \"   Fix issues above before releasing.\"\n"], [76, "            echo \"\"\n"], [77, "            exit 1\n"], [78, "          }\n"], [79, "\n"], [80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [66, 81], "resource": "jobs(pre-release-check).steps[6](Run comprehensive pre-release checks)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate release notes preview", "run": "echo \"\"\necho \"\ud83d\udcdd Release notes preview:\"\necho \"\"\npython3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n  echo \"\"\n  echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n  echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n}\n", "__startline__": 80, "__endline__": 92}}, "code_block": [[80, "      - name: Generate release notes preview\n"], [81, "        run: |\n"], [82, "          echo \"\"\n"], [83, "          echo \"\ud83d\udcdd Release notes preview:\"\n"], [84, "          echo \"\"\n"], [85, "          python3 scripts/dev/generate_release_notes.py ${GITHUB_REF##*/} || {\n"], [86, "            echo \"\"\n"], [87, "            echo \"\u26a0\ufe0f  WARNING: Failed to generate release notes\"\n"], [88, "            echo \"   Verify CHANGELOG.md has entry for ${GITHUB_REF##*/}\"\n"], [89, "          }\n"], [90, "\n"], [91, "  # Build and publish Python package to PyPI\n"], [92, "  pypi-publish:\n"], [93, "    name: Build and publish to PyPI\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [80, 93], "resource": "jobs(pre-release-check).steps[7](Generate release notes preview)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pre-release-check"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 101, "__endline__": 104}}, "code_block": [[101, "      - name: Checkout repository\n"], [102, "        uses: actions/checkout@v5\n"], [103, "\n"], [104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [101, 105], "resource": "jobs(pypi-publish).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "cache": "pip", "cache-dependency-path": "requirements-dev.txt", "__startline__": 107, "__endline__": 111}, "__startline__": 104, "__endline__": 111}}, "code_block": [[104, "      - name: Set up Python 3.11\n"], [105, "        uses: actions/setup-python@v6\n"], [106, "        with:\n"], [107, "          python-version: '3.11'\n"], [108, "          cache: pip\n"], [109, "          cache-dependency-path: requirements-dev.txt\n"], [110, "\n"], [111, "      - name: Install build backend\n"], [112, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [104, 112], "resource": "jobs(pypi-publish).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install build backend", "run": "python -m pip install --upgrade pip\npip install build twine\n", "__startline__": 111, "__endline__": 116}}, "code_block": [[111, "      - name: Install build backend\n"], [112, "        run: |\n"], [113, "          python -m pip install --upgrade pip\n"], [114, "          pip install build twine\n"], [115, "\n"], [116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [111, 117], "resource": "jobs(pypi-publish).steps[3](Install build backend)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify tag matches version", "run": "VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\nTAG=${GITHUB_REF##*/}\nif [ \"v$VERSION\" != \"$TAG\" ]; then\n  echo \"Tag $TAG does not match project version v$VERSION\" >&2\n  exit 1\nfi\n", "__startline__": 116, "__endline__": 125}}, "code_block": [[116, "      - name: Verify tag matches version\n"], [117, "        run: |\n"], [118, "          VERSION=$(python -c 'import tomllib,sys;print(tomllib.load(open(\"pyproject.toml\",\"rb\"))[\"project\"][\"version\"])')\n"], [119, "          TAG=${GITHUB_REF##*/}\n"], [120, "          if [ \"v$VERSION\" != \"$TAG\" ]; then\n"], [121, "            echo \"Tag $TAG does not match project version v$VERSION\" >&2\n"], [122, "            exit 1\n"], [123, "          fi\n"], [124, "\n"], [125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [116, 126], "resource": "jobs(pypi-publish).steps[4](Verify tag matches version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate README will render correctly on PyPI", "run": "echo \"\u2705 README.md will be published to PyPI from this release\"\necho \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\necho \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\necho \"\"\necho \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\necho \"    run 'make validate-readme' locally to check for drift.\"\n", "__startline__": 125, "__endline__": 134}}, "code_block": [[125, "      - name: Validate README will render correctly on PyPI\n"], [126, "        run: |\n"], [127, "          echo \"\u2705 README.md will be published to PyPI from this release\"\n"], [128, "          echo \"\ud83d\udcdd Current README.md size: $(wc -c < README.md) bytes\"\n"], [129, "          echo \"\ud83d\udcca Badge count: $(grep -c '!\\[' README.md || echo 0)\"\n"], [130, "          echo \"\"\n"], [131, "          echo \"\u26a0\ufe0f  Note: If you see badge/content differences on PyPI after release,\"\n"], [132, "          echo \"    run 'make validate-readme' locally to check for drift.\"\n"], [133, "\n"], [134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [125, 135], "resource": "jobs(pypi-publish).steps[5](Validate README will render correctly on PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build sdist/wheel", "run": "python -m build", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Build sdist/wheel\n"], [135, "        run: python -m build\n"], [136, "\n"], [137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [134, 138], "resource": "jobs(pypi-publish).steps[6](Build sdist/wheel)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check package metadata", "run": "python -m twine check dist/*", "__startline__": 137, "__endline__": 140}}, "code_block": [[137, "      - name: Check package metadata\n"], [138, "        run: python -m twine check dist/*\n"], [139, "\n"], [140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [137, 141], "resource": "jobs(pypi-publish).steps[7](Check package metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload build artifacts", "uses": "actions/upload-artifact@v5", "with": {"name": "dist-${{ github.ref_name }}", "path": "dist/*", "__startline__": 143, "__endline__": 146}, "__startline__": 140, "__endline__": 146}}, "code_block": [[140, "      - name: Upload build artifacts\n"], [141, "        uses: actions/upload-artifact@v5\n"], [142, "        with:\n"], [143, "          name: dist-${{ github.ref_name }}\n"], [144, "          path: dist/*\n"], [145, "\n"], [146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [140, 147], "resource": "jobs(pypi-publish).steps[8](Upload build artifacts)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Publish to PyPI", "if": "startsWith(github.ref, 'refs/tags/v')", "uses": "pypa/gh-action-pypi-publish@v1.13.0", "with": {"skip-existing": true, "__startline__": 150, "__endline__": 153}, "__startline__": 146, "__endline__": 153}}, "code_block": [[146, "      - name: Publish to PyPI\n"], [147, "        if: startsWith(github.ref, 'refs/tags/v')\n"], [148, "        uses: pypa/gh-action-pypi-publish@v1.13.0\n"], [149, "        with:\n"], [150, "          skip-existing: true  # Allow re-running releases if PyPI already has the version\n"], [151, "\n"], [152, "  # Build and push multi-arch Docker images (v1.0.0: 4 variants)\n"], [153, "  docker-build:\n"], [154, "    name: Build Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [146, 154], "resource": "jobs(pypi-publish).steps[9](Publish to PyPI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["pypi-publish"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 162, "__endline__": 165}}, "code_block": [[162, "      - name: Checkout repository\n"], [163, "        uses: actions/checkout@v5\n"], [164, "\n"], [165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [162, 166], "resource": "jobs(docker-build).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up QEMU", "uses": "docker/setup-qemu-action@v3", "__startline__": 165, "__endline__": 168}}, "code_block": [[165, "      - name: Set up QEMU\n"], [166, "        uses: docker/setup-qemu-action@v3\n"], [167, "\n"], [168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [165, 169], "resource": "jobs(docker-build).steps[2](Set up QEMU)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Docker Buildx", "uses": "docker/setup-buildx-action@v3", "__startline__": 168, "__endline__": 171}}, "code_block": [[168, "      - name: Set up Docker Buildx\n"], [169, "        uses: docker/setup-buildx-action@v3\n"], [170, "\n"], [171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [168, 172], "resource": "jobs(docker-build).steps[3](Set up Docker Buildx)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 174, "__endline__": 178}, "__startline__": 171, "__endline__": 178}}, "code_block": [[171, "      - name: Log in to GitHub Container Registry\n"], [172, "        uses: docker/login-action@v3\n"], [173, "        with:\n"], [174, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [175, "          username: ${{ github.actor }}\n"], [176, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [177, "\n"], [178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [171, 179], "resource": "jobs(docker-build).steps[4](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Docker Hub", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_DOCKERHUB }}", "username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "__startline__": 182, "__endline__": 186}, "__startline__": 178, "__endline__": 186}}, "code_block": [[178, "      - name: Log in to Docker Hub\n"], [179, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [180, "        uses: docker/login-action@v3\n"], [181, "        with:\n"], [182, "          registry: ${{ env.REGISTRY_DOCKERHUB }}\n"], [183, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [184, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [185, "\n"], [186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [178, 187], "resource": "jobs(docker-build).steps[5](Log in to Docker Hub)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Configure AWS credentials for ECR Public", "uses": "aws-actions/configure-aws-credentials@v5", "with": {"role-to-assume": "arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole", "aws-region": "${{ env.AWS_REGION }}", "__startline__": 189, "__endline__": 192}, "__startline__": 186, "__endline__": 192}}, "code_block": [[186, "      - name: Configure AWS credentials for ECR Public\n"], [187, "        uses: aws-actions/configure-aws-credentials@v5\n"], [188, "        with:\n"], [189, "          role-to-assume: arn:aws:iam::786980363770:role/GitHubActionsECRPublicRole\n"], [190, "          aws-region: ${{ env.AWS_REGION }}\n"], [191, "\n"], [192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [186, 193], "resource": "jobs(docker-build).steps[6](Configure AWS credentials for ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to Amazon ECR Public", "uses": "aws-actions/amazon-ecr-login@v2", "with": {"registry-type": "public", "__startline__": 195, "__endline__": 197}, "__startline__": 192, "__endline__": 197}}, "code_block": [[192, "      - name: Log in to Amazon ECR Public\n"], [193, "        uses: aws-actions/amazon-ecr-login@v2\n"], [194, "        with:\n"], [195, "          registry-type: public\n"], [196, "\n"], [197, "      - name: Extract metadata\n"], [198, "        id: meta\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [192, 198], "resource": "jobs(docker-build).steps[7](Log in to Amazon ECR Public)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract metadata", "id": "meta", "uses": "docker/metadata-action@v5", "with": {"images": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n", "tags": "type=semver,pattern={{version}}\ntype=semver,pattern={{major}}.{{minor}}\ntype=semver,pattern={{major}}\ntype=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n", "flavor": "suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\nlatest=false\n", "__startline__": 201, "__endline__": 214}, "__startline__": 197, "__endline__": 214}}, "code_block": [[197, "      - name: Extract metadata\n"], [198, "        id: meta\n"], [199, "        uses: docker/metadata-action@v5\n"], [200, "        with:\n"], [201, "          images: |\n"], [202, "            ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}\n"], [203, "            ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}\n"], [204, "            ${{ vars.DOCKERHUB_ENABLED == 'true' && format('{0}/{1}', env.REGISTRY_DOCKERHUB, env.IMAGE_NAME_DOCKERHUB) || '' }}\n"], [205, "          tags: |\n"], [206, "            type=semver,pattern={{version}}\n"], [207, "            type=semver,pattern={{major}}.{{minor}}\n"], [208, "            type=semver,pattern={{major}}\n"], [209, "            type=raw,value=latest,enable=${{ startsWith(github.ref, 'refs/tags/v') && matrix.variant == 'full' }}\n"], [210, "          flavor: |\n"], [211, "            suffix=-${{ matrix.variant }},onlatest=${{ matrix.variant != 'full' }}\n"], [212, "            latest=false\n"], [213, "\n"], [214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [197, 215], "resource": "jobs(docker-build).steps[8](Extract metadata)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine Dockerfile", "id": "dockerfile", "run": "if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n  echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 214, "__endline__": 223}}, "code_block": [[214, "      - name: Determine Dockerfile\n"], [215, "        id: dockerfile\n"], [216, "        run: |\n"], [217, "          if [ \"${{ matrix.variant }}\" = \"full\" ]; then\n"], [218, "            echo \"file=Dockerfile\" >> \"$GITHUB_OUTPUT\"\n"], [219, "          else\n"], [220, "            echo \"file=Dockerfile.${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [221, "          fi\n"], [222, "\n"], [223, "      - name: Build and push\n"], [224, "        id: build\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [214, 224], "resource": "jobs(docker-build).steps[9](Determine Dockerfile)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Build and push", "id": "build", "uses": "docker/build-push-action@v6", "with": {"context": ".", "file": "${{ steps.dockerfile.outputs.file }}", "platforms": "linux/amd64,linux/arm64", "push": true, "tags": "${{ steps.meta.outputs.tags }}", "labels": "${{ steps.meta.outputs.labels }}", "cache-from": "type=gha,scope=${{ matrix.variant }}", "cache-to": "type=gha,mode=max,scope=${{ matrix.variant }}", "provenance": false, "sbom": false, "__startline__": 227, "__endline__": 238}, "__startline__": 223, "__endline__": 238}}, "code_block": [[223, "      - name: Build and push\n"], [224, "        id: build\n"], [225, "        uses: docker/build-push-action@v6\n"], [226, "        with:\n"], [227, "          context: .\n"], [228, "          file: ${{ steps.dockerfile.outputs.file }}\n"], [229, "          platforms: linux/amd64,linux/arm64\n"], [230, "          push: true\n"], [231, "          tags: ${{ steps.meta.outputs.tags }}\n"], [232, "          labels: ${{ steps.meta.outputs.labels }}\n"], [233, "          cache-from: type=gha,scope=${{ matrix.variant }}\n"], [234, "          cache-to: type=gha,mode=max,scope=${{ matrix.variant }}\n"], [235, "          provenance: false\n"], [236, "          sbom: false\n"], [237, "\n"], [238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [223, 239], "resource": "jobs(docker-build).steps[10](Build and push)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Test image (amd64 only)", "run": "# Use the first tag from metadata output (e.g., 0.4.0-full)\nTEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n\necho \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n# Test basic commands (jmo CLI doesn't have --version, use --help instead)\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n\necho \"\"\necho \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\ndocker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n", "__startline__": 238, "__endline__": 256}}, "code_block": [[238, "      - name: Test image (amd64 only)\n"], [239, "        run: |\n"], [240, "          # Use the first tag from metadata output (e.g., 0.4.0-full)\n"], [241, "          TEST_TAG=$(echo \"${{ steps.meta.outputs.tags }}\" | head -n1 | cut -d':' -f2)\n"], [242, "\n"], [243, "          echo \"Testing GHCR image: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [244, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\"\n"], [245, "          # Test basic commands (jmo CLI doesn't have --version, use --help instead)\n"], [246, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" --help\n"], [247, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TEST_TAG}\" scan --help\n"], [248, "\n"], [249, "          echo \"\"\n"], [250, "          echo \"Testing ECR Public image: ${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [251, "          docker pull --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\"\n"], [252, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" --help\n"], [253, "          docker run --rm --platform linux/amd64 \"${{ env.REGISTRY_ECR_PUBLIC }}/${{ env.IMAGE_NAME_ECR_PUBLIC }}:${TEST_TAG}\" scan --help\n"], [254, "\n"], [255, "  # Benchmark image sizes (v0.6.1+ optimization tracking)\n"], [256, "  docker-size-benchmark:\n"], [257, "    name: Benchmark Docker Image Sizes\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [238, 257], "resource": "jobs(docker-build).steps[11](Test image (amd64 only))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-build"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 264, "__endline__": 268}, "__startline__": 261, "__endline__": 268}}, "code_block": [[261, "      - name: Log in to GitHub Container Registry\n"], [262, "        uses: docker/login-action@v3\n"], [263, "        with:\n"], [264, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [265, "          username: ${{ github.actor }}\n"], [266, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [267, "\n"], [268, "      - name: Determine image tag\n"], [269, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [261, 269], "resource": "jobs(docker-size-benchmark).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 268, "__endline__": 279}}, "code_block": [[268, "      - name: Determine image tag\n"], [269, "        id: tag\n"], [270, "        run: |\n"], [271, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [272, "            VERSION=\"${{ github.ref_name }}\"\n"], [273, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [274, "            echo \"value=${VERSION}\" >> \"$GITHUB_OUTPUT\"\n"], [275, "          else\n"], [276, "            echo \"value=latest\" >> \"$GITHUB_OUTPUT\"\n"], [277, "          fi\n"], [278, "\n"], [279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [268, 280], "resource": "jobs(docker-size-benchmark).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Pull and measure all variants", "run": "{\n  echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n  echo \"\"\n  echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n  echo \"|---------|--------------|--------------|---------------------|\"\n} > size-comparison.md\n\nfor VARIANT in full balanced slim fast; do\n  TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n  IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n\n  echo \"Measuring $IMAGE...\"\n\n  # Get size for amd64 platform from manifest\n  SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  # Get size for arm64 platform from manifest\n  SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n    jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n    numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n\n  echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\ndone\n\n{\n  echo \"\"\n  echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n  echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n  echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n  echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n  echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n  echo \"\"\n  echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n  echo \"- Nuclei template filtering (65 MB)\"\n  echo \"- Python bytecode cleanup (40 MB)\"\n  echo \"- Binary stripping (15 MB)\"\n  echo \"- Java runtime cleanup (30 MB)\"\n  echo \"- .dockerignore exclusions (5 MB)\"\n} >> size-comparison.md\n\ncat size-comparison.md\n", "__startline__": 279, "__endline__": 325}}, "code_block": [[279, "      - name: Pull and measure all variants\n"], [280, "        run: |\n"], [281, "          {\n"], [282, "            echo \"## Docker Image Size Comparison (v1.0.0 - 4 Variants)\"\n"], [283, "            echo \"\"\n"], [284, "            echo \"| Variant | Size (amd64) | Size (arm64) | Reduction vs v0.6.0 |\"\n"], [285, "            echo \"|---------|--------------|--------------|---------------------|\"\n"], [286, "          } > size-comparison.md\n"], [287, "\n"], [288, "          for VARIANT in full balanced slim fast; do\n"], [289, "            TAG=\"${{ steps.tag.outputs.value }}-${VARIANT}\"\n"], [290, "            IMAGE=\"${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${TAG}\"\n"], [291, "\n"], [292, "            echo \"Measuring $IMAGE...\"\n"], [293, "\n"], [294, "            # Get size for amd64 platform from manifest\n"], [295, "            SIZE_AMD64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [296, "              jq -r '.manifests[] | select(.platform.architecture==\"amd64\") | .size' | \\\n"], [297, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [298, "\n"], [299, "            # Get size for arm64 platform from manifest\n"], [300, "            SIZE_ARM64=$(docker manifest inspect \"$IMAGE\" | \\\n"], [301, "              jq -r '.manifests[] | select(.platform.architecture==\"arm64\") | .size' | \\\n"], [302, "              numfmt --to=iec-i --suffix=B --format=\"%.1f\")\n"], [303, "\n"], [304, "            echo \"| ${VARIANT} | ${SIZE_AMD64} | ${SIZE_ARM64} | TBD (manual comparison) |\" >> size-comparison.md\n"], [305, "          done\n"], [306, "\n"], [307, "          {\n"], [308, "            echo \"\"\n"], [309, "            echo \"**v1.0.0 Target Sizes (Phase 1 Optimizations):**\"\n"], [310, "            echo \"- Full: ~1.97 GB (26 Docker-ready tools, 155 MB savings)\"\n"], [311, "            echo \"- Balanced: ~1.41 GB (21 tools, production CI/CD)\"\n"], [312, "            echo \"- Slim: ~557 MB (15 tools, cloud-focused)\"\n"], [313, "            echo \"- Fast: ~502 MB (8 tools, CI/CD gate)\"\n"], [314, "            echo \"\"\n"], [315, "            echo \"**Phase 1 Optimizations Applied (155 MB savings):**\"\n"], [316, "            echo \"- Nuclei template filtering (65 MB)\"\n"], [317, "            echo \"- Python bytecode cleanup (40 MB)\"\n"], [318, "            echo \"- Binary stripping (15 MB)\"\n"], [319, "            echo \"- Java runtime cleanup (30 MB)\"\n"], [320, "            echo \"- .dockerignore exclusions (5 MB)\"\n"], [321, "          } >> size-comparison.md\n"], [322, "\n"], [323, "          cat size-comparison.md\n"], [324, "\n"], [325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [279, 326], "resource": "jobs(docker-size-benchmark).steps[3](Pull and measure all variants)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload size comparison", "uses": "actions/upload-artifact@v5", "with": {"name": "docker-size-comparison-${{ steps.tag.outputs.value }}", "path": "size-comparison.md", "__startline__": 328, "__endline__": 332}, "__startline__": 325, "__endline__": 332}}, "code_block": [[325, "      - name: Upload size comparison\n"], [326, "        uses: actions/upload-artifact@v5\n"], [327, "        with:\n"], [328, "          name: docker-size-comparison-${{ steps.tag.outputs.value }}\n"], [329, "          path: size-comparison.md\n"], [330, "\n"], [331, "  # Scan Docker images for vulnerabilities\n"], [332, "  docker-scan:\n"], [333, "    name: Scan Docker ${{ matrix.variant }}\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [325, 333], "resource": "jobs(docker-size-benchmark).steps[4](Upload size comparison)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-size-benchmark"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Log in to GitHub Container Registry", "uses": "docker/login-action@v3", "with": {"registry": "${{ env.REGISTRY_GHCR }}", "username": "${{ github.actor }}", "password": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 343, "__endline__": 347}, "__startline__": 340, "__endline__": 347}}, "code_block": [[340, "      - name: Log in to GitHub Container Registry\n"], [341, "        uses: docker/login-action@v3\n"], [342, "        with:\n"], [343, "          registry: ${{ env.REGISTRY_GHCR }}\n"], [344, "          username: ${{ github.actor }}\n"], [345, "          password: ${{ secrets.GITHUB_TOKEN }}\n"], [346, "\n"], [347, "      - name: Determine image tag\n"], [348, "        id: tag\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [340, 348], "resource": "jobs(docker-scan).steps[1](Log in to GitHub Container Registry)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Determine image tag", "id": "tag", "run": "# For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\nif [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n  VERSION=\"${{ github.ref_name }}\"\n  VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n  echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\nfi\n", "__startline__": 347, "__endline__": 359}}, "code_block": [[347, "      - name: Determine image tag\n"], [348, "        id: tag\n"], [349, "        run: |\n"], [350, "          # For tags like v0.4.0, the image is tagged as 0.4.0-variant (without 'v')\n"], [351, "          if [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n"], [352, "            VERSION=\"${{ github.ref_name }}\"\n"], [353, "            VERSION=\"${VERSION#v}\"  # Strip 'v' prefix\n"], [354, "            echo \"value=${VERSION}-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [355, "          else\n"], [356, "            echo \"value=latest-${{ matrix.variant }}\" >> \"$GITHUB_OUTPUT\"\n"], [357, "          fi\n"], [358, "\n"], [359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [347, 360], "resource": "jobs(docker-scan).steps[2](Determine image tag)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Trivy vulnerability scanner", "uses": "aquasecurity/trivy-action@master", "with": {"image-ref": "${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}", "format": "sarif", "output": "trivy-results-${{ matrix.variant }}.sarif", "severity": "CRITICAL,HIGH", "__startline__": 362, "__endline__": 367}, "__startline__": 359, "__endline__": 367}}, "code_block": [[359, "      - name: Run Trivy vulnerability scanner\n"], [360, "        uses: aquasecurity/trivy-action@master\n"], [361, "        with:\n"], [362, "          image-ref: ${{ env.REGISTRY_GHCR }}/${{ env.IMAGE_NAME_GHCR }}:${{ steps.tag.outputs.value }}\n"], [363, "          format: 'sarif'\n"], [364, "          output: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [365, "          severity: 'CRITICAL,HIGH'\n"], [366, "\n"], [367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [359, 368], "resource": "jobs(docker-scan).steps[3](Run Trivy vulnerability scanner)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Upload Trivy results to GitHub Security", "uses": "github/codeql-action/upload-sarif@v4", "with": {"sarif_file": "trivy-results-${{ matrix.variant }}.sarif", "category": "docker-${{ matrix.variant }}", "__startline__": 370, "__endline__": 374}, "__startline__": 367, "__endline__": 374}}, "code_block": [[367, "      - name: Upload Trivy results to GitHub Security\n"], [368, "        uses: github/codeql-action/upload-sarif@v4\n"], [369, "        with:\n"], [370, "          sarif_file: 'trivy-results-${{ matrix.variant }}.sarif'\n"], [371, "          category: 'docker-${{ matrix.variant }}'\n"], [372, "\n"], [373, "  # Update Docker Hub README\n"], [374, "  docker-hub-readme:\n"], [375, "    name: Update Docker Hub README\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [367, 375], "resource": "jobs(docker-scan).steps[4](Upload Trivy results to GitHub Security)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-scan"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 384, "__endline__": 387}}, "code_block": [[384, "      - name: Checkout repository\n"], [385, "        uses: actions/checkout@v5\n"], [386, "\n"], [387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [384, 388], "resource": "jobs(docker-hub-readme).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update Docker Hub description", "if": "vars.DOCKERHUB_ENABLED == 'true'", "uses": "peter-evans/dockerhub-description@v5", "with": {"username": "${{ secrets.DOCKERHUB_USERNAME }}", "password": "${{ secrets.DOCKERHUB_TOKEN }}", "repository": "${{ env.IMAGE_NAME_DOCKERHUB }}", "short-description": "Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI", "readme-filepath": "./DOCKER_HUB_README.md", "__startline__": 394, "__endline__": 400}, "__startline__": 387, "__endline__": 400}}, "code_block": [[387, "      - name: Update Docker Hub description\n"], [388, "        # Requires secrets: DOCKERHUB_USERNAME and DOCKERHUB_TOKEN (PAT with read/write/delete scope)\n"], [389, "        # Create PAT at: https://hub.docker.com/settings/security\n"], [390, "        # Add secrets at: https://github.com/${{ github.repository }}/settings/secrets/actions\n"], [391, "        if: vars.DOCKERHUB_ENABLED == 'true'\n"], [392, "        uses: peter-evans/dockerhub-description@v5\n"], [393, "        with:\n"], [394, "          username: ${{ secrets.DOCKERHUB_USERNAME }}\n"], [395, "          password: ${{ secrets.DOCKERHUB_TOKEN }}\n"], [396, "          repository: ${{ env.IMAGE_NAME_DOCKERHUB }}\n"], [397, "          short-description: \"Security audit toolkit with 12 tools - scan repos, images, IaC, URLs, K8s in one unified CLI\"\n"], [398, "          readme-filepath: ./DOCKER_HUB_README.md\n"], [399, "\n"], [400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [387, 401], "resource": "jobs(docker-hub-readme).steps[2](Update Docker Hub description)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Docker Hub update skipped", "if": "vars.DOCKERHUB_ENABLED != 'true'", "run": "echo \"Docker Hub README update skipped.\"\necho \"To enable:\"\necho \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\necho \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\necho \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n", "__startline__": 400, "__endline__": 413}}, "code_block": [[400, "      - name: Docker Hub update skipped\n"], [401, "        if: vars.DOCKERHUB_ENABLED != 'true'\n"], [402, "        run: |\n"], [403, "          echo \"Docker Hub README update skipped.\"\n"], [404, "          echo \"To enable:\"\n"], [405, "          echo \"1. Create Docker Hub PAT: https://hub.docker.com/settings/security\"\n"], [406, "          echo \"2. Add secrets DOCKERHUB_USERNAME and DOCKERHUB_TOKEN\"\n"], [407, "          echo \"3. Set repository variable DOCKERHUB_ENABLED=true\"\n"], [408, "\n"], [409, "  # Verify PyPI badges auto-update correctly after release\n"], [410, "  # NOTE: This job is non-blocking (continue-on-error: true) to prevent badge\n"], [411, "  # caching from blocking the entire release. Badges will update within 15-30\n"], [412, "  # minutes after PyPI propagation completes.\n"], [413, "  verify-badges:\n"], [414, "    name: Verify PyPI Badges\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [400, 414], "resource": "jobs(docker-hub-readme).steps[3](Docker Hub update skipped)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["docker-hub-readme"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 420, "__endline__": 423}}, "code_block": [[420, "      - name: Checkout repository\n"], [421, "        uses: actions/checkout@v5\n"], [422, "\n"], [423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [420, 424], "resource": "jobs(verify-badges).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI to propagate with retries", "run": "echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n\n# Initial wait (increased from 90s to 2 minutes)\necho \"  Initial wait: 120s...\"\nsleep 120\n\n# Retry loop with exponential backoff\nMAX_RETRIES=5  # Increased from 3 to 5\nRETRY_COUNT=0\nSUCCESS=false\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n  echo \"\"\n  echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n\n  if bash scripts/dev/verify_badges.sh; then\n    SUCCESS=true\n    break\n  fi\n\n  RETRY_COUNT=$((RETRY_COUNT + 1))\n  if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n    WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n    echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n    sleep $WAIT_TIME\n  fi\ndone\n\nif [ \"$SUCCESS\" = false ]; then\n  echo \"\"\n  echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n  echo \"\"\n  echo \"This is expected behavior and does NOT indicate a release failure.\"\n  echo \"\"\n  echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n  echo \"  1. PyPI API propagation: 2-5 minutes\"\n  echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n  echo \"\"\n  echo \"The release will proceed successfully. Badges will auto-update.\"\n  echo \"\"\n  echo \"Manual verification (optional):\"\n  echo \"  make verify-badges\"\n  echo \"\"\n  echo \"\u2705 Release workflow continues...\"\n  exit 0  # Exit with success to mark job as passed\nfi\n\necho \"\"\necho \"\u2705 Badge verification successful!\"\n", "__startline__": 423, "__endline__": 476}}, "code_block": [[423, "      - name: Wait for PyPI to propagate with retries\n"], [424, "        run: |\n"], [425, "          echo \"\u23f3 Waiting for PyPI to propagate the new version...\"\n"], [426, "\n"], [427, "          # Initial wait (increased from 90s to 2 minutes)\n"], [428, "          echo \"  Initial wait: 120s...\"\n"], [429, "          sleep 120\n"], [430, "\n"], [431, "          # Retry loop with exponential backoff\n"], [432, "          MAX_RETRIES=5  # Increased from 3 to 5\n"], [433, "          RETRY_COUNT=0\n"], [434, "          SUCCESS=false\n"], [435, "\n"], [436, "          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n"], [437, "            echo \"\"\n"], [438, "            echo \"\ud83d\udd0d Attempt $((RETRY_COUNT + 1))/$MAX_RETRIES: Verifying badges...\"\n"], [439, "\n"], [440, "            if bash scripts/dev/verify_badges.sh; then\n"], [441, "              SUCCESS=true\n"], [442, "              break\n"], [443, "            fi\n"], [444, "\n"], [445, "            RETRY_COUNT=$((RETRY_COUNT + 1))\n"], [446, "            if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n"], [447, "              WAIT_TIME=$((60 * RETRY_COUNT))  # 60s, 120s, 180s, 240s exponential backoff\n"], [448, "              echo \"\u23f3 Waiting ${WAIT_TIME}s before retry...\"\n"], [449, "              sleep $WAIT_TIME\n"], [450, "            fi\n"], [451, "          done\n"], [452, "\n"], [453, "          if [ \"$SUCCESS\" = false ]; then\n"], [454, "            echo \"\"\n"], [455, "            echo \"\u26a0\ufe0f  Badge verification did not complete after $MAX_RETRIES attempts.\"\n"], [456, "            echo \"\"\n"], [457, "            echo \"This is expected behavior and does NOT indicate a release failure.\"\n"], [458, "            echo \"\"\n"], [459, "            echo \"Badges update asynchronously and typically take 5-30 minutes:\"\n"], [460, "            echo \"  1. PyPI API propagation: 2-5 minutes\"\n"], [461, "            echo \"  2. Badge CDN caching: 15-30 minutes for global propagation\"\n"], [462, "            echo \"\"\n"], [463, "            echo \"The release will proceed successfully. Badges will auto-update.\"\n"], [464, "            echo \"\"\n"], [465, "            echo \"Manual verification (optional):\"\n"], [466, "            echo \"  make verify-badges\"\n"], [467, "            echo \"\"\n"], [468, "            echo \"\u2705 Release workflow continues...\"\n"], [469, "            exit 0  # Exit with success to mark job as passed\n"], [470, "          fi\n"], [471, "\n"], [472, "          echo \"\"\n"], [473, "          echo \"\u2705 Badge verification successful!\"\n"], [474, "\n"], [475, "  # Submit Homebrew formula PR (automated)\n"], [476, "  homebrew-bump:\n"], [477, "    name: Submit Homebrew Formula PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [423, 477], "resource": "jobs(verify-badges).steps[2](Wait for PyPI to propagate with retries)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["verify-badges"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version", "id": "version", "run": "VERSION=\"${GITHUB_REF#refs/tags/v}\"\necho \"version=$VERSION\" >> $GITHUB_OUTPUT\necho \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n", "__startline__": 482, "__endline__": 489}}, "code_block": [[482, "      - name: Extract version\n"], [483, "        id: version\n"], [484, "        run: |\n"], [485, "          VERSION=\"${GITHUB_REF#refs/tags/v}\"\n"], [486, "          echo \"version=$VERSION\" >> $GITHUB_OUTPUT\n"], [487, "          echo \"\ud83d\udce6 Submitting Homebrew formula PR for version $VERSION\"\n"], [488, "\n"], [489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [482, 490], "resource": "jobs(homebrew-bump).steps[1](Extract version)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Wait for PyPI release", "run": "VERSION=\"${{ steps.version.outputs.version }}\"\necho \"\u23f3 Waiting for PyPI release to be available...\"\n\nMAX_ATTEMPTS=30\nATTEMPT=0\nwhile [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n  if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n    echo \"\u2705 PyPI release $VERSION confirmed!\"\n    exit 0\n  fi\n  ATTEMPT=$((ATTEMPT + 1))\n  echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n  sleep 10\ndone\necho \"\u274c PyPI release not available after 5 minutes\"\nexit 1\n", "__startline__": 489, "__endline__": 508}}, "code_block": [[489, "      - name: Wait for PyPI release\n"], [490, "        run: |\n"], [491, "          VERSION=\"${{ steps.version.outputs.version }}\"\n"], [492, "          echo \"\u23f3 Waiting for PyPI release to be available...\"\n"], [493, "\n"], [494, "          MAX_ATTEMPTS=30\n"], [495, "          ATTEMPT=0\n"], [496, "          while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do\n"], [497, "            if curl -fsSL \"https://pypi.org/pypi/jmo-security/$VERSION/json\" > /dev/null 2>&1; then\n"], [498, "              echo \"\u2705 PyPI release $VERSION confirmed!\"\n"], [499, "              exit 0\n"], [500, "            fi\n"], [501, "            ATTEMPT=$((ATTEMPT + 1))\n"], [502, "            echo \"\u23f3 Attempt $ATTEMPT/$MAX_ATTEMPTS: waiting 10s...\"\n"], [503, "            sleep 10\n"], [504, "          done\n"], [505, "          echo \"\u274c PyPI release not available after 5 minutes\"\n"], [506, "          exit 1\n"], [507, "\n"], [508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [489, 509], "resource": "jobs(homebrew-bump).steps[2](Wait for PyPI release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger homebrew-bump-formula workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'homebrew-bump-formula.yml',\n  ref: 'main',\n  inputs: {\n    version: '${{ steps.version.outputs.version }}'\n  }\n});\nconsole.log('\u2705 Triggered homebrew-bump-formula workflow');\n", "__startline__": 511, "__endline__": 524}, "__startline__": 508, "__endline__": 524}}, "code_block": [[508, "      - name: Trigger homebrew-bump-formula workflow\n"], [509, "        uses: actions/github-script@v7\n"], [510, "        with:\n"], [511, "          script: |\n"], [512, "            await github.rest.actions.createWorkflowDispatch({\n"], [513, "              owner: context.repo.owner,\n"], [514, "              repo: context.repo.repo,\n"], [515, "              workflow_id: 'homebrew-bump-formula.yml',\n"], [516, "              ref: 'main',\n"], [517, "              inputs: {\n"], [518, "                version: '${{ steps.version.outputs.version }}'\n"], [519, "              }\n"], [520, "            });\n"], [521, "            console.log('\u2705 Triggered homebrew-bump-formula workflow');\n"], [522, "\n"], [523, "  # Submit WinGet manifest PR (automated)\n"], [524, "  winget-bump:\n"], [525, "    name: Submit WinGet Manifest PR\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [508, 525], "resource": "jobs(homebrew-bump).steps[3](Trigger homebrew-bump-formula workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["homebrew-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Trigger winget-releaser workflow", "uses": "actions/github-script@v7", "with": {"script": "await github.rest.actions.createWorkflowDispatch({\n  owner: context.repo.owner,\n  repo: context.repo.repo,\n  workflow_id: 'winget-releaser.yml',\n  ref: 'main'\n});\nconsole.log('\u2705 Triggered winget-releaser workflow');\n", "__startline__": 533, "__endline__": 541}, "__startline__": 530, "__endline__": 541}}, "code_block": [[530, "      - name: Trigger winget-releaser workflow\n"], [531, "        uses: actions/github-script@v7\n"], [532, "        with:\n"], [533, "          script: |\n"], [534, "            await github.rest.actions.createWorkflowDispatch({\n"], [535, "              owner: context.repo.owner,\n"], [536, "              repo: context.repo.repo,\n"], [537, "              workflow_id: 'winget-releaser.yml',\n"], [538, "              ref: 'main'\n"], [539, "            });\n"], [540, "            console.log('\u2705 Triggered winget-releaser workflow');\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [530, 542], "resource": "jobs(winget-bump).steps[1](Trigger winget-releaser workflow)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": ["winget-bump"], "workflow_name": "Release"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}}, "code_block": [[27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [27, 98], "resource": "jobs(check-versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}}, "code_block": [[98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [98, 130], "resource": "jobs(check-dockerfile-consistency)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}}, "code_block": [[130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [130, 160], "resource": "jobs(check-python-deps)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}}, "code_block": [[160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [160, 179], "resource": "jobs(version-check-summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}}, "code_block": [[27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [27, 98], "resource": "jobs(check-versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}}, "code_block": [[98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [98, 130], "resource": "jobs(check-dockerfile-consistency)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}}, "code_block": [[130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [130, 160], "resource": "jobs(check-python-deps)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}}, "code_block": [[160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [160, 179], "resource": "jobs(version-check-summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}}, "code_block": [[27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [27, 98], "resource": "jobs(check-versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}}, "code_block": [[98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [98, 130], "resource": "jobs(check-dockerfile-consistency)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}}, "code_block": [[130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [130, 160], "resource": "jobs(check-python-deps)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}}, "code_block": [[160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [160, 179], "resource": "jobs(version-check-summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"check-versions": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}, "check-dockerfile-consistency": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}, "check-python-deps": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}, "version-check-summary": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}, "__startline__": 26, "__endline__": 178}}, "code_block": [[26, "  check-versions:\n"], [27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [26, 179], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}}, "code_block": [[27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [27, 98], "resource": "jobs(check-versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}}, "code_block": [[98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [98, 130], "resource": "jobs(check-dockerfile-consistency)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}}, "code_block": [[130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [130, 160], "resource": "jobs(check-python-deps)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}}, "code_block": [[160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [160, 179], "resource": "jobs(version-check-summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"check-versions": {"name": "Check tool versions", "runs-on": "ubuntu-latest", "timeout-minutes": 10, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}, {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}, {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}, {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}, {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}, {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}, {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}, {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}], "__startline__": 27, "__endline__": 97}, "check-dockerfile-consistency": {"name": "Validate Dockerfile consistency", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}, {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}], "__startline__": 98, "__endline__": 129}, "check-python-deps": {"name": "Check Python dependency freshness", "runs-on": "ubuntu-latest", "timeout-minutes": 5, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}, {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}], "__startline__": 130, "__endline__": 159}, "version-check-summary": {"name": "Version check summary", "runs-on": "ubuntu-latest", "needs": ["check-versions", "check-dockerfile-consistency", "check-python-deps"], "if": "always()", "steps": [{"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}], "__startline__": 160, "__endline__": 178}, "__startline__": 26, "__endline__": 178}}, "code_block": [[26, "  check-versions:\n"], [27, "    name: Check tool versions\n"], [28, "    runs-on: ubuntu-latest\n"], [29, "    timeout-minutes: 10\n"], [30, "    steps:\n"], [31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"], [99, "    runs-on: ubuntu-latest\n"], [100, "    timeout-minutes: 5\n"], [101, "    steps:\n"], [102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"], [131, "    runs-on: ubuntu-latest\n"], [132, "    timeout-minutes: 5\n"], [133, "    steps:\n"], [134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"], [161, "    runs-on: ubuntu-latest\n"], [162, "    needs: [check-versions, check-dockerfile-consistency, check-python-deps]\n"], [163, "    if: always()\n"], [164, "    steps:\n"], [165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [26, 179], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}}, "code_block": [[31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [31, 35], "resource": "jobs(check-versions).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [34, 40], "resource": "jobs(check-versions).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [39, 45], "resource": "jobs(check-versions).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}}, "code_block": [[44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [44, 49], "resource": "jobs(check-versions).steps[4](Authenticate GitHub CLI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}}, "code_block": [[48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [48, 54], "resource": "jobs(check-versions).steps[5](Check for latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}}, "code_block": [[53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [53, 58], "resource": "jobs(check-versions).steps[6](Generate version report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}}, "code_block": [[57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [57, 65], "resource": "jobs(check-versions).steps[7](Check outdated tools and create issues)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}}, "code_block": [[64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [64, 74], "resource": "jobs(check-versions).steps[8](Validate version consistency across files)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}}, "code_block": [[73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [73, 98], "resource": "jobs(check-versions).steps[9](Check for Trivy version mismatch (critical))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}}, "code_block": [[102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [102, 106], "resource": "jobs(check-dockerfile-consistency).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}}, "code_block": [[105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [105, 130], "resource": "jobs(check-dockerfile-consistency).steps[2](Check for hardcoded versions in Dockerfiles)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [134, 138], "resource": "jobs(check-python-deps).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}}, "code_block": [[137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [137, 143], "resource": "jobs(check-python-deps).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}}, "code_block": [[142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [142, 160], "resource": "jobs(check-python-deps).steps[3](Check PyPI for security tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}}, "code_block": [[165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [165, 179], "resource": "jobs(version-check-summary).steps[1](Check job results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}}, "code_block": [[31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [31, 35], "resource": "jobs(check-versions).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [34, 40], "resource": "jobs(check-versions).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [39, 45], "resource": "jobs(check-versions).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}}, "code_block": [[44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [44, 49], "resource": "jobs(check-versions).steps[4](Authenticate GitHub CLI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}}, "code_block": [[48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [48, 54], "resource": "jobs(check-versions).steps[5](Check for latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}}, "code_block": [[53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [53, 58], "resource": "jobs(check-versions).steps[6](Generate version report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}}, "code_block": [[57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [57, 65], "resource": "jobs(check-versions).steps[7](Check outdated tools and create issues)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}}, "code_block": [[64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [64, 74], "resource": "jobs(check-versions).steps[8](Validate version consistency across files)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}}, "code_block": [[73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [73, 98], "resource": "jobs(check-versions).steps[9](Check for Trivy version mismatch (critical))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}}, "code_block": [[102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [102, 106], "resource": "jobs(check-dockerfile-consistency).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}}, "code_block": [[105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [105, 130], "resource": "jobs(check-dockerfile-consistency).steps[2](Check for hardcoded versions in Dockerfiles)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [134, 138], "resource": "jobs(check-python-deps).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}}, "code_block": [[137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [137, 143], "resource": "jobs(check-python-deps).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}}, "code_block": [[142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [142, 160], "resource": "jobs(check-python-deps).steps[3](Check PyPI for security tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}}, "code_block": [[165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [165, 179], "resource": "jobs(version-check-summary).steps[1](Check job results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}}, "code_block": [[31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [31, 35], "resource": "jobs(check-versions).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [34, 40], "resource": "jobs(check-versions).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [39, 45], "resource": "jobs(check-versions).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}}, "code_block": [[44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [44, 49], "resource": "jobs(check-versions).steps[4](Authenticate GitHub CLI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}}, "code_block": [[48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [48, 54], "resource": "jobs(check-versions).steps[5](Check for latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}}, "code_block": [[53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [53, 58], "resource": "jobs(check-versions).steps[6](Generate version report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}}, "code_block": [[57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [57, 65], "resource": "jobs(check-versions).steps[7](Check outdated tools and create issues)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}}, "code_block": [[64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [64, 74], "resource": "jobs(check-versions).steps[8](Validate version consistency across files)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}}, "code_block": [[73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [73, 98], "resource": "jobs(check-versions).steps[9](Check for Trivy version mismatch (critical))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}}, "code_block": [[102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [102, 106], "resource": "jobs(check-dockerfile-consistency).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}}, "code_block": [[105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [105, 130], "resource": "jobs(check-dockerfile-consistency).steps[2](Check for hardcoded versions in Dockerfiles)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [134, 138], "resource": "jobs(check-python-deps).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}}, "code_block": [[137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [137, 143], "resource": "jobs(check-python-deps).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}}, "code_block": [[142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [142, 160], "resource": "jobs(check-python-deps).steps[3](Check PyPI for security tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}}, "code_block": [[165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [165, 179], "resource": "jobs(version-check-summary).steps[1](Check job results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 31, "__endline__": 34}}, "code_block": [[31, "      - name: Checkout repository\n"], [32, "        uses: actions/checkout@v5\n"], [33, "\n"], [34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [31, 35], "resource": "jobs(check-versions).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 37, "__endline__": 39}, "__startline__": 34, "__endline__": 39}}, "code_block": [[34, "      - name: Set up Python 3.11\n"], [35, "        uses: actions/setup-python@v6\n"], [36, "        with:\n"], [37, "          python-version: '3.11'\n"], [38, "\n"], [39, "      - name: Install dependencies\n"], [40, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [34, 40], "resource": "jobs(check-versions).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "python -m pip install --upgrade pip\npip install pyyaml\n", "__startline__": 39, "__endline__": 44}}, "code_block": [[39, "      - name: Install dependencies\n"], [40, "        run: |\n"], [41, "          python -m pip install --upgrade pip\n"], [42, "          pip install pyyaml\n"], [43, "\n"], [44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [39, 45], "resource": "jobs(check-versions).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Authenticate GitHub CLI", "run": "echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n", "__startline__": 44, "__endline__": 48}}, "code_block": [[44, "      - name: Authenticate GitHub CLI\n"], [45, "        run: |\n"], [46, "          echo \"${{ secrets.GITHUB_TOKEN }}\" | gh auth login --with-token\n"], [47, "\n"], [48, "      - name: Check for latest versions\n"], [49, "        id: check\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [44, 49], "resource": "jobs(check-versions).steps[4](Authenticate GitHub CLI)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for latest versions", "id": "check", "run": "python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n", "__startline__": 48, "__endline__": 53}}, "code_block": [[48, "      - name: Check for latest versions\n"], [49, "        id: check\n"], [50, "        run: |\n"], [51, "          python3 scripts/dev/update_versions.py --check-latest || echo \"outdated=true\" >> \"$GITHUB_OUTPUT\"\n"], [52, "\n"], [53, "      - name: Generate version report\n"], [54, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [48, 54], "resource": "jobs(check-versions).steps[5](Check for latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Generate version report", "run": "python3 scripts/dev/update_versions.py --report\n", "__startline__": 53, "__endline__": 57}}, "code_block": [[53, "      - name: Generate version report\n"], [54, "        run: |\n"], [55, "          python3 scripts/dev/update_versions.py --report\n"], [56, "\n"], [57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [53, 58], "resource": "jobs(check-versions).steps[6](Generate version report)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check outdated tools and create issues", "if": "github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'", "env": {"GH_TOKEN": "${{ secrets.GITHUB_TOKEN }}", "__startline__": 60, "__endline__": 61}, "run": "python3 scripts/dev/update_versions.py --check-outdated --create-issues\n", "__startline__": 57, "__endline__": 64}}, "code_block": [[57, "      - name: Check outdated tools and create issues\n"], [58, "        if: github.event_name == 'schedule' || github.event.inputs.create_issues == 'true'\n"], [59, "        env:\n"], [60, "          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"], [61, "        run: |\n"], [62, "          python3 scripts/dev/update_versions.py --check-outdated --create-issues\n"], [63, "\n"], [64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [57, 65], "resource": "jobs(check-versions).steps[7](Check outdated tools and create issues)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Validate version consistency across files", "run": "# Check Dockerfile versions match versions.yaml\npython3 scripts/dev/update_versions.py --sync --dry-run || {\n  echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n  echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n  exit 1\n}\n", "__startline__": 64, "__endline__": 73}}, "code_block": [[64, "      - name: Validate version consistency across files\n"], [65, "        run: |\n"], [66, "          # Check Dockerfile versions match versions.yaml\n"], [67, "          python3 scripts/dev/update_versions.py --sync --dry-run || {\n"], [68, "            echo \"::error::Dockerfiles are out of sync with versions.yaml\"\n"], [69, "            echo \"::error::Run: python3 scripts/dev/update_versions.py --sync\"\n"], [70, "            exit 1\n"], [71, "          }\n"], [72, "\n"], [73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [64, 74], "resource": "jobs(check-versions).steps[8](Validate version consistency across files)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for Trivy version mismatch (critical)", "run": "# Extract Trivy versions from all 4 Dockerfiles\n# shellcheck disable=SC2252\nTRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\nTRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\nTRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\nTRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n\necho \"Trivy versions found:\"\necho \"  Dockerfile:          $TRIVY_FULL\"\necho \"  Dockerfile.balanced: $TRIVY_BALANCED\"\necho \"  Dockerfile.slim:     $TRIVY_SLIM\"\necho \"  Dockerfile.fast:     $TRIVY_FAST\"\n\n# Check for mismatches across all 4 variants\nif [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n  echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n  echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n  exit 1\nfi\n\necho \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n", "__startline__": 73, "__endline__": 97}}, "code_block": [[73, "      - name: Check for Trivy version mismatch (critical)\n"], [74, "        run: |\n"], [75, "          # Extract Trivy versions from all 4 Dockerfiles\n"], [76, "          # shellcheck disable=SC2252\n"], [77, "          TRIVY_FULL=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile || echo \"not_found\")\n"], [78, "          TRIVY_BALANCED=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.balanced || echo \"not_found\")\n"], [79, "          TRIVY_SLIM=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.slim || echo \"not_found\")\n"], [80, "          TRIVY_FAST=$(grep -oP 'TRIVY_VERSION=\"\\K[0-9.]+' Dockerfile.fast || echo \"not_found\")\n"], [81, "\n"], [82, "          echo \"Trivy versions found:\"\n"], [83, "          echo \"  Dockerfile:          $TRIVY_FULL\"\n"], [84, "          echo \"  Dockerfile.balanced: $TRIVY_BALANCED\"\n"], [85, "          echo \"  Dockerfile.slim:     $TRIVY_SLIM\"\n"], [86, "          echo \"  Dockerfile.fast:     $TRIVY_FAST\"\n"], [87, "\n"], [88, "          # Check for mismatches across all 4 variants\n"], [89, "          if [ \"$TRIVY_FULL\" != \"$TRIVY_BALANCED\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_SLIM\" ] || [ \"$TRIVY_FULL\" != \"$TRIVY_FAST\" ]; then\n"], [90, "            echo \"::error::CRITICAL: Trivy version mismatch detected!\"\n"], [91, "            echo \"::error::This can cause CVE detection discrepancies (see ROADMAP.md #14)\"\n"], [92, "            exit 1\n"], [93, "          fi\n"], [94, "\n"], [95, "          echo \"\u2705 All Trivy versions are consistent across 4 variants: $TRIVY_FULL\"\n"], [96, "\n"], [97, "  check-dockerfile-consistency:\n"], [98, "    name: Validate Dockerfile consistency\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [73, 98], "resource": "jobs(check-versions).steps[9](Check for Trivy version mismatch (critical))", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-versions"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 102, "__endline__": 105}}, "code_block": [[102, "      - name: Checkout repository\n"], [103, "        uses: actions/checkout@v5\n"], [104, "\n"], [105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [102, 106], "resource": "jobs(check-dockerfile-consistency).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for hardcoded versions in Dockerfiles", "run": "# This check ensures versions are parameterized via ARG/ENV variables\n# and not hardcoded inline\n\nISSUES=0\n\n# Check for inline version patterns that should use variables\nfor dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n  echo \"Checking $dockerfile for hardcoded versions...\"\n\n  # Look for download URLs with hardcoded versions (bad pattern)\n  if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n    echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n    ISSUES=$((ISSUES + 1))\n  fi\ndone\n\nif [ $ISSUES -gt 0 ]; then\n  echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\nelse\n  echo \"\u2705 No hardcoded versions detected\"\nfi\n", "__startline__": 105, "__endline__": 129}}, "code_block": [[105, "      - name: Check for hardcoded versions in Dockerfiles\n"], [106, "        run: |\n"], [107, "          # This check ensures versions are parameterized via ARG/ENV variables\n"], [108, "          # and not hardcoded inline\n"], [109, "\n"], [110, "          ISSUES=0\n"], [111, "\n"], [112, "          # Check for inline version patterns that should use variables\n"], [113, "          for dockerfile in Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast; do\n"], [114, "            echo \"Checking $dockerfile for hardcoded versions...\"\n"], [115, "\n"], [116, "            # Look for download URLs with hardcoded versions (bad pattern)\n"], [117, "            if grep -P 'github.com/[^/]+/[^/]+/releases/download/v[0-9]+\\.[0-9]+\\.[0-9]+/' \"$dockerfile\" | grep -v \"\\${.*_VERSION}\"; then\n"], [118, "              echo \"::warning file=$dockerfile::Found hardcoded version in download URL\"\n"], [119, "              ISSUES=$((ISSUES + 1))\n"], [120, "            fi\n"], [121, "          done\n"], [122, "\n"], [123, "          if [ $ISSUES -gt 0 ]; then\n"], [124, "            echo \"::notice::Found $ISSUES potential hardcoded versions. Review manually.\"\n"], [125, "          else\n"], [126, "            echo \"\u2705 No hardcoded versions detected\"\n"], [127, "          fi\n"], [128, "\n"], [129, "  check-python-deps:\n"], [130, "    name: Check Python dependency freshness\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [105, 130], "resource": "jobs(check-dockerfile-consistency).steps[2](Check for hardcoded versions in Dockerfiles)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-dockerfile-consistency"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "__startline__": 134, "__endline__": 137}}, "code_block": [[134, "      - name: Checkout repository\n"], [135, "        uses: actions/checkout@v5\n"], [136, "\n"], [137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [134, 138], "resource": "jobs(check-python-deps).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 140, "__endline__": 142}, "__startline__": 137, "__endline__": 142}}, "code_block": [[137, "      - name: Set up Python 3.11\n"], [138, "        uses: actions/setup-python@v6\n"], [139, "        with:\n"], [140, "          python-version: '3.11'\n"], [141, "\n"], [142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [137, 143], "resource": "jobs(check-python-deps).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check PyPI for security tool updates", "run": "# Check if Python security tools have updates\nfor tool in bandit semgrep checkov ruff; do\n  echo \"Checking $tool...\"\n  CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n  LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n\n  echo \"  Current: $CURRENT\"\n  echo \"  Latest:  $LATEST\"\n\n  if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n    echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n  fi\ndone\n", "__startline__": 142, "__endline__": 159}}, "code_block": [[142, "      - name: Check PyPI for security tool updates\n"], [143, "        run: |\n"], [144, "          # Check if Python security tools have updates\n"], [145, "          for tool in bandit semgrep checkov ruff; do\n"], [146, "            echo \"Checking $tool...\"\n"], [147, "            CURRENT=$(grep -oP \"${tool}==[0-9.]+\" Dockerfile | head -n1 | cut -d'=' -f3 || echo \"unknown\")\n"], [148, "            LATEST=$(pip index versions \"$tool\" 2>/dev/null | grep -oP '(?<=Available versions: )[0-9.]+' | head -n1 || echo \"unknown\")\n"], [149, "\n"], [150, "            echo \"  Current: $CURRENT\"\n"], [151, "            echo \"  Latest:  $LATEST\"\n"], [152, "\n"], [153, "            if [ \"$CURRENT\" != \"$LATEST\" ] && [ \"$CURRENT\" != \"unknown\" ] && [ \"$LATEST\" != \"unknown\" ]; then\n"], [154, "              echo \"::notice::$tool has update available: $CURRENT \u2192 $LATEST\"\n"], [155, "            fi\n"], [156, "          done\n"], [157, "\n"], [158, "  # Summary job - fails if any critical issues found\n"], [159, "  version-check-summary:\n"], [160, "    name: Version check summary\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [142, 160], "resource": "jobs(check-python-deps).steps[3](Check PyPI for security tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["check-python-deps"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check job results", "run": "if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n  echo \"::error::Version check failed - see check-versions job\"\n  exit 1\nfi\n\nif [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n  echo \"::error::Dockerfile consistency check failed\"\n  exit 1\nfi\n\necho \"\u2705 All version checks passed\"\n", "__startline__": 165, "__endline__": 178}}, "code_block": [[165, "      - name: Check job results\n"], [166, "        run: |\n"], [167, "          if [ \"${{ needs.check-versions.result }}\" == \"failure\" ]; then\n"], [168, "            echo \"::error::Version check failed - see check-versions job\"\n"], [169, "            exit 1\n"], [170, "          fi\n"], [171, "\n"], [172, "          if [ \"${{ needs.check-dockerfile-consistency.result }}\" == \"failure\" ]; then\n"], [173, "            echo \"::error::Dockerfile consistency check failed\"\n"], [174, "            exit 1\n"], [175, "          fi\n"], [176, "\n"], [177, "          echo \"\u2705 All version checks passed\"\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [165, 179], "resource": "jobs(version-check-summary).steps[1](Check job results)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["version-check-summary"], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}}, "code_block": [[15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [15, 171], "resource": "jobs(auto-update-tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}}, "code_block": [[15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [15, 171], "resource": "jobs(auto-update-tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}}, "code_block": [[15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [15, 171], "resource": "jobs(auto-update-tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"auto-update-tools": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}, "__startline__": 14, "__endline__": 170}}, "code_block": [[14, "  auto-update-tools:\n"], [15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [14, 171], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}}, "code_block": [[15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [15, 171], "resource": "jobs(auto-update-tools)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"auto-update-tools": {"name": "Auto-update all security tools", "runs-on": "ubuntu-latest", "timeout-minutes": 15, "steps": [{"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}, {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}, {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}, {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}, {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}, {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}, {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}, {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}], "__startline__": 15, "__endline__": 170}, "__startline__": 14, "__endline__": 170}}, "code_block": [[14, "  auto-update-tools:\n"], [15, "    name: Auto-update all security tools\n"], [16, "    runs-on: ubuntu-latest\n"], [17, "    timeout-minutes: 15\n"], [18, "    steps:\n"], [19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [14, 171], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"schedule": [{"cron": "0 0 * * 0", "__startline__": 6, "__endline__": 7}], "workflow_dispatch": null, "__startline__": 4, "__endline__": 9}}, "code_block": [[4, "  schedule:\n"], [5, "    # Run every Sunday at 00:00 UTC\n"], [6, "    - cron: '0 0 * * 0'\n"], [7, "  workflow_dispatch:  # Allow manual trigger\n"], [8, "\n"], [9, "permissions:\n"], [10, "  contents: write\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [4, 10], "resource": "on(Weekly Tool Update)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [19, 25], "resource": "jobs(auto-update-tools).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}}, "code_block": [[24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [24, 30], "resource": "jobs(auto-update-tools).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [29, 35], "resource": "jobs(auto-update-tools).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}}, "code_block": [[34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [34, 51], "resource": "jobs(auto-update-tools).steps[4](Check for tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}}, "code_block": [[50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [50, 61], "resource": "jobs(auto-update-tools).steps[5](Update all tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}}, "code_block": [[60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [60, 102], "resource": "jobs(auto-update-tools).steps[6](Commit changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}}, "code_block": [[101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [101, 148], "resource": "jobs(auto-update-tools).steps[7](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}}, "code_block": [[147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [147, 171], "resource": "jobs(auto-update-tools).steps[8](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [19, 25], "resource": "jobs(auto-update-tools).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}}, "code_block": [[24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [24, 30], "resource": "jobs(auto-update-tools).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [29, 35], "resource": "jobs(auto-update-tools).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}}, "code_block": [[34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [34, 51], "resource": "jobs(auto-update-tools).steps[4](Check for tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}}, "code_block": [[50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [50, 61], "resource": "jobs(auto-update-tools).steps[5](Update all tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}}, "code_block": [[60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [60, 102], "resource": "jobs(auto-update-tools).steps[6](Commit changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}}, "code_block": [[101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [101, 148], "resource": "jobs(auto-update-tools).steps[7](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}}, "code_block": [[147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [147, 171], "resource": "jobs(auto-update-tools).steps[8](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [19, 25], "resource": "jobs(auto-update-tools).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}}, "code_block": [[24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [24, 30], "resource": "jobs(auto-update-tools).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [29, 35], "resource": "jobs(auto-update-tools).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}}, "code_block": [[34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [34, 51], "resource": "jobs(auto-update-tools).steps[4](Check for tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}}, "code_block": [[50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [50, 61], "resource": "jobs(auto-update-tools).steps[5](Update all tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}}, "code_block": [[60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [60, 102], "resource": "jobs(auto-update-tools).steps[6](Commit changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}}, "code_block": [[101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [101, 148], "resource": "jobs(auto-update-tools).steps[7](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}}, "code_block": [[147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [147, 171], "resource": "jobs(auto-update-tools).steps[8](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repository", "uses": "actions/checkout@v5", "with": {"fetch-depth": 0, "__startline__": 22, "__endline__": 24}, "__startline__": 19, "__endline__": 24}}, "code_block": [[19, "      - name: Checkout repository\n"], [20, "        uses: actions/checkout@v5\n"], [21, "        with:\n"], [22, "          fetch-depth: 0\n"], [23, "\n"], [24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [19, 25], "resource": "jobs(auto-update-tools).steps[1](Checkout repository)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python 3.11", "uses": "actions/setup-python@v6", "with": {"python-version": "3.11", "__startline__": 27, "__endline__": 29}, "__startline__": 24, "__endline__": 29}}, "code_block": [[24, "      - name: Set up Python 3.11\n"], [25, "        uses: actions/setup-python@v6\n"], [26, "        with:\n"], [27, "          python-version: '3.11'\n"], [28, "\n"], [29, "      - name: Install dependencies\n"], [30, "        run: |\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [24, 30], "resource": "jobs(auto-update-tools).steps[2](Set up Python 3.11)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Install dependencies", "run": "pip install --upgrade pip\npip install pyyaml requests packaging\n", "__startline__": 29, "__endline__": 34}}, "code_block": [[29, "      - name: Install dependencies\n"], [30, "        run: |\n"], [31, "          pip install --upgrade pip\n"], [32, "          pip install pyyaml requests packaging\n"], [33, "\n"], [34, "      - name: Check for tool updates\n"], [35, "        id: check\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [29, 35], "resource": "jobs(auto-update-tools).steps[3](Install dependencies)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Check for tool updates", "id": "check", "run": "echo \"Checking for available tool updates...\"\npython3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\ncat check_output.txt\n\n# Check if any updates are available\nif grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n  echo \"updates_available=true\" >> $GITHUB_OUTPUT\n  echo \"\u2705 Updates available\"\nelse\n  echo \"updates_available=false\" >> $GITHUB_OUTPUT\n  echo \"\u2139\ufe0f  All tools already up-to-date\"\nfi\n", "__startline__": 34, "__endline__": 50}}, "code_block": [[34, "      - name: Check for tool updates\n"], [35, "        id: check\n"], [36, "        run: |\n"], [37, "          echo \"Checking for available tool updates...\"\n"], [38, "          python3 scripts/dev/update_versions.py --check-latest > check_output.txt || true\n"], [39, "          cat check_output.txt\n"], [40, "\n"], [41, "          # Check if any updates are available\n"], [42, "          if grep -q \"UPDATE AVAILABLE\" check_output.txt; then\n"], [43, "            echo \"updates_available=true\" >> $GITHUB_OUTPUT\n"], [44, "            echo \"\u2705 Updates available\"\n"], [45, "          else\n"], [46, "            echo \"updates_available=false\" >> $GITHUB_OUTPUT\n"], [47, "            echo \"\u2139\ufe0f  All tools already up-to-date\"\n"], [48, "          fi\n"], [49, "\n"], [50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [34, 51], "resource": "jobs(auto-update-tools).steps[4](Check for tool updates)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update all tools to latest versions", "if": "steps.check.outputs.updates_available == 'true'", "run": "echo \"Updating all tools to latest versions...\"\npython3 scripts/dev/update_versions.py --update-all\n\necho \"\"\necho \"Syncing changes to Dockerfiles...\"\npython3 scripts/dev/update_versions.py --sync\n", "__startline__": 50, "__endline__": 60}}, "code_block": [[50, "      - name: Update all tools to latest versions\n"], [51, "        if: steps.check.outputs.updates_available == 'true'\n"], [52, "        run: |\n"], [53, "          echo \"Updating all tools to latest versions...\"\n"], [54, "          python3 scripts/dev/update_versions.py --update-all\n"], [55, "\n"], [56, "          echo \"\"\n"], [57, "          echo \"Syncing changes to Dockerfiles...\"\n"], [58, "          python3 scripts/dev/update_versions.py --sync\n"], [59, "\n"], [60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [50, 61], "resource": "jobs(auto-update-tools).steps[5](Update all tools to latest versions)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Commit changes", "if": "steps.check.outputs.updates_available == 'true'", "id": "commit", "run": "git config --local user.name \"github-actions[bot]\"\ngit config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n\n# Create branch for updates\nBRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\ngit checkout -b \"$BRANCH\"\n\n# Stage changes\ngit add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n\n# Check if there are changes to commit\nif git diff --cached --quiet; then\n  echo \"No changes to commit\"\n  echo \"has_changes=false\" >> $GITHUB_OUTPUT\n  exit 0\nfi\n\n# Create commit message\ncat > commit_message.txt << 'COMMIT_MSG'\ndeps(tools): weekly auto-update of security tools\n\nAutomated weekly update of all security tools to latest versions.\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nCOMMIT_MSG\n\n# Commit changes\ngit commit -F commit_message.txt\n\n# Push branch\ngit push origin \"$BRANCH\"\n\necho \"has_changes=true\" >> $GITHUB_OUTPUT\necho \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n", "__startline__": 60, "__endline__": 101}}, "code_block": [[60, "      - name: Commit changes\n"], [61, "        if: steps.check.outputs.updates_available == 'true'\n"], [62, "        id: commit\n"], [63, "        run: |\n"], [64, "          git config --local user.name \"github-actions[bot]\"\n"], [65, "          git config --local user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n"], [66, "\n"], [67, "          # Create branch for updates\n"], [68, "          BRANCH=\"auto-update-tools-$(date +%Y%m%d)\"\n"], [69, "          git checkout -b \"$BRANCH\"\n"], [70, "\n"], [71, "          # Stage changes\n"], [72, "          git add versions.yaml Dockerfile Dockerfile.balanced Dockerfile.slim Dockerfile.fast\n"], [73, "\n"], [74, "          # Check if there are changes to commit\n"], [75, "          if git diff --cached --quiet; then\n"], [76, "            echo \"No changes to commit\"\n"], [77, "            echo \"has_changes=false\" >> $GITHUB_OUTPUT\n"], [78, "            exit 0\n"], [79, "          fi\n"], [80, "\n"], [81, "          # Create commit message\n"], [82, "          cat > commit_message.txt << 'COMMIT_MSG'\n"], [83, "          deps(tools): weekly auto-update of security tools\n"], [84, "\n"], [85, "          Automated weekly update of all security tools to latest versions.\n"], [86, "\n"], [87, "          \ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n"], [88, "\n"], [89, "          Co-Authored-By: Claude <noreply@anthropic.com>\n"], [90, "          COMMIT_MSG\n"], [91, "\n"], [92, "          # Commit changes\n"], [93, "          git commit -F commit_message.txt\n"], [94, "\n"], [95, "          # Push branch\n"], [96, "          git push origin \"$BRANCH\"\n"], [97, "\n"], [98, "          echo \"has_changes=true\" >> $GITHUB_OUTPUT\n"], [99, "          echo \"branch=$BRANCH\" >> $GITHUB_OUTPUT\n"], [100, "\n"], [101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [60, 102], "resource": "jobs(auto-update-tools).steps[6](Commit changes)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Create Pull Request", "if": "steps.commit.outputs.has_changes == 'true'", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 104, "__endline__": 105}, "run": "BRANCH=\"${{ steps.commit.outputs.branch }}\"\n\n# Create PR body\ncat > pr_body.txt << 'PR_BODY'\n## Weekly Security Tool Updates\n\nThis PR automatically updates all security tools to their latest versions.\n\n### Verification\n\n- All tools updated via `update_versions.py --update-all`\n- Dockerfiles synced via `update_versions.py --sync`\n- CI tests will verify compatibility\n\n### Auto-Merge Policy\n\nThis PR will auto-merge if:\n- \u2705 All CI tests pass\n- \u2705 No conflicts with main branch\n- \u2705 Version consistency check passes\n\n---\n\n\ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n\ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n\ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\nPR_BODY\n\n# Create PR\ngh pr create \\\n  --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n  --body-file pr_body.txt \\\n  --base main \\\n  --head \"$BRANCH\" \\\n  --label \"dependencies\" \\\n  --label \"automated\"\n\n# Enable auto-merge\nPR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\ngh pr merge \"$PR_NUMBER\" --auto --squash\n", "__startline__": 101, "__endline__": 147}}, "code_block": [[101, "      - name: Create Pull Request\n"], [102, "        if: steps.commit.outputs.has_changes == 'true'\n"], [103, "        env:\n"], [104, "          GH_TOKEN: ${{ github.token }}\n"], [105, "        run: |\n"], [106, "          BRANCH=\"${{ steps.commit.outputs.branch }}\"\n"], [107, "\n"], [108, "          # Create PR body\n"], [109, "          cat > pr_body.txt << 'PR_BODY'\n"], [110, "          ## Weekly Security Tool Updates\n"], [111, "\n"], [112, "          This PR automatically updates all security tools to their latest versions.\n"], [113, "\n"], [114, "          ### Verification\n"], [115, "\n"], [116, "          - All tools updated via `update_versions.py --update-all`\n"], [117, "          - Dockerfiles synced via `update_versions.py --sync`\n"], [118, "          - CI tests will verify compatibility\n"], [119, "\n"], [120, "          ### Auto-Merge Policy\n"], [121, "\n"], [122, "          This PR will auto-merge if:\n"], [123, "          - \u2705 All CI tests pass\n"], [124, "          - \u2705 No conflicts with main branch\n"], [125, "          - \u2705 Version consistency check passes\n"], [126, "\n"], [127, "          ---\n"], [128, "\n"], [129, "          \ud83e\udd16 **Automated PR** - Generated by weekly-tool-update workflow\n"], [130, "          \ud83d\udcc5 **Schedule**: Every Sunday at 00:00 UTC\n"], [131, "          \ud83d\udd17 **Workflow**: `.github/workflows/weekly-tool-update.yml`\n"], [132, "          PR_BODY\n"], [133, "\n"], [134, "          # Create PR\n"], [135, "          gh pr create \\\n"], [136, "            --title \"deps(tools): weekly auto-update $(date +%Y-%m-%d)\" \\\n"], [137, "            --body-file pr_body.txt \\\n"], [138, "            --base main \\\n"], [139, "            --head \"$BRANCH\" \\\n"], [140, "            --label \"dependencies\" \\\n"], [141, "            --label \"automated\"\n"], [142, "\n"], [143, "          # Enable auto-merge\n"], [144, "          PR_NUMBER=$(gh pr view \"$BRANCH\" --json number --jq '.number')\n"], [145, "          gh pr merge \"$PR_NUMBER\" --auto --squash\n"], [146, "\n"], [147, "      - name: Summary\n"], [148, "        if: always()\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [101, 148], "resource": "jobs(auto-update-tools).steps[7](Create Pull Request)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Summary", "if": "always()", "run": "{\n  echo \"## Weekly Tool Update Summary\"\n  echo \"\"\n\n  if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n    if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n      echo \"\u2705 **Updates applied successfully**\"\n      echo \"\"\n      echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n      echo \"- Pull request created and set to auto-merge\"\n      echo \"- Will merge automatically when CI passes\"\n    else\n      echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n    fi\n  else\n    echo \"\u2139\ufe0f **All tools already up-to-date**\"\n    echo \"\"\n    echo \"No updates needed this week.\"\n  fi\n} >> \"$GITHUB_STEP_SUMMARY\"\n", "__startline__": 147, "__endline__": 170}}, "code_block": [[147, "      - name: Summary\n"], [148, "        if: always()\n"], [149, "        run: |\n"], [150, "          {\n"], [151, "            echo \"## Weekly Tool Update Summary\"\n"], [152, "            echo \"\"\n"], [153, "\n"], [154, "            if [[ \"${{ steps.check.outputs.updates_available }}\" == \"true\" ]]; then\n"], [155, "              if [[ \"${{ steps.commit.outputs.has_changes }}\" == \"true\" ]]; then\n"], [156, "                echo \"\u2705 **Updates applied successfully**\"\n"], [157, "                echo \"\"\n"], [158, "                echo \"- Branch created: \\`${{ steps.commit.outputs.branch }}\\`\"\n"], [159, "                echo \"- Pull request created and set to auto-merge\"\n"], [160, "                echo \"- Will merge automatically when CI passes\"\n"], [161, "              else\n"], [162, "                echo \"\u26a0\ufe0f **Updates available but no changes committed**\"\n"], [163, "              fi\n"], [164, "            else\n"], [165, "              echo \"\u2139\ufe0f **All tools already up-to-date**\"\n"], [166, "              echo \"\"\n"], [167, "              echo \"No updates needed this week.\"\n"], [168, "            fi\n"], [169, "          } >> \"$GITHUB_STEP_SUMMARY\"\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [147, 171], "resource": "jobs(auto-update-tools).steps[8](Summary)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": ["auto-update-tools"], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}}, "code_block": [[21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [21, 139], "resource": "jobs(release-winget)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}}, "code_block": [[21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [21, 139], "resource": "jobs(release-winget)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}}, "code_block": [[21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [21, 139], "resource": "jobs(release-winget)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_6", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"release-winget": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}, "__startline__": 20, "__endline__": 138}}, "code_block": [[20, "  release-winget:\n"], [21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [20, 139], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}}, "code_block": [[21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [21, 139], "resource": "jobs(release-winget)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_5", "bc_check_id": null, "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"release-winget": {"name": "Submit PR to microsoft/winget-pkgs", "runs-on": "windows-latest", "timeout-minutes": 15, "steps": [{"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}, {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}, {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}, {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}, {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}], "__startline__": 21, "__endline__": 138}, "__startline__": 20, "__endline__": 138}}, "code_block": [[20, "  release-winget:\n"], [21, "    name: Submit PR to microsoft/winget-pkgs\n"], [22, "    runs-on: windows-latest\n"], [23, "    timeout-minutes: 15\n"], [24, "\n"], [25, "    steps:\n"], [26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [20, 139], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"release": {"types": ["published"], "__startline__": 10, "__endline__": 11}, "workflow_dispatch": null, "__startline__": 9, "__endline__": 13}}, "code_block": [[9, "  release:\n"], [10, "    types: [published]  # Only run on published releases (not drafts or prereleases)\n"], [11, "  workflow_dispatch:\n"], [12, "\n"], [13, "env:\n"], [14, "  PACKAGE_IDENTIFIER: jmo.jmo-security\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [9, 14], "resource": "on(WinGet Manifest Auto-Update)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": [""], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}}, "code_block": [[26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [26, 42], "resource": "jobs(release-winget).steps[1](Extract version from release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}}, "code_block": [[41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [41, 70], "resource": "jobs(release-winget).steps[2](Verify GitHub Release exists with installer)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}}, "code_block": [[69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [69, 102], "resource": "jobs(release-winget).steps[3](Submit manifest to microsoft/winget-pkgs)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}}, "code_block": [[101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [101, 116], "resource": "jobs(release-winget).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_4", "bc_check_id": null, "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}}, "code_block": [[115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [115, 139], "resource": "jobs(release-winget).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}}, "code_block": [[26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [26, 42], "resource": "jobs(release-winget).steps[1](Extract version from release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}}, "code_block": [[41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [41, 70], "resource": "jobs(release-winget).steps[2](Verify GitHub Release exists with installer)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}}, "code_block": [[69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [69, 102], "resource": "jobs(release-winget).steps[3](Submit manifest to microsoft/winget-pkgs)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}}, "code_block": [[101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [101, 116], "resource": "jobs(release-winget).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_2", "bc_check_id": null, "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}}, "code_block": [[115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [115, 139], "resource": "jobs(release-winget).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}}, "code_block": [[26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [26, 42], "resource": "jobs(release-winget).steps[1](Extract version from release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}}, "code_block": [[41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [41, 70], "resource": "jobs(release-winget).steps[2](Verify GitHub Release exists with installer)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}}, "code_block": [[69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [69, 102], "resource": "jobs(release-winget).steps[3](Submit manifest to microsoft/winget-pkgs)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}}, "code_block": [[101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [101, 116], "resource": "jobs(release-winget).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_1", "bc_check_id": null, "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}}, "code_block": [[115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [115, 139], "resource": "jobs(release-winget).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Extract version from release", "id": "version", "shell": "pwsh", "run": "if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n  $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n} else {\n  # Fallback: get latest release\n  $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n}\nWrite-Output \"version=$version\" >> $env:GITHUB_OUTPUT\nWrite-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 39, "__endline__": 41}, "__startline__": 26, "__endline__": 41}}, "code_block": [[26, "      - name: Extract version from release\n"], [27, "        id: version\n"], [28, "        shell: pwsh\n"], [29, "        run: |\n"], [30, "          if ($env:GITHUB_EVENT_NAME -eq \"release\") {\n"], [31, "            $version = $env:GITHUB_REF -replace 'refs/tags/v', ''\n"], [32, "          } else {\n"], [33, "            # Fallback: get latest release\n"], [34, "            $version = (gh api repos/${{ github.repository }}/releases/latest --jq '.tag_name' -replace '^v', '')\n"], [35, "          }\n"], [36, "          Write-Output \"version=$version\" >> $env:GITHUB_OUTPUT\n"], [37, "          Write-Output \"\ud83d\udce6 Creating WinGet manifest for version: $version\"\n"], [38, "        env:\n"], [39, "          GH_TOKEN: ${{ github.token }}\n"], [40, "\n"], [41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [26, 42], "resource": "jobs(release-winget).steps[1](Extract version from release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Verify GitHub Release exists with installer", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n\n$release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n$assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n\n$installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n\nif (-not $installer) {\n  Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n  Write-Output \"\"\n  Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n  Write-Output \"Available assets:\"\n  $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n  Write-Output \"\"\n  Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n  exit 1\n}\n\nWrite-Output \"\u2705 Found installer: $($installer.name)\"\nWrite-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\nWrite-Output \"   URL: $($installer.browser_download_url)\"\n", "env": {"GH_TOKEN": "${{ github.token }}", "__startline__": 67, "__endline__": 69}, "__startline__": 41, "__endline__": 69}}, "code_block": [[41, "      - name: Verify GitHub Release exists with installer\n"], [42, "        shell: pwsh\n"], [43, "        run: |\n"], [44, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [45, "          Write-Output \"\ud83d\udd0d Verifying GitHub Release v$version has Windows installer...\"\n"], [46, "\n"], [47, "          $release = gh api repos/${{ github.repository }}/releases/tags/v$version --jq '.'\n"], [48, "          $assets = $release | ConvertFrom-Json | Select-Object -ExpandProperty assets\n"], [49, "\n"], [50, "          $installer = $assets | Where-Object { $_.name -match 'jmo-security-.*-win64\\.exe$' }\n"], [51, "\n"], [52, "          if (-not $installer) {\n"], [53, "            Write-Output \"\u274c ERROR: No Windows installer found in release v$version\"\n"], [54, "            Write-Output \"\"\n"], [55, "            Write-Output \"Expected asset pattern: jmo-security-$version-win64.exe\"\n"], [56, "            Write-Output \"Available assets:\"\n"], [57, "            $assets | ForEach-Object { Write-Output \"  - $($_.name)\" }\n"], [58, "            Write-Output \"\"\n"], [59, "            Write-Output \"Please ensure the Windows installer is built and uploaded before running this workflow.\"\n"], [60, "            exit 1\n"], [61, "          }\n"], [62, "\n"], [63, "          Write-Output \"\u2705 Found installer: $($installer.name)\"\n"], [64, "          Write-Output \"   Size: $([math]::Round($installer.size / 1MB, 2)) MB\"\n"], [65, "          Write-Output \"   URL: $($installer.browser_download_url)\"\n"], [66, "        env:\n"], [67, "          GH_TOKEN: ${{ github.token }}\n"], [68, "\n"], [69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [41, 70], "resource": "jobs(release-winget).steps[2](Verify GitHub Release exists with installer)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Submit manifest to microsoft/winget-pkgs", "uses": "vedantmgoyal9/winget-releaser@v2", "with": {"token": "${{ secrets.WINGET_RELEASER_TOKEN }}", "identifier": "jmo.jmo-security", "__startline__": 78, "__endline__": 101}, "__startline__": 69, "__endline__": 101}}, "code_block": [[69, "      - name: Submit manifest to microsoft/winget-pkgs\n"], [70, "        uses: vedantmgoyal9/winget-releaser@v2\n"], [71, "        with:\n"], [72, "          # Required: Personal Access Token with public_repo scope\n"], [73, "          # Setup:\n"], [74, "          #   1. Fork microsoft/winget-pkgs under same account/org as this repo\n"], [75, "          #   2. GitHub Settings \u2192 Developer settings \u2192 Personal access tokens (classic)\n"], [76, "          #   3. Scopes: public_repo\n"], [77, "          #   4. Store as repository secret: Settings \u2192 Secrets \u2192 Actions \u2192 New repository secret\n"], [78, "          token: ${{ secrets.WINGET_RELEASER_TOKEN }}\n"], [79, "\n"], [80, "          # Package identifier (must match existing entry in winget-pkgs)\n"], [81, "          identifier: jmo.jmo-security\n"], [82, "\n"], [83, "          # Release tag (with v prefix)\n"], [84, "          # If not provided, defaults to latest release\n"], [85, "          # version: v${{ steps.version.outputs.version }}\n"], [86, "\n"], [87, "          # Installer URLs (auto-detected from GitHub release assets)\n"], [88, "          # Pattern: jmo-security-{version}-win64.exe\n"], [89, "          # installers-regex: 'jmo-security-.*-win64\\.exe$'  # Default works\n"], [90, "\n"], [91, "          # Maximum number of installers to include (default: 6 - x64/x86/ARM64 \u00d7 exe/msi)\n"], [92, "          # max-installers: 2  # We only have x64 exe for now\n"], [93, "\n"], [94, "          # Fork repository to submit PR from (default: your fork of microsoft/winget-pkgs)\n"], [95, "          # fork-user: ${{ github.repository_owner }}\n"], [96, "\n"], [97, "          # Enable automatic updates for future releases (default: true)\n"], [98, "          # Creates GitHub Actions workflow in your fork to auto-submit on new releases\n"], [99, "          # create-version-pr: true\n"], [100, "\n"], [101, "      - name: Success notification\n"], [102, "        if: success()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [69, 102], "resource": "jobs(release-winget).steps[3](Submit manifest to microsoft/winget-pkgs)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Success notification", "if": "success()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udccb Next steps:\"\nWrite-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\nWrite-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\nWrite-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\nWrite-Output \"\"\nWrite-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n", "__startline__": 101, "__endline__": 115}}, "code_block": [[101, "      - name: Success notification\n"], [102, "        if: success()\n"], [103, "        shell: pwsh\n"], [104, "        run: |\n"], [105, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [106, "          Write-Output \"\u2705 Successfully submitted PR to microsoft/winget-pkgs for version $version\"\n"], [107, "          Write-Output \"\"\n"], [108, "          Write-Output \"\ud83d\udccb Next steps:\"\n"], [109, "          Write-Output \"  1. Monitor PR at: https://github.com/microsoft/winget-pkgs/pulls?q=is%3Apr+jmo-security\"\n"], [110, "          Write-Output \"  2. Microsoft maintainers will review (typically 1-2 weeks)\"\n"], [111, "          Write-Output \"  3. After merge, users can install with: winget install jmo.jmo-security\"\n"], [112, "          Write-Output \"\"\n"], [113, "          Write-Output \"\ud83d\udd17 WinGet manifest: https://github.com/microsoft/winget-pkgs/tree/master/manifests/j/jmo/jmo-security\"\n"], [114, "\n"], [115, "      - name: Failure notification\n"], [116, "        if: failure()\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [101, 116], "resource": "jobs(release-winget).steps[4](Success notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV_GHA_3", "bc_check_id": null, "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Failure notification", "if": "failure()", "shell": "pwsh", "run": "$version = \"${{ steps.version.outputs.version }}\"\nWrite-Output \"\u274c Failed to submit WinGet manifest for version $version\"\nWrite-Output \"\"\nWrite-Output \"Common issues:\"\nWrite-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\nWrite-Output \"  2. GitHub release not yet published\"\nWrite-Output \"  3. Windows installer asset not found in release\"\nWrite-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\nWrite-Output \"  5. Manifest schema validation failed\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using Komac:\"\nWrite-Output \"  komac update jmo.jmo-security --version $version --submit\"\nWrite-Output \"\"\nWrite-Output \"Manual fallback using WinGetCreate:\"\n$url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\nWrite-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\nWrite-Output \"    -u $url ``\"\nWrite-Output \"    -t <YOUR_TOKEN>\"\nexit 1\n", "__startline__": 115, "__endline__": 138}}, "code_block": [[115, "      - name: Failure notification\n"], [116, "        if: failure()\n"], [117, "        shell: pwsh\n"], [118, "        run: |\n"], [119, "          $version = \"${{ steps.version.outputs.version }}\"\n"], [120, "          Write-Output \"\u274c Failed to submit WinGet manifest for version $version\"\n"], [121, "          Write-Output \"\"\n"], [122, "          Write-Output \"Common issues:\"\n"], [123, "          Write-Output \"  1. WINGET_RELEASER_TOKEN not configured (see workflow comments)\"\n"], [124, "          Write-Output \"  2. GitHub release not yet published\"\n"], [125, "          Write-Output \"  3. Windows installer asset not found in release\"\n"], [126, "          Write-Output \"  4. microsoft/winget-pkgs fork doesn't exist under same account\"\n"], [127, "          Write-Output \"  5. Manifest schema validation failed\"\n"], [128, "          Write-Output \"\"\n"], [129, "          Write-Output \"Manual fallback using Komac:\"\n"], [130, "          Write-Output \"  komac update jmo.jmo-security --version $version --submit\"\n"], [131, "          Write-Output \"\"\n"], [132, "          Write-Output \"Manual fallback using WinGetCreate:\"\n"], [133, "          $url = \"https://github.com/${{ github.repository }}/releases/download/v$version/jmo-security-$version-win64.exe\"\n"], [134, "          Write-Output \"  wingetcreate update jmo.jmo-security -v $version ``\"\n"], [135, "          Write-Output \"    -u $url ``\"\n"], [136, "          Write-Output \"    -t <YOUR_TOKEN>\"\n"], [137, "          exit 1\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [115, 139], "resource": "jobs(release-winget).steps[5](Failure notification)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": ["release-winget"], "workflow_name": "WinGet Manifest Auto-Update"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[21, "  contents: write\n"], [22, "  pull-requests: write\n"], [23, "\n"], [24, "jobs:\n"], [25, "  prepare-release:\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [21, 25], "resource": "on(Automated Release)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": [""], "workflow_name": "Automated Release"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[23, "  contents: read\n"], [24, "\n"], [25, "jobs:\n"], [26, "  bump-formula:\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [23, 26], "resource": "on(Homebrew Formula Auto-Update)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": [""], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[10, "  contents: read\n"], [11, "  issues: write  # For creating issue on failure\n"], [12, "\n"], [13, "jobs:\n"], [14, "  extended-tests:\n"]], "file_path": "/nightly-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/nightly-tests.yml", "repo_file_path": "/.github/workflows/nightly-tests.yml", "file_line_range": [10, 14], "resource": "on(Nightly Extended Tests)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Nightly Extended Tests"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[19, "  contents: read\n"], [20, "  pull-requests: write  # For posting benchmark results as comments\n"], [21, "\n"], [22, "jobs:\n"], [23, "  benchmark:\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [19, 23], "resource": "on(Performance Regression Detection)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": [""], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[20, "  contents: read\n"], [21, "  packages: write\n"], [22, "  id-token: write         # For OIDC (PyPI Trusted Publishers + GitHub OIDC)\n"], [23, "  security-events: write  # For uploading SARIF files to GitHub Security\n"], [24, "\n"], [25, "jobs:\n"], [26, "  # PRE-RELEASE GATE: Comprehensive release validation (v1.0.0+)\n"]], "file_path": "/release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/release.yml", "repo_file_path": "/.github/workflows/release.yml", "file_line_range": [20, 26], "resource": "on(Release)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": [""], "workflow_name": "Release"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[22, "  contents: read\n"], [23, "  issues: write  # Required for creating issues\n"], [24, "\n"], [25, "jobs:\n"], [26, "  check-versions:\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [22, 26], "resource": "on(Version Consistency Check)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Version Consistency Check"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[10, "  contents: write\n"], [11, "  pull-requests: write\n"], [12, "\n"], [13, "jobs:\n"], [14, "  auto-update-tools:\n"]], "file_path": "/weekly-tool-update.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/weekly-tool-update.yml", "repo_file_path": "/.github/workflows/weekly-tool-update.yml", "file_line_range": [10, 14], "resource": "on(Weekly Tool Update)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Weekly Tool Update"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "PASSED", "evaluated_keys": ["permissions"]}, "code_block": [[17, "  contents: read\n"], [18, "\n"], [19, "jobs:\n"], [20, "  release-winget:\n"]], "file_path": "/winget-releaser.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/winget-releaser.yml", "repo_file_path": "/.github/workflows/winget-releaser.yml", "file_line_range": [17, 20], "resource": "on(WinGet Manifest Auto-Update)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "release"]], "job": [""], "workflow_name": "WinGet Manifest Auto-Update"}], "failed_checks": [{"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions"]}, "code_block": [], "file_path": "/ci.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/ci.yml", "repo_file_path": "/.github/workflows/ci.yml", "file_line_range": [4, 5], "resource": "on(CI)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push", "pull_request", "schedule"]], "job": [""], "workflow_name": "CI"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions"]}, "code_block": [], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [3, 4], "resource": "on(E2E Comprehensive Tests)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": [""], "workflow_name": "E2E Comprehensive Tests"}], "skipped_checks": [{"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "SKIPPED", "suppress_comment": " Manual release workflow requires version bump type and changelog entry for maintainer control", "results_configuration": {"workflow_dispatch": {"inputs": {"version_bump": {"description": "Version bump type", "required": true, "type": "choice", "options": ["patch", "minor", "major"], "__startline__": 8, "__endline__": 15}, "changelog_entry": {"description": "Changelog entry (brief summary of changes)", "required": true, "type": "string", "__startline__": 16, "__endline__": 20}, "__startline__": 7, "__endline__": 20}, "__startline__": 6, "__endline__": 20}, "__startline__": 4, "__endline__": 20}}, "code_block": [[4, "  workflow_dispatch:\n"], [5, "    # checkov:skip=CKV_GHA_7: Manual release workflow requires version bump type and changelog entry for maintainer control\n"], [6, "    inputs:\n"], [7, "      version_bump:\n"], [8, "        description: 'Version bump type'\n"], [9, "        required: true\n"], [10, "        type: choice\n"], [11, "        options:\n"], [12, "          - patch  # 0.7.1 \u2192 0.7.2 (bug fixes)\n"], [13, "          - minor  # 0.7.1 \u2192 0.8.0 (new features, backwards compatible)\n"], [14, "          - major  # 0.7.1 \u2192 1.0.0 (breaking changes)\n"], [15, "      changelog_entry:\n"], [16, "        description: 'Changelog entry (brief summary of changes)'\n"], [17, "        required: true\n"], [18, "        type: string\n"], [19, "\n"], [20, "permissions:\n"], [21, "  contents: write\n"]], "file_path": "/automated-release.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/automated-release.yml", "repo_file_path": "/.github/workflows/automated-release.yml", "file_line_range": [4, 21], "resource": "on(Automated Release)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch"]], "job": [""], "workflow_name": "Automated Release"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "SKIPPED", "suppress_comment": " Manual test execution requires test_id and docker_tag inputs for targeted testing", "results_configuration": {"pull_request": {"paths": ["scripts/**", "tests/**", "pyproject.toml", "jmo.yml", ".github/workflows/e2e-comprehensive-tests.yml"], "__startline__": 6, "__endline__": 12}, "schedule": [{"cron": "0 6 * * *", "__startline__": 14, "__endline__": 15}], "workflow_dispatch": {"inputs": {"test_id": {"description": "Specific test to run (e.g., U1, M2, A3). Leave empty for all tests.", "required": false, "default": "", "__startline__": 19, "__endline__": 22}, "docker_tag": {"description": "Docker image tag to test", "required": false, "default": "latest", "__startline__": 23, "__endline__": 27}, "__startline__": 18, "__endline__": 27}, "__startline__": 17, "__endline__": 27}, "__startline__": 5, "__endline__": 27}}, "code_block": [[5, "  pull_request:\n"], [6, "    paths:\n"], [7, "      - 'scripts/**'\n"], [8, "      - 'tests/**'\n"], [9, "      - 'pyproject.toml'\n"], [10, "      - 'jmo.yml'\n"], [11, "      - '.github/workflows/e2e-comprehensive-tests.yml'\n"], [12, "  schedule:\n"], [13, "    # Nightly at 6 AM UTC\n"], [14, "    - cron: '0 6 * * *'\n"], [15, "  workflow_dispatch:\n"], [16, "    # checkov:skip=CKV_GHA_7: Manual test execution requires test_id and docker_tag inputs for targeted testing\n"], [17, "    inputs:\n"], [18, "      test_id:\n"], [19, "        description: 'Specific test to run (e.g., U1, M2, A3). Leave empty for all tests.'\n"], [20, "        required: false\n"], [21, "        default: ''\n"], [22, "      docker_tag:\n"], [23, "        description: 'Docker image tag to test'\n"], [24, "        required: false\n"], [25, "        default: 'latest'\n"], [26, "\n"], [27, "jobs:\n"], [28, "  ubuntu-e2e:\n"]], "file_path": "/e2e-comprehensive-tests.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/e2e-comprehensive-tests.yml", "repo_file_path": "/.github/workflows/e2e-comprehensive-tests.yml", "file_line_range": [5, 28], "resource": "on(E2E Comprehensive Tests)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request", "schedule"]], "job": [""], "workflow_name": "E2E Comprehensive Tests"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "SKIPPED", "suppress_comment": " Manual formula update requires version input for Homebrew submission", "results_configuration": {"push": {"tags": ["v*"], "__startline__": 10, "__endline__": 12}, "workflow_dispatch": {"inputs": {"version": {"description": "Version to bump (without v prefix, e.g., 0.9.0)", "required": true, "__startline__": 16, "__endline__": 19}, "__startline__": 15, "__endline__": 19}, "__startline__": 14, "__endline__": 19}, "__startline__": 9, "__endline__": 19}}, "code_block": [[9, "  push:\n"], [10, "    tags:\n"], [11, "      - 'v*'\n"], [12, "  workflow_dispatch:\n"], [13, "    # checkov:skip=CKV_GHA_7: Manual formula update requires version input for Homebrew submission\n"], [14, "    inputs:\n"], [15, "      version:\n"], [16, "        description: 'Version to bump (without v prefix, e.g., 0.9.0)'\n"], [17, "        required: true\n"], [18, "\n"], [19, "env:\n"], [20, "  FORMULA_NAME: jmo-security\n"]], "file_path": "/homebrew-bump-formula.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/homebrew-bump-formula.yml", "repo_file_path": "/.github/workflows/homebrew-bump-formula.yml", "file_line_range": [9, 20], "resource": "on(Homebrew Formula Auto-Update)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "push"]], "job": [""], "workflow_name": "Homebrew Formula Auto-Update"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "SKIPPED", "suppress_comment": " Manual performance testing requires baseline_ref input for comparative benchmarking", "results_configuration": {"pull_request": {"branches": ["main", "dev"], "paths": ["scripts/core/**", "tests/performance/**", ".github/workflows/performance-regression.yml"], "__startline__": 5, "__endline__": 10}, "workflow_dispatch": {"inputs": {"baseline_ref": {"description": "Baseline git ref (branch/tag/commit)", "required": false, "default": "main", "__startline__": 14, "__endline__": 18}, "__startline__": 13, "__endline__": 18}, "__startline__": 12, "__endline__": 18}, "__startline__": 4, "__endline__": 18}}, "code_block": [[4, "  pull_request:\n"], [5, "    branches: [main, dev]\n"], [6, "    paths:\n"], [7, "      - 'scripts/core/**'\n"], [8, "      - 'tests/performance/**'\n"], [9, "      - '.github/workflows/performance-regression.yml'\n"], [10, "  workflow_dispatch:\n"], [11, "    # checkov:skip=CKV_GHA_7: Manual performance testing requires baseline_ref input for comparative benchmarking\n"], [12, "    inputs:\n"], [13, "      baseline_ref:\n"], [14, "        description: 'Baseline git ref (branch/tag/commit)'\n"], [15, "        required: false\n"], [16, "        default: 'main'\n"], [17, "\n"], [18, "permissions:\n"], [19, "  contents: read\n"]], "file_path": "/performance-regression.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/performance-regression.yml", "repo_file_path": "/.github/workflows/performance-regression.yml", "file_line_range": [4, 19], "resource": "on(Performance Regression Detection)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "pull_request"]], "job": [""], "workflow_name": "Performance Regression Detection"}, {"check_id": "CKV_GHA_7", "bc_check_id": null, "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "SKIPPED", "suppress_comment": " Manual version checks require create_issues input for controlling issue creation", "results_configuration": {"schedule": [{"cron": "0 0 * * 0", "__startline__": 11, "__endline__": 12}], "workflow_dispatch": {"inputs": {"create_issues": {"description": "Create GitHub issues for outdated tools", "required": false, "default": "true", "type": "boolean", "__startline__": 16, "__endline__": 21}, "__startline__": 15, "__endline__": 21}, "__startline__": 14, "__endline__": 21}, "__startline__": 9, "__endline__": 21}}, "code_block": [[9, "  schedule:\n"], [10, "    # Weekly on Sunday at 00:00 UTC\n"], [11, "    - cron: '0 0 * * 0'\n"], [12, "  workflow_dispatch:\n"], [13, "    # checkov:skip=CKV_GHA_7: Manual version checks require create_issues input for controlling issue creation\n"], [14, "    inputs:\n"], [15, "      create_issues:\n"], [16, "        description: 'Create GitHub issues for outdated tools'\n"], [17, "        required: false\n"], [18, "        default: 'true'\n"], [19, "        type: boolean\n"], [20, "\n"], [21, "permissions:\n"], [22, "  contents: read\n"]], "file_path": "/version-check.yml", "file_abs_path": "/mnt/c/Projects/jmo-security-repo/.github/workflows/version-check.yml", "repo_file_path": "/.github/workflows/version-check.yml", "file_line_range": [9, 22], "resource": "on(Version Consistency Check)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["workflow_dispatch", "schedule"]], "job": [""], "workflow_name": "Version Consistency Check"}], "parsing_errors": []}, "summary": {"passed": 897, "failed": 2, "skipped": 5, "parsing_errors": 0, "resource_count": 0, "checkov_version": "3.2.477"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}