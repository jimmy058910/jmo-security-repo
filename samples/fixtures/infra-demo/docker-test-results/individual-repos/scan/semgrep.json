{"errors": [{"code": 3, "level": "warn", "message": "Syntax error at line /scan/docker-test-results/individual-repos/scan/trufflehog.json:1:\n missing element", "path": "/scan/docker-test-results/individual-repos/scan/trufflehog.json", "type": "Syntax error"}], "interfile_languages_used": [], "paths": {"scanned": ["/scan/Dockerfile", "/scan/deployment.yaml", "/scan/docker-test-results/individual-repos/scan/gitleaks.json", "/scan/docker-test-results/individual-repos/scan/trufflehog.json", "/scan/main.tf"]}, "results": [{"check_id": "dockerfile.security.missing-user.missing-user", "end": {"col": 18, "line": 9, "offset": 343}, "extra": {"engine_kind": "OSS", "fingerprint": "acfb1b1408713571b133af08cd8af5c606b66daebea93de6310854c8af5347d518fe98554d959f7bb02b8cfe3ced1f678aba6bf071c9964768b54718f9d798fa_0", "fix": "USER non-root\nCMD [\"/bin/bash\"]", "is_ignored": false, "lines": "CMD [\"/bin/bash\"]", "message": "By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-250: Execution with Unnecessary Privileges"], "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A04:2021 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 20148, "rule_id": "AbUN06", "rv_id": 1032972, "url": "https://semgrep.dev/playground/r/5PTA4lQ/dockerfile.security.missing-user.missing-user", "version_id": "5PTA4lQ"}}, "shortlink": "https://sg.run/Gbvn", "source": "https://semgrep.dev/r/dockerfile.security.missing-user.missing-user", "subcategory": ["audit"], "technology": ["dockerfile"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$...VARS": {"abstract_content": "[\"/bin/bash\"]", "end": {"col": 18, "line": 9, "offset": 343}, "start": {"col": 5, "line": 9, "offset": 330}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/scan/Dockerfile", "start": {"col": 1, "line": 9, "offset": 326}}, {"check_id": "yaml.kubernetes.security.run-as-non-root.run-as-non-root", "end": {"col": 9, "line": 14, "offset": 215}, "extra": {"engine_kind": "OSS", "fingerprint": "1a4be86ebffb42ac6df7c54ff2bef379ae61e26088950a7d86dff580921c24e68cb652abeb43515925f8915eb7001b2b4ad77ab827d2225339acd6ae2adf25bc_0", "fix": "spec:\n      securityContext:\n        runAsNonRoot: true #", "is_ignored": false, "lines": "    spec:", "message": "When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-250: Execution with Unnecessary Privileges"], "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/", "https://kubernetes.io/docs/concepts/policy/pod-security-policy/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10134, "rule_id": "ZqUqeK", "rv_id": 947064, "url": "https://semgrep.dev/playground/r/JdTDP66/yaml.kubernetes.security.run-as-non-root.run-as-non-root", "version_id": "JdTDP66"}}, "shortlink": "https://sg.run/dgP5", "source": "https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root", "subcategory": ["audit"], "technology": ["kubernetes"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$1": {"abstract_content": "spec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$SPEC": {"abstract_content": "spec", "end": {"col": 9, "line": 14, "offset": 215}, "start": {"col": 5, "line": 14, "offset": 211}}}, "severity": "INFO", "validation_state": "NO_VALIDATOR"}, "path": "/scan/deployment.yaml", "start": {"col": 5, "line": 14, "offset": 211}}, {"check_id": "yaml.kubernetes.security.allow-privilege-escalation-true.allow-privilege-escalation-true", "end": {"col": 43, "line": 20, "offset": 431}, "extra": {"engine_kind": "OSS", "fingerprint": "c6392cea641aabd6f1ad19c017639e01a96d7e5c049c6267e54c0fa55efe68b51cc48c75010968cdabb35ec6cc3e9585bb56015c28f7df7cd751d4dc4f82b7e7_0", "fix": "false", "is_ignored": false, "lines": "            allowPrivilegeEscalation: true", "message": "In Kubernetes, each pod runs in its own isolated environment with its own  set of security policies. However, certain container images may contain  `setuid` or `setgid` binaries that could allow an attacker to perform  privilege escalation and gain access to sensitive resources. To mitigate  this risk, it's recommended to add a `securityContext` to the container in  the pod, with the parameter `allowPrivilegeEscalation` set to `false`.  This will prevent the container from running any privileged processes and  limit the impact of any potential attacks.  In the container `insecure-app` this parameter is set to `true` which makes this container much more vulnerable to privelege escalation attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "MEDIUM", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation", "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 47277, "rule_id": "0oUkqQ", "rv_id": 947051, "url": "https://semgrep.dev/playground/r/vdTG59q/yaml.kubernetes.security.allow-privilege-escalation-true.allow-privilege-escalation-true", "version_id": "vdTG59q"}}, "shortlink": "https://sg.run/vw3W", "source": "https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-true.allow-privilege-escalation-true", "subcategory": ["vuln"], "technology": ["kubernetes"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$CONTAINER": {"abstract_content": "insecure-app", "end": {"col": 29, "line": 16, "offset": 263}, "start": {"col": 17, "line": 16, "offset": 251}}, "$TRUE": {"abstract_content": "true", "end": {"col": 43, "line": 20, "offset": 431}, "start": {"col": 39, "line": 20, "offset": 427}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/scan/deployment.yaml", "start": {"col": 39, "line": 20, "offset": 427}}], "skipped_rules": [], "version": "1.94.0"}