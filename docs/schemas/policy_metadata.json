{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://jmotools.com/schemas/policy_metadata.v1.json",
  "title": "Policy Metadata",
  "description": "Metadata schema for JMo Security OPA policies",
  "type": "object",
  "required": ["name", "version", "description"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Human-readable policy name",
      "minLength": 1,
      "maxLength": 100,
      "examples": ["OWASP Top 10 2021 Enforcer", "Zero Secrets Policy"]
    },
    "version": {
      "type": "string",
      "description": "Semantic version of the policy",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0", "2.1.3"]
    },
    "description": {
      "type": "string",
      "description": "Brief description of what the policy enforces",
      "minLength": 10,
      "maxLength": 500,
      "examples": [
        "Blocks findings mapped to OWASP Top 10 categories",
        "Enforces zero tolerance for verified secrets"
      ]
    },
    "author": {
      "type": "string",
      "description": "Policy author or organization",
      "default": "JMo Security",
      "examples": ["JMo Security", "Security Team", "john.doe@example.com"]
    },
    "tags": {
      "type": "array",
      "description": "Categorization tags for the policy",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 50
      },
      "uniqueItems": true,
      "examples": [
        ["owasp", "compliance", "web-security"],
        ["secrets", "credentials", "zero-trust"],
        ["pci-dss", "payment-card", "compliance"]
      ]
    },
    "severity_levels": {
      "type": "array",
      "description": "Severity levels enforced by this policy",
      "items": {
        "type": "string",
        "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW", "INFO"]
      },
      "uniqueItems": true,
      "examples": [
        ["CRITICAL", "HIGH"],
        ["CRITICAL"]
      ]
    },
    "frameworks": {
      "type": "array",
      "description": "Compliance frameworks enforced by this policy",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100
      },
      "uniqueItems": true,
      "examples": [
        ["OWASP Top 10 2021", "CWE Top 25"],
        ["PCI DSS 4.0", "NIST CSF 2.0"],
        ["HIPAA Security Rule", "NIST 800-53"]
      ]
    },
    "minimum_opa_version": {
      "type": "string",
      "description": "Minimum OPA version required",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "default": "0.70.0",
      "examples": ["0.70.0", "0.65.0"]
    },
    "created_at": {
      "type": "string",
      "description": "ISO 8601 timestamp of policy creation",
      "format": "date-time",
      "examples": ["2025-11-03T19:00:00Z"]
    },
    "updated_at": {
      "type": "string",
      "description": "ISO 8601 timestamp of last policy update",
      "format": "date-time",
      "examples": ["2025-11-03T20:30:00Z"]
    },
    "license": {
      "type": "string",
      "description": "License under which the policy is distributed",
      "default": "MIT",
      "examples": ["MIT", "Apache-2.0", "GPL-3.0", "Proprietary"]
    },
    "references": {
      "type": "array",
      "description": "External references and documentation URLs",
      "items": {
        "type": "string",
        "format": "uri"
      },
      "examples": [
        ["https://owasp.org/Top10/", "https://cwe.mitre.org/top25/"],
        ["https://www.pcisecuritystandards.org/"]
      ]
    }
  },
  "examples": [
    {
      "name": "OWASP Top 10 2021 Enforcer",
      "version": "1.0.0",
      "description": "Blocks findings mapped to OWASP Top 10 categories",
      "author": "JMo Security",
      "tags": ["owasp", "compliance", "web-security"],
      "severity_levels": ["CRITICAL", "HIGH"],
      "frameworks": ["OWASP Top 10 2021"],
      "minimum_opa_version": "0.70.0",
      "license": "MIT",
      "references": [
        "https://owasp.org/Top10/"
      ]
    },
    {
      "name": "Zero Secrets Policy",
      "version": "1.0.0",
      "description": "Blocks all verified secrets (zero tolerance)",
      "author": "JMo Security",
      "tags": ["secrets", "credentials", "zero-trust"],
      "severity_levels": ["CRITICAL"],
      "frameworks": ["NIST CSF", "CIS Controls"],
      "minimum_opa_version": "0.70.0",
      "license": "MIT"
    }
  ]
}
